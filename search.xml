<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BPè¯†åˆ«æ•°å­—</title>
    <url>/2020/07/09/BP%E8%AF%86%E5%88%AB%E6%95%B0%E5%AD%97/</url>
    <content><![CDATA[<p>åŸç”ŸBPä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>



<p>BP(Back Propagation)ç¥ç»ç½‘ç»œ<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP3.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_digits</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelBinarizer</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/(<span class="number">1</span>+np.exp(-x))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dsigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*(<span class="number">1</span>-x)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NeruralNetwork</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,layers)</span>:</span></span><br><span class="line">        self.V=np.random.random((layers[<span class="number">0</span>]+<span class="number">1</span>,layers[<span class="number">1</span>]+<span class="number">1</span>))*<span class="number">2</span><span class="number">-1</span></span><br><span class="line">        self.W=np.random.random((layers[<span class="number">1</span>]+<span class="number">1</span>,layers[<span class="number">2</span>]))*<span class="number">2</span><span class="number">-1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(self,X,y,lr=<span class="number">0.11</span>,epochs=<span class="number">100000</span>)</span>:</span></span><br><span class="line">        temp = np.ones([X.shape[<span class="number">0</span>],X.shape[<span class="number">1</span>]+<span class="number">1</span>])</span><br><span class="line">        temp[:,<span class="number">0</span>:<span class="number">-1</span>]=X</span><br><span class="line">        X=temp</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(epochs+<span class="number">1</span>):</span><br><span class="line">            i = np.random.randint(X.shape[<span class="number">0</span>])</span><br><span class="line">            x=[X[i]]</span><br><span class="line">            x=np.atleast_2d(x)</span><br><span class="line">            L1=sigmoid(np.dot(x,self.V))</span><br><span class="line">            L2=sigmoid(np.dot(L1,self.W))</span><br><span class="line">            L2_delta=(y[i]-L2)*dsigmoid(L2)</span><br><span class="line">            L1_delta=L2_delta.dot((self.W.T))*dsigmoid(L1)</span><br><span class="line">            self.W+=lr*L1.T.dot(L2_delta)</span><br><span class="line">            self.V+=lr*x.T.dot(L1_delta)</span><br><span class="line">            <span class="keyword">if</span> n%<span class="number">1000</span>==<span class="number">0</span>:</span><br><span class="line">                predictions=[]</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(X_test.shape[<span class="number">0</span>]):</span><br><span class="line">                    o=self.predict(X_test[j])</span><br><span class="line">                    predictions.append(np.argmax(o))</span><br><span class="line">                accuracy=np.mean(np.equal(predictions,y_test))</span><br><span class="line">                print(<span class="string">'epoch:'</span>,n,<span class="string">'accuracy:'</span>,accuracy)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,x)</span>:</span></span><br><span class="line">        temp=np.ones(x.shape[<span class="number">0</span>]+<span class="number">1</span>)</span><br><span class="line">        temp[<span class="number">0</span>:<span class="number">-1</span>]=x</span><br><span class="line">        x=temp</span><br><span class="line">        x=np.atleast_2d(x)</span><br><span class="line">        L1=sigmoid(np.dot(x,self.V))</span><br><span class="line">        L2=sigmoid(np.dot(L1,self.W))</span><br><span class="line">        <span class="keyword">return</span> L2</span><br><span class="line">    </span><br><span class="line">digits =load_digits()</span><br><span class="line">X = digits.data</span><br><span class="line">y = digits.target</span><br><span class="line">X -= X.min()</span><br><span class="line">X/=X.max()</span><br><span class="line"></span><br><span class="line">nm = NeruralNetwork([<span class="number">64</span>,<span class="number">100</span>,<span class="number">10</span>])</span><br><span class="line">X_train,X_test,y_train,y_test = train_test_split(X,y)</span><br><span class="line">labels_train = LabelBinarizer().fit_transform(y_train)</span><br><span class="line">labels_test = LabelBinarizer().fit_transform(y_test)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'start'</span>)</span><br><span class="line">nm.train(X_train,labels_train,epochs=<span class="number">20000</span>)</span><br><span class="line">print(<span class="string">'end'</span>)</span><br></pre></td></tr></table></figure>

<pre><code>start
epoch: 0 accuracy: 0.09777777777777778
epoch: 1000 accuracy: 0.5288888888888889
epoch: 2000 accuracy: 0.7333333333333333
epoch: 3000 accuracy: 0.8444444444444444
epoch: 4000 accuracy: 0.8666666666666667
epoch: 5000 accuracy: 0.92
epoch: 6000 accuracy: 0.9444444444444444
epoch: 7000 accuracy: 0.9555555555555556
epoch: 8000 accuracy: 0.9577777777777777
epoch: 9000 accuracy: 0.9488888888888889
epoch: 10000 accuracy: 0.9644444444444444
epoch: 11000 accuracy: 0.9666666666666667
epoch: 12000 accuracy: 0.96
epoch: 13000 accuracy: 0.9688888888888889
epoch: 14000 accuracy: 0.96
epoch: 15000 accuracy: 0.9644444444444444
epoch: 16000 accuracy: 0.9644444444444444
epoch: 17000 accuracy: 0.9666666666666667
epoch: 18000 accuracy: 0.9711111111111111
epoch: 19000 accuracy: 0.9688888888888889
epoch: 20000 accuracy: 0.9777777777777777
end</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>K-Means</title>
    <url>/2020/07/10/K-Means/</url>
    <content><![CDATA[<p>K-Meansä»£ç ç®€å•æ¼”ç¤º</p>
<p>æ•°æ®é›†ä¸‹è½½:<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/kmeans.txt" target="_blank" rel="noopener">kmeans.txt</a></p>
<a id="more"></a>



<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans3.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans4.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans5.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans6.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/kmeans7.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = np.genfromtxt(<span class="string">'./data/kmeans.txt'</span>, delimiter=<span class="string">''</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">euclDistance</span><span class="params">(vector1,vector2)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.sqrt(sum((vector2-vector1)**<span class="number">2</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initCentroids</span><span class="params">(data,k)</span>:</span></span><br><span class="line">    numSamples,dim = data.shape</span><br><span class="line">    centroids = np.zeros((k,dim))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">        index = int(np.random.uniform(<span class="number">0</span>,numSamples))</span><br><span class="line">        centroids[i,:]=data[index,:]</span><br><span class="line">    <span class="keyword">return</span> centroids</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kmeans</span><span class="params">(data,k)</span>:</span></span><br><span class="line">    numSamples = data.shape[<span class="number">0</span>]</span><br><span class="line">    clusterData = np.array(np.zeros((numSamples,<span class="number">2</span>)))</span><br><span class="line">    clusterChanged = <span class="literal">True</span></span><br><span class="line">    centroids = initCentroids(data,k)</span><br><span class="line">    <span class="keyword">while</span> clusterChanged:  </span><br><span class="line">        clusterChanged = <span class="literal">False</span>  </span><br><span class="line">        <span class="comment"># å¾ªç¯æ¯ä¸€ä¸ªæ ·æœ¬ </span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(numSamples):  </span><br><span class="line">            <span class="comment"># æœ€å°è·ç¦»</span></span><br><span class="line">            minDist  = <span class="number">100000.0</span>  </span><br><span class="line">            <span class="comment"># å®šä¹‰æ ·æœ¬æ‰€å±çš„ç°‡</span></span><br><span class="line">            minIndex = <span class="number">0</span>  </span><br><span class="line">            <span class="comment"># å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªè´¨å¿ƒä¸è¯¥æ ·æœ¬çš„è·ç¦»</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k):  </span><br><span class="line">                <span class="comment"># å¾ªç¯æ¯ä¸€ä¸ªè´¨å¿ƒå’Œæ ·æœ¬ï¼Œè®¡ç®—è·ç¦»</span></span><br><span class="line">                distance = euclDistance(centroids[j, :], data[i, :])  </span><br><span class="line">                <span class="comment"># å¦‚æœè®¡ç®—çš„è·ç¦»å°äºæœ€å°è·ç¦»ï¼Œåˆ™æ›´æ–°æœ€å°è·ç¦»</span></span><br><span class="line">                <span class="keyword">if</span> distance &lt; minDist:  </span><br><span class="line">                    minDist  = distance  </span><br><span class="line">                    <span class="comment"># æ›´æ–°æ ·æœ¬æ‰€å±çš„ç°‡</span></span><br><span class="line">                    minIndex = j  </span><br><span class="line">                    <span class="comment"># æ›´æ–°æœ€å°è·ç¦»</span></span><br><span class="line">                    clusterData[i, <span class="number">1</span>] = distance</span><br><span class="line">              </span><br><span class="line">            <span class="comment"># å¦‚æœæ ·æœ¬çš„æ‰€å±çš„ç°‡å‘ç”Ÿäº†å˜åŒ–</span></span><br><span class="line">            <span class="keyword">if</span> clusterData[i, <span class="number">0</span>] != minIndex:  </span><br><span class="line">                <span class="comment"># è´¨å¿ƒè¦é‡æ–°è®¡ç®—</span></span><br><span class="line">                clusterChanged = <span class="literal">True</span></span><br><span class="line">                <span class="comment"># æ›´æ–°æ ·æœ¬çš„ç°‡</span></span><br><span class="line">                clusterData[i, <span class="number">0</span>] = minIndex</span><br><span class="line">        <span class="comment"># æ›´æ–°è´¨å¿ƒ</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(k):  </span><br><span class="line">            <span class="comment"># è·å–ç¬¬jä¸ªç°‡æ‰€æœ‰çš„æ ·æœ¬æ‰€åœ¨çš„ç´¢å¼•</span></span><br><span class="line">            cluster_index = np.nonzero(clusterData[:, <span class="number">0</span>] == j)</span><br><span class="line">            <span class="comment"># ç¬¬jä¸ªç°‡æ‰€æœ‰çš„æ ·æœ¬ç‚¹</span></span><br><span class="line">            pointsInCluster = data[cluster_index]  </span><br><span class="line">            <span class="comment"># è®¡ç®—è´¨å¿ƒ</span></span><br><span class="line">            centroids[j, :] = np.mean(pointsInCluster, axis = <span class="number">0</span>) </span><br><span class="line"><span class="comment">#         showCluster(data, k, centroids, clusterData)</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> centroids, clusterData  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç»“æœ </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showCluster</span><span class="params">(data, k, centroids, clusterData)</span>:</span>  </span><br><span class="line">    numSamples, dim = data.shape  </span><br><span class="line">    <span class="keyword">if</span> dim != <span class="number">2</span>:  </span><br><span class="line">        print(<span class="string">"dimension of your data is not 2!"</span>)  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># ç”¨ä¸åŒé¢œè‰²å½¢çŠ¶æ¥è¡¨ç¤ºå„ä¸ªç±»åˆ«</span></span><br><span class="line">    mark = [<span class="string">'or'</span>, <span class="string">'ob'</span>, <span class="string">'og'</span>, <span class="string">'ok'</span>, <span class="string">'^r'</span>, <span class="string">'+r'</span>, <span class="string">'sr'</span>, <span class="string">'dr'</span>, <span class="string">'&lt;r'</span>, <span class="string">'pr'</span>]  </span><br><span class="line">    <span class="keyword">if</span> k &gt; len(mark):  </span><br><span class="line">        print(<span class="string">"Your k is too large!"</span>)  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># ç”»æ ·æœ¬ç‚¹  </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numSamples):  </span><br><span class="line">        markIndex = int(clusterData[i, <span class="number">0</span>])  </span><br><span class="line">        plt.plot(data[i, <span class="number">0</span>], data[i, <span class="number">1</span>], mark[markIndex])  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># ç”¨ä¸åŒé¢œè‰²å½¢çŠ¶æ¥è¡¨ç¤ºå„ä¸ªç±»åˆ«</span></span><br><span class="line">    mark = [<span class="string">'*r'</span>, <span class="string">'*b'</span>, <span class="string">'*g'</span>, <span class="string">'*k'</span>, <span class="string">'^b'</span>, <span class="string">'+b'</span>, <span class="string">'sb'</span>, <span class="string">'db'</span>, <span class="string">'&lt;b'</span>, <span class="string">'pb'</span>]  </span><br><span class="line">    <span class="comment"># ç”»è´¨å¿ƒç‚¹ </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k):  </span><br><span class="line">        plt.plot(centroids[i, <span class="number">0</span>], centroids[i, <span class="number">1</span>], mark[i], markersize = <span class="number">20</span>)  </span><br><span class="line">  </span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list_lost=[]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">10</span>):</span><br><span class="line">    min_loss = <span class="number">10000</span></span><br><span class="line">    min_loss_centroids = np.array([])</span><br><span class="line">    min_loss_clusterData = np.array([])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">        centroids,clusterData = kmeans(data,k)</span><br><span class="line">        loss = sum(clusterData[:,<span class="number">1</span>])/data.shape[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> loss&lt;min_loss:</span><br><span class="line">            min_loss = loss</span><br><span class="line">            min_loss_centroids = centroids</span><br><span class="line">            min_loss_clusterData = clusterData</span><br><span class="line">    list_lost.append(min_loss)</span><br></pre></td></tr></table></figure>

<pre><code>c:\users\18025\appdata\local\programs\python\python37\lib\site-packages\numpy\core\fromnumeric.py:3257: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
c:\users\18025\appdata\local\programs\python\python37\lib\site-packages\numpy\core\_methods.py:154: RuntimeWarning: invalid value encountered in true_divide
  ret, rcount, out=ret, casting=&apos;unsafe&apos;, subok=False)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list_lost</span><br></pre></td></tr></table></figure>




<pre><code>[2.9811811738953176,
 1.9708559728104191,
 1.1675654672086735,
 1.0712368269135584,
 1.0019034362200374,
 0.9470283294527311,
 0.8835789709731454,
 0.8393052369848919]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.plot(range(<span class="number">2</span>,<span class="number">10</span>),list_lost)</span><br><span class="line">plt.xlabel(<span class="string">'k'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'loss'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/10/K-Means/output_6_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_test = [<span class="number">0</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">k=<span class="number">6</span></span><br><span class="line">min_loss = <span class="number">10000</span></span><br><span class="line">min_loss_centroids = np.array([])</span><br><span class="line">min_loss_clusterData = np.array([])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    centroids,clusterData = kmeans(data,k)</span><br><span class="line">    loss = sum(clusterData[:,<span class="number">1</span>])/data.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> loss&lt;min_loss:</span><br><span class="line">        min_loss = loss</span><br><span class="line">        min_loss_centroids = centroids</span><br><span class="line">        min_loss_clusterData = clusterData</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(datas)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.array([np.argmin(((np.tile(data,(k,<span class="number">1</span>))-centroids)**<span class="number">2</span>).sum(axis=<span class="number">1</span>)) <span class="keyword">for</span> data <span class="keyword">in</span> datas])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class="line">x_min, x_max = data[:, <span class="number">0</span>].min() - <span class="number">1</span>, data[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">y_min, y_max = data[:, <span class="number">1</span>].min() - <span class="number">1</span>, data[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">0.02</span>),</span><br><span class="line">                     np.arange(y_min, y_max, <span class="number">0.02</span>))</span><br><span class="line"></span><br><span class="line">z = predict(np.c_[xx.ravel(), yy.ravel()])<span class="comment"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class="line">z = z.reshape(xx.shape)</span><br><span class="line"><span class="comment"># ç­‰é«˜çº¿å›¾</span></span><br><span class="line">cs = plt.contourf(xx, yy, z)</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç»“æœ</span></span><br><span class="line">showCluster(data, k, centroids, clusterData)</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/10/K-Means/output_9_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>èšç±»ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>BPè§£å†³å¼‚æˆ–é—®é¢˜</title>
    <url>/2020/07/09/BP%E8%A7%A3%E5%86%B3%E5%BC%82%E6%88%96%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>BPè§£å†³å¼‚æˆ–ä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>


<p>BP(Back Propagation)ç¥ç»ç½‘ç»œ<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/BP3.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = np.array([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line">Y = np.array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>]])</span><br><span class="line">V = np.random.random((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">2</span><span class="number">-1</span></span><br><span class="line">W = np.random.random((<span class="number">4</span>,<span class="number">1</span>))*<span class="number">2</span><span class="number">-1</span></span><br><span class="line">print(V)</span><br><span class="line">print(W)</span><br><span class="line">lr = <span class="number">0.11</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/(<span class="number">1</span>+np.exp(-x))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dsigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*(<span class="number">1</span>-x)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> X,Y,W,V,lr</span><br><span class="line">    L1 = sigmoid(np.dot(X,V))</span><br><span class="line">    L2 = sigmoid(np.dot(L1,W))</span><br><span class="line">    L2_delta = (Y.T-L2)*dsigmoid(L2)</span><br><span class="line">    L1_delta = L2_delta.dot(W.T)*dsigmoid(L1)</span><br><span class="line">    W_C=lr*L1.T.dot(L2_delta)</span><br><span class="line">    V_C=lr*X.T.dot(L1_delta)</span><br><span class="line">    W=W+W_C</span><br><span class="line">    V=V+V_C</span><br></pre></td></tr></table></figure>

<pre><code>[[ 0.34261592  0.95360188  0.04334655 -0.11015956]
 [ 0.12224398 -0.95540579  0.276879   -0.46803064]
 [-0.27212006  0.92409323  0.67230364 -0.63426355]]
[[ 0.6872099 ]
 [-0.05683569]
 [ 0.53593031]
 [ 0.6657038 ]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20000</span>):</span><br><span class="line">    update()</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">500</span>==<span class="number">0</span>:</span><br><span class="line">        L1 = sigmoid(np.dot(X,V))</span><br><span class="line">        L2 = sigmoid(np.dot(L1,W))</span><br><span class="line">        print(<span class="string">'Error:'</span>, np.mean(np.abs(Y.T-L2)))</span><br><span class="line"></span><br><span class="line">L1 = sigmoid(np.dot(X,V))</span><br><span class="line">L2 = sigmoid(np.dot(L1,W))</span><br><span class="line">print(L2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x&gt;=<span class="number">0.5</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map(judge,L2):</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>

<pre><code>Error: 0.5001898525337108
Error: 0.4934029320599436
Error: 0.476950391452333
Error: 0.43144945106972044
Error: 0.3591844985087166
Error: 0.2441743332168715
Error: 0.15809286523556107
Error: 0.11588525072232857
Error: 0.09306039789777351
Error: 0.0789263390463002
Error: 0.06928189244260918
Error: 0.06224125874868228
Error: 0.05684589474475504
Error: 0.05255899358953674
Error: 0.04905658260975497
Error: 0.04613132103488044
Error: 0.04364412894489313
Error: 0.04149806879631519
Error: 0.0396233922893207
Error: 0.03796855199862452
Error: 0.036494571680927006
Error: 0.03517139424513
Error: 0.033975439770446966
Error: 0.032887928957447604
Error: 0.031893705073012604
Error: 0.030980388990824857
Error: 0.030137761945244118
Error: 0.02935730716518244
Error: 0.028631864414259807
Error: 0.027955366108362894
Error: 0.027322633269370986
Error: 0.02672921597533191
Error: 0.026171267318935168
Error: 0.025645442893166143
Error: 0.025148819932565722
Error: 0.02467883173915275
Error: 0.024233214103394567
Error: 0.02380996121912868
Error: 0.02340728917277522
Error: 0.02302360552036342
[[0.01509335]
 [0.97846218]
 [0.97414206]
 [0.02814369]]
0
1
1
0</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>KNN</title>
    <url>/2020/07/10/KNN/</url>
    <content><![CDATA[<p>KNNä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line">x_data = np.array([[<span class="number">3</span>,<span class="number">104</span>],[<span class="number">2</span>,<span class="number">100</span>],[<span class="number">1</span>,<span class="number">81</span>],[<span class="number">101</span>,<span class="number">10</span>],[<span class="number">99</span>,<span class="number">5</span>],[<span class="number">81</span>,<span class="number">2</span>]])</span><br><span class="line">y_data = np.array([<span class="string">'A'</span>,<span class="string">'A'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'B'</span>,<span class="string">'B'</span>])</span><br><span class="line">x_test = np.array([<span class="number">18</span>,<span class="number">90</span>])</span><br><span class="line"></span><br><span class="line">x_data_size = x_data.shape[<span class="number">0</span>]</span><br><span class="line">x_data_size</span><br></pre></td></tr></table></figure>




<pre><code>6</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.tile(x_test,(x_data_size,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>




<pre><code>array([[18, 90],
       [18, 90],
       [18, 90],
       [18, 90],
       [18, 90],
       [18, 90]])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">diffMat = np.tile(x_test,(x_data_size,<span class="number">1</span>)) - x_data</span><br><span class="line">diffMat</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 15, -14],
       [ 16, -10],
       [ 17,   9],
       [-83,  80],
       [-81,  85],
       [-63,  88]])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sqDiffMat = diffMat**<span class="number">2</span></span><br><span class="line">sqDiffMat</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 225,  196],
       [ 256,  100],
       [ 289,   81],
       [6889, 6400],
       [6561, 7225],
       [3969, 7744]], dtype=int32)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sqDistances = sqDiffMat.sum(axis=<span class="number">1</span>)</span><br><span class="line">sqDistances</span><br></pre></td></tr></table></figure>




<pre><code>array([  421,   356,   370, 13289, 13786, 11713], dtype=int32)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">distance = sqDistances**<span class="number">0.5</span></span><br><span class="line">distance</span><br></pre></td></tr></table></figure>




<pre><code>array([ 20.51828453,  18.86796226,  19.23538406, 115.27792503,
       117.41379817, 108.2266141 ])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">sortedDistances = distance.argsort()</span><br><span class="line">sortedDistances</span><br></pre></td></tr></table></figure>




<pre><code>array([1, 2, 0, 5, 3, 4], dtype=int64)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">classCount = &#123;&#125;</span><br><span class="line">k = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">    votelabel = y_data[sortedDistances[i]]</span><br><span class="line">    classCount[votelabel] = classCount.get(votelabel,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">classCount</span><br></pre></td></tr></table></figure>




<pre><code>{&apos;A&apos;: 3, &apos;B&apos;: 2}</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sortedClassCount = sorted(classCount.items(),key=operator.itemgetter(<span class="number">1</span>),reverse=<span class="literal">True</span>)</span><br><span class="line">classCount.items(),sortedClassCount</span><br></pre></td></tr></table></figure>




<pre><code>(dict_items([(&apos;A&apos;, 3), (&apos;B&apos;, 2)]), [(&apos;A&apos;, 3), (&apos;B&apos;, 2)])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">knnclass = sortedClassCount[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">knnclass</span><br></pre></td></tr></table></figure>




<pre><code>&apos;A&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN3.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report,confusion_matrix</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">import</span> random</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">knn</span><span class="params">(x_test,x_data,y_data,k)</span>:</span></span><br><span class="line">    x_data_size = x_data.shape[<span class="number">0</span>]</span><br><span class="line">    np.tile(x_test,(x_data_size,<span class="number">1</span>))</span><br><span class="line">    diffMat = np.tile(x_test,(x_data_size,<span class="number">1</span>))-x_data</span><br><span class="line">    sqDiffMat=diffMat**<span class="number">2</span></span><br><span class="line">    sqDistances=sqDiffMat.sum(axis=<span class="number">1</span>)</span><br><span class="line">    distances=sqDistances**<span class="number">0.5</span></span><br><span class="line">    sortedDistances=distances.argsort()</span><br><span class="line">    classCount=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">        votelabel = y_data[sortedDistances[i]]</span><br><span class="line">        classCount[votelabel]=classCount.get(votelabel,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">    sortedClassCount = sorted(classCount.items(),key=operator.itemgetter(<span class="number">1</span>),reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> sortedClassCount[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">iris = datasets.load_iris()</span><br><span class="line">data_size=iris.data.shape[<span class="number">0</span>]</span><br><span class="line">index = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(data_size)]</span><br><span class="line">random.shuffle(index)</span><br><span class="line">iris.data = iris.data[index]</span><br><span class="line">iris.target = iris.target[index]</span><br><span class="line"></span><br><span class="line">test_size = <span class="number">40</span></span><br><span class="line">x_train = iris.data[test_size:]</span><br><span class="line">x_test = iris.data[:test_size]</span><br><span class="line">y_train = iris.target[test_size:]</span><br><span class="line">y_test = iris.target[:test_size]</span><br><span class="line"></span><br><span class="line">predictions = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(x_test.shape[<span class="number">0</span>]):</span><br><span class="line">    predictions.append(knn(x_test[i],x_train,y_train,<span class="number">5</span>))</span><br><span class="line">    </span><br><span class="line">print(classification_report(y_test,predictions))</span><br></pre></td></tr></table></figure>

<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        13
           1       1.00      1.00      1.00        11
           2       1.00      1.00      1.00        16

    accuracy                           1.00        40
   macro avg       1.00      1.00      1.00        40
weighted avg       1.00      1.00      1.00        40</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(confusion_matrix(y_test,predictions))</span><br></pre></td></tr></table></figure>

<pre><code>[[13  0  0]
 [ 0 11  0]
 [ 0  0 16]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>æœ€è¿‘é‚»ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>PCA</title>
    <url>/2020/07/11/PCA/</url>
    <content><![CDATA[<p>PCAç®€å•ä»£ç å±•ç¤º:</p>
<a id="more"></a>

<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA3.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA4.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA5.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA6.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA7.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA8.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA9.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PCA10.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_digits</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report,confusion_matrix</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">digits = load_digits()</span><br><span class="line">x_data = digits.data</span><br><span class="line">y_data = digits.target</span><br><span class="line">x_train,x_test,y_train,y_test = train_test_split(x_data,y_data)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_data.shape</span><br></pre></td></tr></table></figure>




<pre><code>(1797, 64)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mlp = MLPClassifier(hidden_layer_sizes=(<span class="number">100</span>,<span class="number">50</span>), max_iter=<span class="number">500</span>)</span><br><span class="line">mlp.fit(x_train,y_train)</span><br></pre></td></tr></table></figure>




<pre><code>MLPClassifier(activation=&apos;relu&apos;, alpha=0.0001, batch_size=&apos;auto&apos;, beta_1=0.9,
              beta_2=0.999, early_stopping=False, epsilon=1e-08,
              hidden_layer_sizes=(100, 50), learning_rate=&apos;constant&apos;,
              learning_rate_init=0.001, max_fun=15000, max_iter=500,
              momentum=0.9, n_iter_no_change=10, nesterovs_momentum=True,
              power_t=0.5, random_state=None, shuffle=True, solver=&apos;adam&apos;,
              tol=0.0001, validation_fraction=0.1, verbose=False,
              warm_start=False)</code></pre><p>åæ–¹å·®ä»£ç å½¢å¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åŸå‹ï¼šdef cov(m, y&#x3D;None, rowvar&#x3D;True, bias&#x3D;False, ddof&#x3D;None, fweights&#x3D;None,aweights&#x3D;None)</span><br><span class="line">m:ä¸€ç»´æˆ–åˆ™äºŒç»´çš„æ•°ç»„ï¼Œé»˜è®¤æƒ…å†µä¸‹æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå˜é‡ï¼ˆå±æ€§ï¼‰ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªè§‚æµ‹</span><br><span class="line">y:ä¸må…·æœ‰ä¸€æ ·çš„å½¢å¼çš„ä¸€ç»„æ•°æ®</span><br><span class="line">rowvar:é»˜è®¤ä¸ºTrue,æ­¤æ—¶æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå˜é‡ï¼ˆå±æ€§ï¼‰ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªè§‚æµ‹ï¼›ä¸ºFalseæ—¶ï¼Œåˆ™åä¹‹</span><br><span class="line">bias:é»˜è®¤ä¸ºFalse,æ­¤æ—¶æ ‡å‡†åŒ–æ—¶é™¤ä»¥n-1ï¼›åä¹‹ä¸ºnã€‚å…¶ä¸­nä¸ºè§‚æµ‹æ•°</span><br><span class="line">ddof:ç±»å‹æ˜¯intï¼Œå½“å…¶å€¼éNoneæ—¶ï¼Œbiaså‚æ•°ä½œç”¨å°†å¤±æ•ˆã€‚å½“ddof&#x3D;1æ—¶ï¼Œå°†ä¼šè¿”å›æ— åä¼°è®¡ï¼ˆé™¤ä»¥n-1ï¼‰ï¼Œå³ä½¿æŒ‡å®šäº†fweightså’Œaweightså‚æ•°ï¼›å½“ddof&#x3D;0æ—¶ï¼Œåˆ™è¿”å›ç®€å•å¹³å‡å€¼ã€‚</span><br><span class="line">frequency weights:ä¸€ç»´æ•°ç»„ï¼Œä»£è¡¨æ¯ä¸ªè§‚æµ‹è¦é‡å¤çš„æ¬¡æ•°ï¼ˆç›¸å½“äºç»™è§‚æµ‹èµ‹äºˆæƒé‡ï¼‰</span><br><span class="line">analytic weights:ä¸€ç»´æ•°ç»„ï¼Œä»£è¡¨è§‚æµ‹çŸ¢é‡æƒé‡ã€‚å¯¹äºè¢«è®¤ä¸ºâ€œé‡è¦â€çš„è§‚å¯Ÿ,è¿™äº›ç›¸å¯¹æƒé‡é€šå¸¸å¾ˆå¤§,è€Œå¯¹äºè¢«è®¤ä¸ºä¸å¤ªé‡è¦çš„è§‚å¯Ÿ,è¿™äº›ç›¸å¯¹æƒé‡è¾ƒå°ã€‚å¦‚æœddof &#x3D; 0,åˆ™å¯ä»¥ä½¿ç”¨æƒé‡æ•°ç»„å°†æ¦‚ç‡åˆ†é…ç»™è§‚æµ‹å‘é‡ã€‚</span><br></pre></td></tr></table></figure>
<p>ä»£ç ç¤ºä¾‹<br>åŸºæœ¬ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"># è®¡ç®—åæ–¹å·®çš„æ—¶å€™ï¼Œä¸€è¡Œä»£è¡¨ä¸€ä¸ªç‰¹å¾</span><br><span class="line"># ä¸‹é¢è®¡ç®—cov(T, S, M)</span><br><span class="line">T &#x3D; np.array([9, 15, 25, 14, 10, 18, 0, 16, 5, 19, 16, 20])</span><br><span class="line">S &#x3D; np.array([39, 56, 93, 61, 50, 75, 32, 85, 42, 70, 66, 80])</span><br><span class="line">M &#x3D; np.asarray([38, 56, 90, 63, 56, 77, 30, 80, 41, 79, 64, 88])</span><br><span class="line">X &#x3D; np.vstack((T, S, M))</span><br><span class="line"># Xæ¯è¡Œä»£è¡¨ä¸€ä¸ªå±æ€§</span><br><span class="line">#  æ¯åˆ—ä»£è¡¨ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ–è€…è¯´è§‚æµ‹</span><br><span class="line">print(np.cov(X))</span><br><span class="line"></span><br><span class="line"># [[ 47.71969697 122.9469697  129.59090909]</span><br><span class="line">#  [122.9469697  370.08333333 374.59090909]</span><br><span class="line">#  [129.59090909 374.59090909 399.        ]]</span><br></pre></td></tr></table></figure>
<p>é‡ç‚¹ï¼šåæ–¹å·®çŸ©é˜µè®¡ç®—çš„æ˜¯ä¸åŒç»´åº¦ä¹‹é—´çš„åæ–¹å·®ï¼Œè€Œä¸æ˜¯ä¸åŒæ ·æœ¬ä¹‹é—´ã€‚æ‹¿åˆ°ä¸€ä¸ªæ ·æœ¬çŸ©é˜µï¼Œé¦–å…ˆè¦æ˜ç¡®çš„å°±æ˜¯è¡Œä»£è¡¨ä»€ä¹ˆï¼Œåˆ—ä»£è¡¨ä»€ä¹ˆã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zeroMean</span><span class="params">(dataMat)</span>:</span></span><br><span class="line">    meanVal = np.mean(dataMat, axis=<span class="number">0</span>)</span><br><span class="line">    newData = dataMat - meanVal</span><br><span class="line">    <span class="keyword">return</span> newData, meanVal</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pca</span><span class="params">(dataMat,top)</span>:</span></span><br><span class="line">    newData, meanVal = zeroMean(dataMat)</span><br><span class="line">    covMat = np.cov(newData,rowvar=<span class="number">0</span>) <span class="comment"># æ±‚æ ·æœ¬çš„åæ–¹å·®çŸ©é˜µã€‚</span></span><br><span class="line">    eigVals,eigVects = np.linalg.eig(np.mat(covMat)) <span class="comment"># å¯¹åæ–¹å·®1m ğ‘‹ğ‘‹ğ‘‡çŸ©é˜µåšç‰¹å¾å€¼åˆ†è§£ã€‚</span></span><br><span class="line">    eigValIndice = np.argsort(eigVals)</span><br><span class="line">    n_eigValIndice = eigValIndice[<span class="number">-1</span>:-(top+<span class="number">1</span>):<span class="number">-1</span>] <span class="comment"># é€‰å‡ºæœ€å¤§çš„kä¸ªç‰¹å¾å€¼å¯¹åº”çš„kä¸ªç‰¹å¾å‘é‡ã€‚</span></span><br><span class="line">    n_eigVect = eigVects[:,n_eigValIndice]</span><br><span class="line">    lowDDataMat = newData*n_eigVect <span class="comment"># å°†åŸå§‹æ•°æ®æŠ•å½±åˆ°é€‰å–çš„ç‰¹å¾å‘é‡ä¸Šã€‚</span></span><br><span class="line">    reconMat = (lowDDataMat*n_eigVect.T)+meanVal</span><br><span class="line">    <span class="keyword">return</span> lowDDataMat,reconMat</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lowDDataMat,reconMat = pca(x_data,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = np.array(lowDDataMat)[:,<span class="number">0</span>]</span><br><span class="line">y = np.array(lowDDataMat)[:,<span class="number">1</span>]</span><br><span class="line">plt.scatter(x,y,c=<span class="string">'r'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/11/PCA/output_8_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">predictions = mlp.predict(x_data)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = np.array(lowDDataMat)[:,<span class="number">0</span>]</span><br><span class="line">y = np.array(lowDDataMat)[:,<span class="number">1</span>]</span><br><span class="line">plt.scatter(x,y,c=y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/11/PCA/output_10_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lowDDataMat,reconMat = pca(x_data,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">x = np.array(lowDDataMat)[:,<span class="number">0</span>]</span><br><span class="line">y = np.array(lowDDataMat)[:,<span class="number">1</span>]</span><br><span class="line">z = np.array(lowDDataMat)[:,<span class="number">2</span>]</span><br><span class="line">ax = plt.figure().add_subplot(<span class="number">111</span>,projection=<span class="string">'3d'</span>)</span><br><span class="line">ax.scatter(x,y,z,c=y_data,s=<span class="number">10</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/11/PCA/output_12_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>ä¸»æˆåˆ†åˆ†æ</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoå¼€å‘åšå®¢</title>
    <url>/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<ul>
<li>1.<a href="#header1">ä»0æ­å»º</a></li>
<li>2.<a href="#header2">é‡åˆ°çš„å‘</a></li>
<li>3.<a href="#header3">å›¾ç‰‡æ”¾ç½®é—®é¢˜</a></li>
<li>4.<a href="#header4">æ›´æ¢ä¸»é¢˜</a></li>
</ul>
<a id="more"></a>

<h1 id="è§†é¢‘æ‰‹æŠŠæ‰‹æ•™ä½ ä»0å¼€å§‹æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢hexoå‚è€ƒ"><a href="#è§†é¢‘æ‰‹æŠŠæ‰‹æ•™ä½ ä»0å¼€å§‹æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢hexoå‚è€ƒ" class="headerlink" title="è§†é¢‘æ‰‹æŠŠæ‰‹æ•™ä½ ä»0å¼€å§‹æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢hexoå‚è€ƒ"></a><span id="header1">è§†é¢‘æ‰‹æŠŠæ‰‹æ•™ä½ ä»0å¼€å§‹æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢hexo</span><a href="https://www.bilibili.com/video/BV1Yb411a7ty/?spm_id_from=333.788.videocard.4" target="_blank" rel="noopener">å‚è€ƒ</a></h1><ul>
<li><p>å®‰è£…node<br><a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">nodeå®˜ç½‘</a>å¯ä»¥ç›´æ¥ä¸‹è½½node,å¯ä»¥æ¢æº</p>
</li>
<li><p>npmæ¢æº(å¯é€‰)<br>é»˜è®¤çš„npmæº â€”â€” <a href="https://registry.npmjs.org" target="_blank" rel="noopener">https://registry.npmjs.org</a> æ¯”è¾ƒæ…¢,å¯ä»¥æ¢æˆæ·˜å®é•œåƒ â€”â€” <a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<p>æ¢å›æ¥åŒç†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npmjs.org</span><br></pre></td></tr></table></figure></li>
<li><p>å…¨å±€å®‰è£…hexo-cli(å‰ææ˜¯å®‰è£…äº†node,å¯ä»¥ç”¨npmå‘½ä»¤)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i -g hexo-cli</span><br></pre></td></tr></table></figure></li>
<li><p>åˆå§‹åŒ–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo init (æ–‡ä»¶å¤¹å)</span><br></pre></td></tr></table></figure>
<p>ä¸åŠ æ–‡ä»¶å¤¹åå°±æ˜¯åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹</p>
</li>
<li><p>æ–°å»ºä¸€ç¯‡æ–‡ç« </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo n æ–‡ç« å</span><br><span class="line">æˆ–è€…</span><br><span class="line">hexo new æ–‡ç« å</span><br></pre></td></tr></table></figure>
<p>æ–‡ç« å†…å®¹ä½¿ç”¨<a href="https://githubzhangshuai.github.io/2020/07/08/Markdown%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" target="_blank" rel="noopener">Markdown</a>è¯­æ³•è¿›è¡Œä¹¦å†™å³å¯</p>
</li>
<li><p>åœ¨çº¿é¢„è§ˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo server</span><br><span class="line">æˆ–è€…</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>æµè§ˆå™¨çª—å£è¾“å…¥localhost:4000å³å¯é¢„è§ˆ</p>
</li>
<li><p>éƒ¨ç½²</p>
<ul>
<li>å…ˆæ‰‹åŠ¨å®‰è£…hexo-deployer-git<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i --save hexo-deployer-git</span><br></pre></td></tr></table></figure></li>
<li>ç„¶ågithubæ–°å»ºä»“åº“,ä»“åº“åä¸ºxxx.github.io,xxxä¸ºgithubè´¦å·å,å¦‚å›¾,æˆ‘çš„xxxä¸ºGitHubzhangshuaiæ•…ä»“åº“åä¸ºGitHubzhangshuai.github.io.git<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/hexo%E6%88%AA%E5%9B%BE.png" alt="ç¤ºä¾‹å›¾ç‰‡"></li>
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶<br>æ‰¾åˆ°_config.ymlæ–‡ä»¶,ä¿®æ”¹deployéƒ¨åˆ†(100è¡Œå·¦å³)<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;deployment.html</span><br><span class="line">deploy:</span><br><span class="line">type: git</span><br><span class="line">repo: https:&#x2F;&#x2F;github.com&#x2F;GitHubzhangshuai&#x2F;GitHubzhangshuai.github.io.git</span><br><span class="line">branch: master</span><br></pre></td></tr></table></figure></li>
<li>éƒ¨ç½²åˆ°githubä¸Š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo deploy</span><br><span class="line">æˆ–è€…</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure></li>
<li>è®¿é—®<br>æµè§ˆå™¨åœ°å€æ è¾“å…¥xxx.github.io</li>
</ul>
</li>
</ul>
<h1 id="é‡åˆ°çš„å‘"><a href="#é‡åˆ°çš„å‘" class="headerlink" title="é‡åˆ°çš„å‘"></a><span id="header2">é‡åˆ°çš„å‘</span></h1><ul>
<li>npmå®‰è£…å¤±è´¥<br>æ£€æŸ¥ç½‘ç»œé—®é¢˜å¹¶ä¸”æ¢æ·˜å®æº<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure></li>
<li>éƒ¨ç½²æ—¶å‡ºç°é”™è¯¯,<a href="https://blog.csdn.net/HTL2018/article/details/106876940?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">å‚è€ƒ</a></li>
</ul>
<ul>
<li><p>1.é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">errorï¼šspawn failed...</span><br><span class="line">æˆ–è€…:</span><br><span class="line">fatal: cannot lock ref &#39;HEAD&#39;: unable to resolve reference HEAD: Invalid argument error: src refspec</span><br><span class="line">æˆ–è€…:</span><br><span class="line">error: src refspec HEAD does not match any.</span><br></pre></td></tr></table></figure></li>
<li><ol start="2">
<li>æ€»ç»“ä¸€ä¸‹<br>é—®é¢˜å¤§å¤šæ˜¯å› ä¸ºgitè¿›è¡Œpushæˆ–è€…hexo dçš„æ—¶å€™æ”¹å˜äº†ä¸€äº›.deploy_gitæ–‡ä»¶ä¸‹çš„å†…å®¹ã€‚</li>
</ol>
</li>
<li><ol start="3">
<li>è§£å†³åŠæ³•<ul>
<li>3-1.åˆ é™¤.deploy_gitæ–‡ä»¶å¤¹;</li>
<li>3-2.å…¨å±€è®¾ç½®gitçš„core.autocrlfä¸ºfalse;<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥git config --global core.autocrlf false</span><br></pre></td></tr></table></figure></li>
<li>3-2.ç„¶åï¼Œä¾æ¬¡æ‰§è¡Œï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
</li>
</ul>
<h1 id="hexoå›¾ç‰‡é—®é¢˜"><a href="#hexoå›¾ç‰‡é—®é¢˜" class="headerlink" title="hexoå›¾ç‰‡é—®é¢˜"></a><span id="header3">hexoå›¾ç‰‡é—®é¢˜</span></h1><ul>
<li>1.æ”¾åœ¨OSSä¸Š,æˆ‘ç”¨çš„é˜¿é‡Œäº‘çš„oss(è®°å¾—è®¾ç½®bucketçš„å…¬å…±è¯»æƒé™)<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/2.jpg" alt="xx"></li>
<li>2.ä½¿ç”¨base64æ ¼å¼</li>
<li>3.ä½¿ç”¨æ’ä»¶hexo-asset-image<br>å®‰è£…æ’ä»¶<br>æ³¨æ„:<br>ä½¿ç”¨ npm install <a href="https://github.com/CodeFalling/hexo-asset-image" target="_blank" rel="noopener">https://github.com/CodeFalling/hexo-asset-image</a> â€“save å®‰è£…0.0.5ç‰ˆæœ¬çš„hexo-asset-imageæ’ä»¶ã€‚ ä½¿ç”¨ npm install hexo-asset-image â€“save å®‰è£…çš„æ˜¯1.0.0ç‰ˆæœ¬çš„hexo-asset-imageæ’ä»¶ã€‚ ä¸¤è€…æœ€ç›´æ¥çš„åŒºåˆ«æ˜¯æ˜ å°„å…³ç³»ä¸åŒã€‚ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install https:&#x2F;&#x2F;github.com&#x2F;CodeFalling&#x2F;hexo-asset-image --save (æœ‰æ•ˆ)</span><br><span class="line">npm install hexo-asset-image --save (æ— æ•ˆ)</span><br></pre></td></tr></table></figure>
åœ¨_config.ymlé…ç½®æ–‡ä»¶ä¸­(44è¡Œå·¦å³)ï¼Œä¿®æ”¹ä¸º <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure>
è®°å¾—é‡å¯æœåŠ¡å™¨(VS codeçš„MDé¢„è§ˆæ’ä»¶ä¸‹æ— æ•ˆ)<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="æ›´æ¢ä¸»é¢˜"><a href="#æ›´æ¢ä¸»é¢˜" class="headerlink" title="æ›´æ¢ä¸»é¢˜"></a><span id="#header4">æ›´æ¢ä¸»é¢˜</span></h1><p><a href="https://www.jianshu.com/p/33bc0a0a6e90" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<ul>
<li><p>1.ä¸‹è½½ <a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">NexT</a> ä¸»é¢˜,å°†ä¸»é¢˜å…‹éš†åˆ° themes ç›®å½•ä¸‹ï¼Œä»¥ä¸‹æˆªå›¾å°±æ˜¯ clone ä¹‹åçš„ç»“æœã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &lt;åšå®¢å­˜æ”¾çš„ç›®å½•&gt;</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;iissnan&#x2F;hexo-theme-next themes&#x2F;next</span><br></pre></td></tr></table></figure></li>
<li><p>2.æ‰“å¼€ _config.yml æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸ºç«™ç‚¹é…ç½®æ–‡ä»¶,å°†ä¸»é¢˜ä¿®æ”¹ä¸º next</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">theme: landscape</span><br><span class="line">æ”¹ä¸º</span><br><span class="line">theme: next</span><br></pre></td></tr></table></figure></li>
<li><p>3.é‡å¯æœåŠ¡å™¨å‘ç°æ‰€æœ‰çš„ç‚¹å‡»åè¾¹éƒ½å¸¦äº†%20,å¦‚å›¾<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/3.png" alt="x"><br><a href="https://blog.csdn.net/weixin_43790779/article/details/104854588" target="_blank" rel="noopener">è§£å†³</a>:<br>æ‰¾åˆ°nextçš„é…ç½®æ–‡ä»¶themes\next_config.yml,å°†é…ç½®æ–‡ä»¶é‡Œ ||ä¹‹å‰æ‰€æœ‰çš„ç©ºæ ¼åˆ æ‰,æ”¹ä¸ºä»¥ä¸‹å³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: &#x2F;||home</span><br><span class="line">  #about: &#x2F;about&#x2F;||user</span><br><span class="line">  #tags: &#x2F;tags&#x2F;||tags</span><br><span class="line">  #categories: &#x2F;categories&#x2F;||th</span><br><span class="line">  archives: &#x2F;archives&#x2F;||archive</span><br><span class="line">  #schedule: &#x2F;schedule&#x2F;||calendar</span><br><span class="line">  #sitemap: &#x2F;sitemap.xml||sitemap</span><br><span class="line">  #commonweal: &#x2F;404&#x2F;||heartbeat</span><br></pre></td></tr></table></figure></li>
<li><p>4.è®¾ç½®èœå•<br>èœå•é…ç½®åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€æ˜¯èœå•é¡¹ï¼ˆåç§°å’Œé“¾æ¥ï¼‰ï¼Œç¬¬äºŒæ˜¯èœå•é¡¹çš„æ˜¾ç¤ºæ–‡æœ¬ï¼Œç¬¬ä¸‰æ˜¯èœå•é¡¹å¯¹åº”çš„å›¾æ ‡</p>
<ul>
<li>4.1è®¾å®šèœå•é¡¹çš„åç§°å’Œé“¾æ¥<br>æ‰¾åˆ°nextçš„é…ç½®æ–‡ä»¶themes\next_config.yml<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">home: &#x2F;</span><br><span class="line">archives: &#x2F;archives</span><br><span class="line">about: &#x2F;about</span><br><span class="line">categories: &#x2F;categories</span><br><span class="line">tags: &#x2F;tags</span><br></pre></td></tr></table></figure></li>
<li>4.2è®¾å®šèœå•é¡¹çš„æ˜¾ç¤ºæ–‡æœ¬<br>åœ¨è®¾ç½® èœå•é¡¹çš„åç§°å’Œé“¾æ¥ä¸­çš„åç§°å¹¶ä¸ä¼šç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œè€Œæ˜¯ä¼šé€šè¿‡ NexT ä¸»é¢˜ç›®å½•ä¸‹çš„ languages/{language}.yml æ‰¾åˆ°å¯¹åº”çš„æ˜¾ç¤ºæ–‡æœ¬ã€‚<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/5.jpg" alt="x"></li>
<li>4.3 è®¾å®šèœå•é¡¹çš„å›¾æ ‡<br>å¯¹åº”çš„å­—æ®µæ˜¯ menu_iconsã€‚ æ­¤è®¾å®šæ ¼å¼æ˜¯ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">item name: icon name</span><br></pre></td></tr></table></figure>
ï¼Œå…¶ä¸­ item name ä¸ä¸Šä¸€æ­¥æ‰€é…ç½®çš„èœå•åå­—å¯¹åº”ï¼Œicon name æ˜¯ Font Awesome å›¾æ ‡çš„ åå­—ã€‚è€Œ enable å¯ç”¨äºæ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå›¾æ ‡ï¼Œä½ å¯ä»¥è®¾ç½®æˆ false æ¥å»æ‰å›¾æ ‡ã€‚</li>
</ul>
</li>
<li><p>5.ç”Ÿæˆå­é¡µé¢<br>å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page xxx</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨sourceé‡Œä¼šç”Ÿæˆå’Œ_postsåŒçº§çš„æ–‡ä»¶å¤¹xxx,è¿›å…¥xxxç¼–è¾‘index.md,ä¿®æ”¹æˆä»¥ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">date: 2020-07-09 00:58:42</span><br><span class="line">type: &quot;xxx&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­xxxå¯ä¸ºabout/categories/tags/schedule/sitemap/404</p>
</li>
<li><p>6.nexté€‰æ‹© Scheme<br>Scheme æ˜¯ NexT æä¾›çš„ä¸€ç§ç‰¹æ€§ï¼Œå€ŸåŠ©äº Schemeï¼ŒNexT ä¸ºä½ æä¾›å¤šç§ä¸åŒçš„å¤–è§‚ã€‚åŒæ—¶ï¼Œå‡ ä¹æ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥ åœ¨ Scheme ä¹‹é—´å…±ç”¨ã€‚ç›®å‰ NexT æ”¯æŒä¸‰ç§ Schemeï¼Œä»–ä»¬æ˜¯ï¼š<br>æ‰¾åˆ°nextçš„é…ç½®æ–‡ä»¶themes\next_config.yml</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Muse - é»˜è®¤ Schemeï¼Œè¿™æ˜¯ NexT æœ€åˆçš„ç‰ˆæœ¬ï¼Œé»‘ç™½ä¸»è°ƒï¼Œå¤§é‡ç•™ç™½</span><br><span class="line">Mist - Muse çš„ç´§å‡‘ç‰ˆæœ¬ï¼Œæ•´æ´æœ‰åºçš„å•æ å¤–è§‚</span><br><span class="line">Pisces - åŒæ  Schemeï¼Œå°å®¶ç¢§ç‰ä¼¼çš„æ¸…æ–°</span><br></pre></td></tr></table></figure>
<p>scheme: Muse<br>æ•ˆæœå¦‚ä¸‹<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme1.png" alt="x"><br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme1-2.png" alt="x"><br>scheme: Mist<br>æ•ˆæœå¦‚ä¸‹<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme2.png" alt="x"><br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme2-1.png" alt="x"><br>scheme: Pisces<br>æ•ˆæœå¦‚ä¸‹<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme3.png" alt="x"><br>scheme: Gemini<br>æ•ˆæœå¦‚ä¸‹<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/theme4.png" alt="x"></p>
</li>
<li><p>7.æ·»åŠ ç™¾åº¦/è°·æ­Œ/æœ¬åœ° è‡ªå®šä¹‰ç«™ç‚¹å†…å®¹æœç´¢<br>å®‰è£… hexo-generator-searchdbï¼Œåœ¨ç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘ ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œæ–°å¢ä»¥ä¸‹å†…å®¹åˆ°ä»»æ„ä½ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.ymlï¼Œå¯ç”¨æœ¬åœ°æœç´¢åŠŸèƒ½ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Local search</span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br></pre></td></tr></table></figure>
</li>
<li><p>8.ä¾§è¾¹æ ç¤¾äº¤é“¾æ¥<br>ä¾§æ ç¤¾äº¤é“¾æ¥çš„ä¿®æ”¹åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€æ˜¯é“¾æ¥ï¼Œç¬¬äºŒæ˜¯é“¾æ¥å›¾æ ‡ã€‚ ä¸¤è€…é…ç½®å‡åœ¨ ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.yml ä¸­ã€‚</p>
</li>
</ul>
<p>é“¾æ¥æ”¾ç½®åœ¨ social å­—æ®µä¸‹ï¼Œä¸€è¡Œä¸€ä¸ªé“¾æ¥ã€‚å…¶é”®å€¼æ ¼å¼æ˜¯ æ˜¾ç¤ºæ–‡æœ¬: é“¾æ¥åœ°å€ã€‚</p>
<p>é…ç½®ç¤ºä¾‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Social links</span><br><span class="line">social:</span><br><span class="line">  GitHub: https:&#x2F;&#x2F;github.com&#x2F;your-user-name</span><br><span class="line">  Twitter: https:&#x2F;&#x2F;twitter.com&#x2F;your-user-name</span><br><span class="line">  å¾®åš: http:&#x2F;&#x2F;weibo.com&#x2F;your-user-name</span><br><span class="line">  è±†ç“£: http:&#x2F;&#x2F;douban.com&#x2F;people&#x2F;your-user-name</span><br><span class="line">  çŸ¥ä¹: http:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;your-user-name</span><br><span class="line">  # ç­‰ç­‰</span><br></pre></td></tr></table></figure>
<p>è®¾å®šé“¾æ¥çš„å›¾æ ‡ï¼Œå¯¹åº”çš„å­—æ®µæ˜¯ social_iconsã€‚å…¶é”®å€¼æ ¼å¼æ˜¯ åŒ¹é…é”®: Font Awesome å›¾æ ‡åç§°ï¼Œ åŒ¹é…é”® ä¸ä¸Šä¸€æ­¥æ‰€é…ç½®çš„é“¾æ¥çš„ æ˜¾ç¤ºæ–‡æœ¬ ç›¸åŒï¼ˆå¤§å°å†™ä¸¥æ ¼åŒ¹é…ï¼‰ï¼Œå›¾æ ‡åç§° æ˜¯ Font Awesome å›¾æ ‡çš„åå­—ï¼ˆä¸å¿…å¸¦ fa- å‰ç¼€ï¼‰ã€‚ enable é€‰é¡¹ç”¨äºæ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå›¾æ ‡ï¼Œä½ å¯ä»¥è®¾ç½®æˆ false æ¥å»æ‰å›¾æ ‡ã€‚</p>
<p>é…ç½®ç¤ºä¾‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Social Icons</span><br><span class="line">social_icons:</span><br><span class="line">  enable: true</span><br><span class="line">  # Icon Mappings</span><br><span class="line">  GitHub: github</span><br><span class="line">  Twitter: twitter</span><br><span class="line">  å¾®åš: weibo</span><br></pre></td></tr></table></figure>

<ul>
<li>9.è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜<br>NexT ä½¿ç”¨ Tomorrow Theme ä½œä¸ºä»£ç é«˜äº®ï¼Œå…±æœ‰5æ¬¾ä¸»é¢˜ä¾›ä½ é€‰æ‹©ã€‚ NexT é»˜è®¤ä½¿ç”¨çš„æ˜¯ ç™½è‰²çš„ normal ä¸»é¢˜ï¼Œå¯é€‰çš„å€¼æœ‰ normalï¼Œnightï¼Œ night blueï¼Œ night brightï¼Œ night eightiesï¼š</li>
</ul>
<p>themes\next_config.ymlæ›´æ”¹ highlight_theme å­—æ®µï¼Œå°†å…¶å€¼è®¾å®šæˆä½ æ‰€å–œçˆ±çš„é«˜äº®ä¸»é¢˜ï¼Œä¾‹å¦‚ï¼š</p>
<p>é«˜äº®ä¸»é¢˜è®¾ç½®ç¤ºä¾‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Code Highlight theme</span><br><span class="line"># Available value: normal | night | night eighties | night blue | night bright</span><br><span class="line"># https:&#x2F;&#x2F;github.com&#x2F;chriskempson&#x2F;tomorrow-theme</span><br><span class="line">highlight_theme: normal</span><br></pre></td></tr></table></figure>

<ul>
<li>10.å¼€å¯æ‰“èµåŠŸèƒ½ ç”± habren è´¡çŒ®<br>è¶Šæ¥è¶Šå¤šçš„å¹³å°ï¼ˆå¾®ä¿¡å…¬ä¼—å¹³å°ï¼Œæ–°æµªå¾®åšï¼Œç®€ä¹¦ï¼Œç™¾åº¦æ‰“èµç­‰ï¼‰æ”¯æŒæ‰“èµåŠŸèƒ½ï¼Œä»˜è´¹é˜…è¯»æ—¶ä»£è¶Šæ¥è¶Šè¿‘ï¼Œç‰¹æ­¤å¢åŠ äº†æ‰“èµåŠŸèƒ½ï¼Œæ”¯æŒå¾®ä¿¡æ‰“èµå’Œæ”¯ä»˜å®æ‰“èµã€‚ åªéœ€è¦ ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.yml ä¸­å¡«å…¥ å¾®ä¿¡ å’Œ æ”¯ä»˜å® æ”¶æ¬¾äºŒç»´ç å›¾ç‰‡åœ°å€ å³å¯å¼€å¯è¯¥åŠŸèƒ½ã€‚</li>
</ul>
<p>æ‰“èµåŠŸèƒ½é…ç½®ç¤ºä¾‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">reward_comment: åšæŒåŸåˆ›æŠ€æœ¯åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼</span><br><span class="line">wechatpay: &#x2F;path&#x2F;to&#x2F;wechat-reward-image</span><br><span class="line">alipay: &#x2F;path&#x2F;to&#x2F;alipay-reward-image</span><br></pre></td></tr></table></figure>

<ul>
<li>11.é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ<br>å°çº¢å¿ƒæ•ˆæœ<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/click1.gif" alt><br>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š<br>åœ¨/themes/next/source/js/srcä¸‹æ–°å»ºæ–‡ä»¶ clicklove.js ï¼Œæ¥ç€æŠŠä¸‹é¢çš„ä»£ç æ‹·è´ç²˜è´´åˆ° clicklove.js æ–‡ä»¶ä¸­<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">!function(e,t,a)&#123;function n()&#123;c(&quot;.heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: &#39;&#39;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;&quot;),o(),r()&#125;function r()&#123;for(var e&#x3D;0;e&lt;d.length;e++)d[e].alpha&lt;&#x3D;0?(t.body.removeChild(d[e].el),d.splice(e,1)):(d[e].y--,d[e].scale+&#x3D;.004,d[e].alpha-&#x3D;.013,d[e].el.style.cssText&#x3D;&quot;left:&quot;+d[e].x+&quot;px;top:&quot;+d[e].y+&quot;px;opacity:&quot;+d[e].alpha+&quot;;transform:scale(&quot;+d[e].scale+&quot;,&quot;+d[e].scale+&quot;) rotate(45deg);background:&quot;+d[e].color+&quot;;z-index:99999&quot;);requestAnimationFrame(r)&#125;function o()&#123;var t&#x3D;&quot;function&quot;&#x3D;&#x3D;typeof e.onclick&amp;&amp;e.onclick;e.onclick&#x3D;function(e)&#123;t&amp;&amp;t(),i(e)&#125;&#125;function i(e)&#123;var a&#x3D;t.createElement(&quot;div&quot;);a.className&#x3D;&quot;heart&quot;,d.push(&#123;el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()&#125;),t.body.appendChild(a)&#125;function c(e)&#123;var a&#x3D;t.createElement(&quot;style&quot;);a.type&#x3D;&quot;text&#x2F;css&quot;;try&#123;a.appendChild(t.createTextNode(e))&#125;catch(t)&#123;a.styleSheet.cssText&#x3D;e&#125;t.getElementsByTagName(&quot;head&quot;)[0].appendChild(a)&#125;function s()&#123;return&quot;rgb(&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;)&quot;&#125;var d&#x3D;[];e.requestAnimationFrame&#x3D;function()&#123;return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e)&#123;setTimeout(e,1e3&#x2F;60)&#125;&#125;(),n()&#125;(window,document);</span><br></pre></td></tr></table></figure>
åœ¨\themes\next\layout_layout.swigæ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;src&#x2F;clicklove.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>å¦ä¸€ç§ç‚¹å‡»æ•ˆæœå¦‚å›¾æ‰€ç¤º<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/click2.png" alt><br>åœ¨themes/next/source/js/srcé‡Œé¢å»ºä¸€ä¸ªå«fireworks.jsçš„æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;function updateCoords(e)&#123;pointerX&#x3D;(e.clientX||e.touches[0].clientX)-canvasEl.getBoundingClientRect().left,pointerY&#x3D;e.clientY||e.touches[0].clientY-canvasEl.getBoundingClientRect().top&#125;function setParticuleDirection(e)&#123;var t&#x3D;anime.random(0,360)*Math.PI&#x2F;180,a&#x3D;anime.random(50,180),n&#x3D;[-1,1][anime.random(0,1)]*a;return&#123;x:e.x+n*Math.cos(t),y:e.y+n*Math.sin(t)&#125;&#125;function createParticule(e,t)&#123;var a&#x3D;&#123;&#125;;return a.x&#x3D;e,a.y&#x3D;t,a.color&#x3D;colors[anime.random(0,colors.length-1)],a.radius&#x3D;anime.random(16,32),a.endPos&#x3D;setParticuleDirection(a),a.draw&#x3D;function()&#123;ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.fillStyle&#x3D;a.color,ctx.fill()&#125;,a&#125;function createCircle(e,t)&#123;var a&#x3D;&#123;&#125;;return a.x&#x3D;e,a.y&#x3D;t,a.color&#x3D;&quot;#F00&quot;,a.radius&#x3D;0.1,a.alpha&#x3D;0.5,a.lineWidth&#x3D;6,a.draw&#x3D;function()&#123;ctx.globalAlpha&#x3D;a.alpha,ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.lineWidth&#x3D;a.lineWidth,ctx.strokeStyle&#x3D;a.color,ctx.stroke(),ctx.globalAlpha&#x3D;1&#125;,a&#125;function renderParticule(e)&#123;for(var t&#x3D;0;t&lt;e.animatables.length;t++)&#123;e.animatables[t].target.draw()&#125;&#125;function animateParticules(e,t)&#123;for(var a&#x3D;createCircle(e,t),n&#x3D;[],i&#x3D;0;i&lt;numberOfParticules;i++)&#123;n.push(createParticule(e,t))&#125;anime.timeline().add(&#123;targets:n,x:function(e)&#123;return e.endPos.x&#125;,y:function(e)&#123;return e.endPos.y&#125;,radius:0.1,duration:anime.random(1200,1800),easing:&quot;easeOutExpo&quot;,update:renderParticule&#125;).add(&#123;targets:a,radius:anime.random(80,160),lineWidth:0,alpha:&#123;value:0,easing:&quot;linear&quot;,duration:anime.random(600,800)&#125;,duration:anime.random(1200,1800),easing:&quot;easeOutExpo&quot;,update:renderParticule,offset:0&#125;)&#125;function debounce(e,t)&#123;var a;return function()&#123;var n&#x3D;this,i&#x3D;arguments;clearTimeout(a),a&#x3D;setTimeout(function()&#123;e.apply(n,i)&#125;,t)&#125;&#125;var canvasEl&#x3D;document.querySelector(&quot;.fireworks&quot;);if(canvasEl)&#123;var ctx&#x3D;canvasEl.getContext(&quot;2d&quot;),numberOfParticules&#x3D;30,pointerX&#x3D;0,pointerY&#x3D;0,tap&#x3D;&quot;mousedown&quot;,colors&#x3D;[&quot;#FF1461&quot;,&quot;#18FF92&quot;,&quot;#5A87FF&quot;,&quot;#FBF38C&quot;],setCanvasSize&#x3D;debounce(function()&#123;canvasEl.width&#x3D;2*window.innerWidth,canvasEl.height&#x3D;2*window.innerHeight,canvasEl.style.width&#x3D;window.innerWidth+&quot;px&quot;,canvasEl.style.height&#x3D;window.innerHeight+&quot;px&quot;,canvasEl.getContext(&quot;2d&quot;).scale(2,2)&#125;,500),render&#x3D;anime(&#123;duration:1&#x2F;0,update:function()&#123;ctx.clearRect(0,0,canvasEl.width,canvasEl.height)&#125;&#125;);document.addEventListener(tap,function(e)&#123;&quot;sidebar&quot;!&#x3D;&#x3D;e.target.id&amp;&amp;&quot;toggle-sidebar&quot;!&#x3D;&#x3D;e.target.id&amp;&amp;&quot;A&quot;!&#x3D;&#x3D;e.target.nodeName&amp;&amp;&quot;IMG&quot;!&#x3D;&#x3D;e.target.nodeName&amp;&amp;(render.play(),updateCoords(e),animateParticules(pointerX,pointerY))&#125;,!1),setCanvasSize(),window.addEventListener(&quot;resize&quot;,setCanvasSize,!1)&#125;&quot;use strict&quot;;function updateCoords(e)&#123;pointerX&#x3D;(e.clientX||e.touches[0].clientX)-canvasEl.getBoundingClientRect().left,pointerY&#x3D;e.clientY||e.touches[0].clientY-canvasEl.getBoundingClientRect().top&#125;function setParticuleDirection(e)&#123;var t&#x3D;anime.random(0,360)*Math.PI&#x2F;180,a&#x3D;anime.random(50,180),n&#x3D;[-1,1][anime.random(0,1)]*a;return&#123;x:e.x+n*Math.cos(t),y:e.y+n*Math.sin(t)&#125;&#125;function createParticule(e,t)&#123;var a&#x3D;&#123;&#125;;return a.x&#x3D;e,a.y&#x3D;t,a.color&#x3D;colors[anime.random(0,colors.length-1)],a.radius&#x3D;anime.random(16,32),a.endPos&#x3D;setParticuleDirection(a),a.draw&#x3D;function()&#123;ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.fillStyle&#x3D;a.color,ctx.fill()&#125;,a&#125;function createCircle(e,t)&#123;var a&#x3D;&#123;&#125;;return a.x&#x3D;e,a.y&#x3D;t,a.color&#x3D;&quot;#F00&quot;,a.radius&#x3D;0.1,a.alpha&#x3D;0.5,a.lineWidth&#x3D;6,a.draw&#x3D;function()&#123;ctx.globalAlpha&#x3D;a.alpha,ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.lineWidth&#x3D;a.lineWidth,ctx.strokeStyle&#x3D;a.color,ctx.stroke(),ctx.globalAlpha&#x3D;1&#125;,a&#125;function renderParticule(e)&#123;for(var t&#x3D;0;t&lt;e.animatables.length;t++)&#123;e.animatables[t].target.draw()&#125;&#125;function animateParticules(e,t)&#123;for(var a&#x3D;createCircle(e,t),n&#x3D;[],i&#x3D;0;i&lt;numberOfParticules;i++)&#123;n.push(createParticule(e,t))&#125;anime.timeline().add(&#123;targets:n,x:function(e)&#123;return e.endPos.x&#125;,y:function(e)&#123;return e.endPos.y&#125;,radius:0.1,duration:anime.random(1200,1800),easing:&quot;easeOutExpo&quot;,update:renderParticule&#125;).add(&#123;targets:a,radius:anime.random(80,160),lineWidth:0,alpha:&#123;value:0,easing:&quot;linear&quot;,duration:anime.random(600,800)&#125;,duration:anime.random(1200,1800),easing:&quot;easeOutExpo&quot;,update:renderParticule,offset:0&#125;)&#125;function debounce(e,t)&#123;var a;return function()&#123;var n&#x3D;this,i&#x3D;arguments;clearTimeout(a),a&#x3D;setTimeout(function()&#123;e.apply(n,i)&#125;,t)&#125;&#125;var canvasEl&#x3D;document.querySelector(&quot;.fireworks&quot;);if(canvasEl)&#123;var ctx&#x3D;canvasEl.getContext(&quot;2d&quot;),numberOfParticules&#x3D;30,pointerX&#x3D;0,pointerY&#x3D;0,tap&#x3D;&quot;mousedown&quot;,colors&#x3D;[&quot;#FF1461&quot;,&quot;#18FF92&quot;,&quot;#5A87FF&quot;,&quot;#FBF38C&quot;],setCanvasSize&#x3D;debounce(function()&#123;canvasEl.width&#x3D;2*window.innerWidth,canvasEl.height&#x3D;2*window.innerHeight,canvasEl.style.width&#x3D;window.innerWidth+&quot;px&quot;,canvasEl.style.height&#x3D;window.innerHeight+&quot;px&quot;,canvasEl.getContext(&quot;2d&quot;).scale(2,2)&#125;,500),render&#x3D;anime(&#123;duration:1&#x2F;0,update:function()&#123;ctx.clearRect(0,0,canvasEl.width,canvasEl.height)&#125;&#125;);document.addEventListener(tap,function(e)&#123;&quot;sidebar&quot;!&#x3D;&#x3D;e.target.id&amp;&amp;&quot;toggle-sidebar&quot;!&#x3D;&#x3D;e.target.id&amp;&amp;&quot;A&quot;!&#x3D;&#x3D;e.target.nodeName&amp;&amp;&quot;IMG&quot;!&#x3D;&#x3D;e.target.nodeName&amp;&amp;(render.play(),updateCoords(e),animateParticules(pointerX,pointerY))&#125;,!1),setCanvasSize(),window.addEventListener(&quot;resize&quot;,setCanvasSize,!1)&#125;;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€themes/next/layout/_layout.swig,åœ¨<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script>ä¸Šé¢å†™ä¸‹å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% if theme.fireworks %&#125;</span><br><span class="line">   &lt;canvas class&#x3D;&quot;fireworks&quot; style&#x3D;&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot; &gt;&lt;&#x2F;canvas&gt; </span><br><span class="line">   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;&#x2F;cdn.bootcss.com&#x2F;animejs&#x2F;2.2.0&#x2F;anime.min.js&quot;&gt;&lt;&#x2F;script&gt; </span><br><span class="line">   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;src&#x2F;fireworks.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.ymlï¼Œåœ¨é‡Œé¢æœ€åå†™ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Fireworks</span><br><span class="line">fireworks: true</span><br></pre></td></tr></table></figure>
<ul>
<li><p>12.åŠ¨æ€èƒŒæ™¯<br><img src="/2020/07/08/hexo%E5%BC%80%E5%8F%91%E5%8D%9A%E5%AE%A2/bg.gif" alt><br>ä¸Šé¢è¿™ç§åªæ˜¯å…¶ä¸­ä¸€ç§åŠ¨æ€èƒŒæ™¯ï¼Œæ–°ç‰ˆçš„Nextä¸»é¢˜é›†æˆäº†è¯¥åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨ä¸»é¢˜é…ç½®themes\next_config.ymlä¸­è®¾ç½®å¦‚ä¸‹å³å¯ï¼Œä¸‹é¢æ¯ä¸ªæ¨¡å—åªè®¾ç½®å…¶ä¸­ä¸€ä¸ªä¸ºtrueï¼Œå…·ä½“æ•ˆæœå¦‚ä½•å¯è‡ªå·±å°è¯•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Canvas-nest</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-canvas-nest</span><br><span class="line">canvas_nest: # ç½‘ç»œèƒŒæ™¯</span><br><span class="line">  enable: true</span><br><span class="line">  onmobile: true # display on mobile or not</span><br><span class="line">  color: &#39;0,0,0&#39; # RGB values, use &#39;,&#39; to separate</span><br><span class="line">  opacity: 0.5 # the opacity of line: 0~1</span><br><span class="line">  zIndex: -1 # z-index property of the background</span><br><span class="line">  count: 150 # the number of lines</span><br><span class="line"></span><br><span class="line"># JavaScript 3D library.</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-three</span><br><span class="line"># three_waves</span><br><span class="line">three_waves: false</span><br><span class="line"># canvas_lines</span><br><span class="line">canvas_lines: false</span><br><span class="line"># canvas_sphere</span><br><span class="line">canvas_sphere: false</span><br><span class="line"></span><br><span class="line"># Canvas-ribbon</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-canvas-ribbon</span><br><span class="line"># size: The width of the ribbon.</span><br><span class="line"># alpha: The transparency of the ribbon.</span><br><span class="line"># zIndex: The display level of the ribbon.</span><br><span class="line">canvas_ribbon:</span><br><span class="line">  enable: false</span><br><span class="line">  size: 300</span><br><span class="line">  alpha: 0.6</span><br><span class="line">  zIndex: -1</span><br></pre></td></tr></table></figure>
<p>å¦å¤–éœ€è¦åœ¨blogä¸­ä¸‹è½½ç›¸åº”èµ„æºåŒ…ï¼Œå…·ä½“è§ä¸Šé¢çš„é“¾æ¥ï¼Œä¸‹é¢æˆ‘ç»™å‡ºcanvas_nestçš„ä¸‹è½½æ–¹å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-canvas-nest themes&#x2F;next&#x2F;source&#x2F;lib&#x2F;canvas-nest</span><br></pre></td></tr></table></figure></li>
<li><p>13.æ–‡ç« ç»“æŸæ ‡å¿—<br>åœ¨è·¯å¾„ \themes\next\layout_macro ä¸­æ–°å»º passage-end-tag.swig æ–‡ä»¶,å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        &lt;div style&#x3D;&quot;text-align:center;color: #ccc;font-size:14px;&quot;&gt;-------------æœ¬æ–‡ç»“æŸ&lt;i class&#x3D;&quot;fa fa-paw&quot;&gt;&lt;&#x2F;i&gt;æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------&lt;&#x2F;div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æ‰“å¼€\themes\next\layout_macro\post.swigæ–‡ä»¶ï¼Œåœ¨post-body ä¹‹å(END POST BODY)ï¼Œ post-footer ä¹‹å‰æ·»åŠ å¦‚ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &#123;% if not is_index %&#125;</span><br><span class="line">    &#123;% include &#39;passage-end-tag.swig&#39; %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼ˆ_config.yml),åœ¨æœ«å°¾æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ–‡ç« æœ«å°¾æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°</span><br><span class="line">passage_end_tag:</span><br><span class="line">  enabled: true</span><br></pre></td></tr></table></figure>
</li>
<li><p>14.æ–‡å­—é˜´å½±æ•ˆæœ<br>æ‰“å¼€\themes\next\source\css_custom\custom.styl,å‘é‡Œé¢åŠ å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ</span><br><span class="line"> .post &#123;</span><br><span class="line">   margin-top: 60px;</span><br><span class="line">   margin-bottom: 60px;</span><br><span class="line">   padding: 25px;</span><br><span class="line">   -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);</span><br><span class="line">   -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>15.åšå®¢åº•éƒ¨å¸ƒå±€<br>å¯¹åº”ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.ymlä¸­çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">footer:</span><br><span class="line">  # Specify the date when the site was setup.</span><br><span class="line">  # If not defined, current year will be used.</span><br><span class="line">  since: 2020 #å»ºç«™æ—¶é—´</span><br><span class="line"></span><br><span class="line">  # Icon between year and copyright info.</span><br><span class="line">  icon:</span><br><span class="line">    # Icon name in fontawesome, see: https:&#x2F;&#x2F;fontawesome.com&#x2F;v4.7.0&#x2F;icons&#x2F;</span><br><span class="line">    # &#96;heart&#96; is recommended with animation in red (#ff0000).</span><br><span class="line">    name: heart  #ä½œè€…å›¾æ ‡ï¼ˆé»˜è®¤æ˜¯authoräººåƒ)</span><br><span class="line">    # If you want to animate the icon, set it to true.</span><br><span class="line">    animated: true #å›¾æ ‡æ˜¯å¦é—ªåŠ¨</span><br><span class="line">    # Change the color of icon, using Hex Code.</span><br><span class="line">    color: &quot;#808080&quot; #å›¾æ ‡é¢œè‰²</span><br><span class="line"></span><br><span class="line">  # If not defined, &#96;author&#96; from Hexo main config will be used.</span><br><span class="line">  copyright: å¼ å¸… #åˆ«å¡«boolå‹ï¼Œæœ€åæ˜¾ç¤ºçš„ä¸œè¥¿æ˜¯copyright || authorï¼Œå³å·¦è¾¹æ²¡æœ‰è®¾ç½®çš„è¯å°±æ˜¾ç¤ºä½œè€…</span><br><span class="line">  # -------------------------------------------------------------</span><br><span class="line">  powered:</span><br><span class="line">    # Hexo link (Powered by Hexo).</span><br><span class="line">    enable: false #æ˜¯å¦æ˜¾ç¤º Powered by hexo</span><br><span class="line">    # Version info of Hexo after Hexo link (vX.X.X).</span><br><span class="line">    version: false #æ˜¯å¦æ˜¾ç¤ºHexoç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">  theme:</span><br><span class="line">    # Theme &amp; scheme info link (Theme - NexT.scheme).</span><br><span class="line">    enable: false #æ˜¯å¦æ˜¾ç¤ºä¸»é¢˜ä¿¡æ¯</span><br><span class="line">    # Version info of NexT after scheme info (vX.X.X).</span><br><span class="line">    version: false #æ˜¯å¦æ˜¾ç¤ºä¸»é¢˜ç‰ˆæœ¬</span><br><span class="line">  # -------------------------------------------------------------</span><br><span class="line">  # Beian icp information for Chinese users. In China, every legal website should have a beian icp in website footer.</span><br><span class="line">  # http:&#x2F;&#x2F;www.miitbeian.gov.cn</span><br><span class="line">  beian:</span><br><span class="line">    enable: false #æ˜¯å¦æ˜¾ç¤ºç½‘ç«™å¤‡æ¡ˆä¿¡æ¯</span><br><span class="line">    icp:</span><br><span class="line"></span><br><span class="line">  # -------------------------------------------------------------</span><br><span class="line">  # Any custom text can be defined here.</span><br><span class="line">  #custom_text: Hosted by &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;pages.coding.me&quot; class&#x3D;&quot;theme-link&quot; rel&#x3D;&quot;noopener&quot; target&#x3D;&quot;_blank&quot;&gt;Coding Pages&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>16.æ·»åŠ é¡µé¢å® ç‰©<br>é¦–å…ˆåœ¨åšå®¢ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -save hexo-helper-live2d</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">live2d:</span><br><span class="line">  enable: true</span><br><span class="line">  scriptFrom: local</span><br><span class="line">  pluginRootPath: live2dw&#x2F;</span><br><span class="line">  pluginJsPath: lib&#x2F;</span><br><span class="line">  pluginModelPath: assets&#x2F;</span><br><span class="line">  tagMode: false</span><br><span class="line">  model:</span><br><span class="line">    use: live2d-widget-model-wanko  #é€‰æ‹©å“ªç§æ¨¡å‹</span><br><span class="line">  display: #æ”¾ç½®ä½ç½®å’Œå¤§å°</span><br><span class="line">    position: right</span><br><span class="line">    width: 150</span><br><span class="line">    height: 300</span><br><span class="line">  mobile:</span><br><span class="line">    show: false #æ˜¯å¦åœ¨æ‰‹æœºç«¯æ˜¾ç¤º</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æ¨¡å‹çš„é€‰æ‹©å¯åœ¨lived2dä¸­é€‰æ‹©ï¼Œå¹¶ä¸‹è½½ç›¸åº”çš„æ¨¡å‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install live2d-widget-model-wanko</span><br></pre></td></tr></table></figure>
</li>
<li><p>17.è®¾ç½®åšå®¢æ‘˜è¦æ˜¾ç¤º<br>å¯¹äºæ‘˜è¦æ˜¾ç¤ºï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å¼€å¯æ‘˜è¦åŠŸèƒ½ï¼Œä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶themes\next_config.ymlï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Automatically scroll page to section which is under &lt;!-- more --&gt; mark.</span><br><span class="line">scroll_to_more: true #é€‰å–åšå®¢æ­£æ–‡&lt;!--more--&gt;å‰çš„å†…å®¹</span><br><span class="line"></span><br><span class="line"># Automatically saving scroll position on each post&#x2F;page in cookies.</span><br><span class="line">save_scroll: false</span><br><span class="line"></span><br><span class="line"># Automatically excerpt description in homepage as preamble text.</span><br><span class="line">excerpt_description: true #è‡ªåŠ¨æˆªå–æ‘˜è¦</span><br><span class="line"></span><br><span class="line"># Automatically Excerpt. Not recommend.</span><br><span class="line"># Use &lt;!-- more --&gt; in the post to control excerpt accurately.</span><br><span class="line">auto_excerpt: </span><br><span class="line">  enable: false #è‡ªåŠ¨æˆªå–ä¸€å®šç¨‹åº¦çš„æ‘˜è¦</span><br><span class="line">  length: 150</span><br><span class="line"></span><br><span class="line"># Read more button</span><br><span class="line"># If true, the read more button would be displayed in excerpt section.</span><br><span class="line">read_more_btn: true #æ˜¾ç¤ºé˜…è¯»å…¨æ–‡æŒ‰é’®</span><br></pre></td></tr></table></figure>
</li>
<li><p>18.è®¾ç½®RSSè®¢é˜…<br>åœ¨åšå®¢ä¸»ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-generator-feed</span><br></pre></td></tr></table></figure>
<p>åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: http:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">plugins: hexo-generate-feed</span><br></pre></td></tr></table></figure>
<p>ç„¶åè®¾ç½®ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Set rss to false to disable feed link.</span><br><span class="line"># Leave rss as empty to use site&#39;s feed link.</span><br><span class="line"># Set rss to specific value if you have burned your feed already.</span><br><span class="line">rss: &#x2F;atom.xml</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.ä¿®æ”¹æ–‡ç« é“¾æ¥æ ·å¼<br>ä¿®æ”¹æ–‡ä»¶ themes\next\source\css_common\components\post\post.stylï¼Œåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹cssæ ·å¼ï¼Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; æ–‡ç« å†…é“¾æ¥æ–‡æœ¬æ ·å¼</span><br><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #0593d3;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-bottom: 1px solid #0593d3;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #fc6423;</span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-bottom: 1px solid #fc6423;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>MarkdownåŸºç¡€è¯­æ³•</title>
    <url>/2020/07/08/Markdown%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
    <content><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><ul>
<li>1.<a href="#header1">æ ‡é¢˜</a></li>
<li>2.<a href="#header2">å­—ä½“</a></li>
<li>3.<a href="#header3">å›¾ç‰‡</a></li>
<li>4.<a href="#header4">è¶…é“¾æ¥</a></li>
<li>5.<a href="#header5">é”šç‚¹</a></li>
<li>6.<a href="#header6">å¼•ç”¨</a></li>
<li>7.<a href="#header7">ä»£ç </a></li>
<li>8.<a href="#header8">åˆ—è¡¨</a></li>
<li>9.<a href="#header9">åˆ†å‰²çº¿</a></li>
<li>10.<a href="#header10">è¡¨æ ¼</a></li>
<li>11.<a href="#header11">æ¢è¡Œ</a></li>
<li>12.<a href="#header12">æµç¨‹å›¾</a></li>
</ul>
<a id="more"></a>

<h1 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a><span id="header1">æ ‡é¢˜</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ ‡é¢˜1</span><br><span class="line">## æ ‡é¢˜2</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<h1 id="æ ‡é¢˜1"><a href="#æ ‡é¢˜1" class="headerlink" title="æ ‡é¢˜1"></a>æ ‡é¢˜1</h1><h2 id="æ ‡é¢˜2"><a href="#æ ‡é¢˜2" class="headerlink" title="æ ‡é¢˜2"></a>æ ‡é¢˜2</h2><h1 id="å­—ä½“"><a href="#å­—ä½“" class="headerlink" title="å­—ä½“"></a><span id="header2">å­—ä½“</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">**è¿™æ˜¯åŠ ç²—çš„æ–‡å­—**</span><br><span class="line">*è¿™æ˜¯å€¾æ–œçš„æ–‡å­—*&#96;</span><br><span class="line">***è¿™æ˜¯æ–œä½“åŠ ç²—çš„æ–‡å­—***</span><br><span class="line">~~è¿™æ˜¯åŠ åˆ é™¤çº¿çš„æ–‡å­—~~</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<p><strong>è¿™æ˜¯åŠ ç²—çš„æ–‡å­—</strong><br><em>è¿™æ˜¯å€¾æ–œçš„æ–‡å­—</em>`<br><strong><em>è¿™æ˜¯æ–œä½“åŠ ç²—çš„æ–‡å­—</em></strong><br><del>è¿™æ˜¯åŠ åˆ é™¤çº¿çš„æ–‡å­—</del></p>
<h1 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a><span id="header3">å›¾ç‰‡</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">![æˆ‘æ˜¯ALT](https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;dong_54209c0ff3da32eecc31f340c08a18f6.gif)</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<p><img src="https://www.baidu.com/img/dong_54209c0ff3da32eecc31f340c08a18f6.gif" alt="æˆ‘æ˜¯ALT"></p>
<h1 id="è¶…é“¾æ¥"><a href="#è¶…é“¾æ¥" class="headerlink" title="è¶…é“¾æ¥"></a><span id="header4">è¶…é“¾æ¥</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[æˆ‘æ˜¯ç™¾åº¦](www.baidu.com)</span><br><span class="line">[![æˆ‘æ˜¯ALT](https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;dong_54209c0ff3da32eecc31f340c08a18f6.gif)](![æˆ‘æ˜¯ALT](https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;dong_54209c0ff3da32eecc31f340c08a18f6.gif))</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<p><a href="http://www.baidu.com" target="_blank" rel="noopener">ç‚¹æˆ‘æˆ–è€…å›¾ç‰‡å‡å¯è·³è½¬åˆ°ç™¾åº¦</a><br><a href="http://www.baidu.com" target="_blank" rel="noopener"><img src="https://www.baidu.com/img/dong_54209c0ff3da32eecc31f340c08a18f6.gif" alt="æˆ‘æ˜¯ALT"></a></p>
<h1 id="é”šç‚¹"><a href="#é”šç‚¹" class="headerlink" title="é”šç‚¹"></a><span id="header5">é”šç‚¹</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ç‚¹æˆ‘è·³è½¬](#mao)</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;span id&#x3D;&quot;ma0&quot;&gt;è·³åˆ°äº†æˆ‘&lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<p><a href="#mao">ç‚¹æˆ‘è·³è½¬</a><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span id="mao">è·³åˆ°äº†æˆ‘</span></p>
<h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a><span id="header6">å¼•ç”¨</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;æˆ‘æ˜¯å¼•ç”¨1</span><br><span class="line">&gt;&gt;æˆ‘æ˜¯å¼•ç”¨2</span><br><span class="line">&gt;&gt;&gt;æˆ‘æ˜¯å¼•ç”¨3</span><br><span class="line">&gt;&gt;&gt;&gt;æˆ‘æ˜¯å¼•ç”¨4</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<blockquote>
<p>æˆ‘æ˜¯å¼•ç”¨1</p>
<blockquote>
<p>æˆ‘æ˜¯å¼•ç”¨2</p>
<blockquote>
<p>æˆ‘æ˜¯å¼•ç”¨3</p>
<blockquote>
<p>æˆ‘æ˜¯å¼•ç”¨4</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a><span id="header7">ä»£ç </span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#96;&#96;&#96;</span><br><span class="line">console.log(1)</span><br><span class="line">&#96;&#96;&#96;</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">console.log(1)</span><br></pre></td></tr></table></figure>

<h1 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a><span id="header8">åˆ—è¡¨</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* æ— åºåˆ—è¡¨1</span><br><span class="line">    * æ— åºåˆ—è¡¨1-1</span><br><span class="line">    * æ— åºåˆ—è¡¨1-2</span><br><span class="line">    * æ— åºåˆ—è¡¨1-3</span><br><span class="line">* æ— åºåˆ—è¡¨2</span><br><span class="line">* æ— åºåˆ—è¡¨3</span><br><span class="line">* æ— åºåˆ—è¡¨4</span><br><span class="line">* æ— åºåˆ—è¡¨5</span><br><span class="line">+ æ— åºåˆ—è¡¨6</span><br><span class="line">    + æ— åºåˆ—è¡¨6-1</span><br><span class="line">        + æ— åºåˆ—è¡¨6-1-1</span><br><span class="line">            + æ— åºåˆ—è¡¨6-1-1-1</span><br><span class="line">                + æ— åºåˆ—è¡¨6-1-1-1-1</span><br><span class="line">+ æ— åºåˆ—è¡¨7</span><br><span class="line">- æ— åºåˆ—è¡¨8</span><br><span class="line">- æ— åºåˆ—è¡¨9</span><br><span class="line">    * æ— åºåˆ—è¡¨9-1</span><br><span class="line">    * æ— åºåˆ—è¡¨9-2</span><br><span class="line">    * æ— åºåˆ—è¡¨9-3</span><br><span class="line">    * æ— åºåˆ—è¡¨9-4</span><br><span class="line">- æ— åºåˆ—è¡¨10</span><br><span class="line">- 1.æœ‰åºåˆ—è¡¨</span><br><span class="line">    - 1.1æœ‰åºåˆ—è¡¨</span><br><span class="line">    - 1.2æœ‰åºåˆ—è¡¨</span><br><span class="line">    - 1.3æœ‰åºåˆ—è¡¨</span><br><span class="line">- 2.æœ‰åºåˆ—è¡¨</span><br><span class="line">- 3.æœ‰åºåˆ—è¡¨</span><br><span class="line">- 4.æœ‰åºåˆ—è¡¨</span><br><span class="line">- 5.æœ‰åºåˆ—è¡¨</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<ul>
<li>æ— åºåˆ—è¡¨1<ul>
<li>æ— åºåˆ—è¡¨1-1</li>
<li>æ— åºåˆ—è¡¨1-2</li>
<li>æ— åºåˆ—è¡¨1-3</li>
</ul>
</li>
<li>æ— åºåˆ—è¡¨2</li>
<li>æ— åºåˆ—è¡¨3</li>
<li>æ— åºåˆ—è¡¨4</li>
<li>æ— åºåˆ—è¡¨5</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨6<ul>
<li>æ— åºåˆ—è¡¨6-1<ul>
<li>æ— åºåˆ—è¡¨6-1-1<ul>
<li>æ— åºåˆ—è¡¨6-1-1-1<ul>
<li>æ— åºåˆ—è¡¨6-1-1-1-1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>æ— åºåˆ—è¡¨7</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨8</li>
<li>æ— åºåˆ—è¡¨9<ul>
<li>æ— åºåˆ—è¡¨9-1</li>
<li>æ— åºåˆ—è¡¨9-2</li>
<li>æ— åºåˆ—è¡¨9-3</li>
<li>æ— åºåˆ—è¡¨9-4</li>
</ul>
</li>
<li>æ— åºåˆ—è¡¨10</li>
<li>1.æœ‰åºåˆ—è¡¨<ul>
<li>1.1æœ‰åºåˆ—è¡¨</li>
<li>1.2æœ‰åºåˆ—è¡¨</li>
<li>1.3æœ‰åºåˆ—è¡¨</li>
</ul>
</li>
<li>2.æœ‰åºåˆ—è¡¨</li>
<li>3.æœ‰åºåˆ—è¡¨</li>
<li>4.æœ‰åºåˆ—è¡¨</li>
<li>5.æœ‰åºåˆ—è¡¨</li>
</ul>
<h1 id="åˆ†å‰²çº¿"><a href="#åˆ†å‰²çº¿" class="headerlink" title="åˆ†å‰²çº¿"></a><span id="header9">åˆ†å‰²çº¿</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">****</span><br><span class="line">*****</span><br><span class="line">******</span><br><span class="line">----</span><br><span class="line">-----</span><br><span class="line">------</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<hr>
<hr>
<hr>
<hr>
<hr>
<hr>
<h1 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a><span id="header10">è¡¨æ ¼</span></h1><ul>
<li>ç¬¬äºŒè¡Œåˆ†å‰²è¡¨å¤´å’Œå†…å®¹ã€‚</li>
<li>- æœ‰ä¸€ä¸ªå°±è¡Œï¼Œä¸ºäº†å¯¹é½ï¼Œå¤šåŠ äº†å‡ ä¸ª</li>
<li>æ–‡å­—é»˜è®¤å±…å·¦</li>
<li>-ä¸¤è¾¹åŠ ï¼šè¡¨ç¤ºæ–‡å­—å±…ä¸­</li>
<li>-å³è¾¹åŠ ï¼šè¡¨ç¤ºæ–‡å­—å±…å³</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å§“å|æ€§åˆ«|å¹´é¾„|æˆ˜æ–—åŠ›</span><br><span class="line">:-:|:-|-:|-</span><br><span class="line">å¼ é£123|ç”·boy|100|2001</span><br><span class="line">åˆ˜å¤‡45|ç”·girl|10|101</span><br><span class="line">å…³ç¾½67890|ç”·å•Šå•Šå•Š|1000|5001</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<table>
<thead>
<tr>
<th align="center">å§“å</th>
<th align="left">æ€§åˆ«</th>
<th align="right">å¹´é¾„</th>
<th>æˆ˜æ–—åŠ›</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å¼ é£123</td>
<td align="left">ç”·boy</td>
<td align="right">100</td>
<td>2001</td>
</tr>
<tr>
<td align="center">åˆ˜å¤‡45</td>
<td align="left">ç”·girl</td>
<td align="right">10</td>
<td>101</td>
</tr>
<tr>
<td align="center">å…³ç¾½67890</td>
<td align="left">ç”·å•Šå•Šå•Š</td>
<td align="right">1000</td>
<td>5001</td>
</tr>
</tbody></table>
<h1 id="æ¢è¡Œ"><a href="#æ¢è¡Œ" class="headerlink" title="æ¢è¡Œ"></a><span id="header11">æ¢è¡Œ</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">abcd</span><br><span class="line">efg</span><br><span class="line">&lt;br&gt;</span><br><span class="line">abcd</span><br><span class="line"></span><br><span class="line">efg</span><br><span class="line">&lt;br&gt;</span><br><span class="line">abcd&lt;br&gt;</span><br><span class="line">efg</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœ</p>
<p>abcd<br>efg<br><br><br>abcd</p>
<p>efg<br><br><br>abcd<br><br>efg</p>
<h1 id="æµç¨‹å›¾-éƒ¨åˆ†ç½‘ç«™å¦‚githubä¸æ”¯æŒ-VS-codeçš„MDé¢„è§ˆæ’ä»¶ä¸æ”¯æŒ"><a href="#æµç¨‹å›¾-éƒ¨åˆ†ç½‘ç«™å¦‚githubä¸æ”¯æŒ-VS-codeçš„MDé¢„è§ˆæ’ä»¶ä¸æ”¯æŒ" class="headerlink" title="æµç¨‹å›¾(éƒ¨åˆ†ç½‘ç«™å¦‚githubä¸æ”¯æŒ,VS codeçš„MDé¢„è§ˆæ’ä»¶ä¸æ”¯æŒ)"></a><span id="header12">æµç¨‹å›¾(éƒ¨åˆ†ç½‘ç«™å¦‚githubä¸æ”¯æŒ,VS codeçš„MDé¢„è§ˆæ’ä»¶ä¸æ”¯æŒ)</span></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flow</span><br><span class="line">st&#x3D;&gt;start: Start</span><br><span class="line">op&#x3D;&gt;operation: Your Operation</span><br><span class="line">cond&#x3D;&gt;condition: Yes or No?</span><br><span class="line">e&#x3D;&gt;end</span><br><span class="line">st-&gt;op-&gt;cond</span><br><span class="line">cond(yes)-&gt;e</span><br><span class="line">cond(no)-&gt;op</span><br></pre></td></tr></table></figure>


<p>flow<br>st=&gt;start: Start<br>op=&gt;operation: Your Operation<br>cond=&gt;condition: Yes or No?<br>e=&gt;end<br>st-&gt;op-&gt;cond<br>cond(yes)-&gt;e<br>cond(no)-&gt;op</p>
]]></content>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>opencvä¸­çš„å›¾åƒå¤„ç†1</title>
    <url>/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/</url>
    <content><![CDATA[<ul>
<li>1.<a href="#header1">æ”¹å˜é¢œè‰²ç©ºé—´</a></li>
<li>2.<a href="#header2">å›¾åƒå‡ ä½•å˜æ¢</a></li>
<li>3.<a href="#header3">å›¾åƒé˜ˆå€¼</a></li>
<li>4.<a href="#header4">å›¾åƒå¹³æ»‘</a><a id="more"></a>

</li>
</ul>
<h1 id="æ”¹å˜é¢œè‰²ç©ºé—´"><a href="#æ”¹å˜é¢œè‰²ç©ºé—´" class="headerlink" title="æ”¹å˜é¢œè‰²ç©ºé—´"></a><span id="header1">æ”¹å˜é¢œè‰²ç©ºé—´</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•å°†å›¾åƒä»ä¸€ä¸ªè‰²å½©ç©ºé—´è½¬æ¢åˆ°å¦ä¸€ä¸ªï¼ŒåƒBGRâ†”ç°è‰²ï¼ŒBGRâ†”HSVç­‰</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å°†åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä»¥æå–è§†é¢‘ä¸­çš„å½©è‰²å¯¹è±¡</li>
<li>ä½ å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.cvtColorï¼Œ<strong>cv.inRange</strong>ç­‰ã€‚</li>
</ul>
<h2 id="æ”¹å˜é¢œè‰²ç©ºé—´-1"><a href="#æ”¹å˜é¢œè‰²ç©ºé—´-1" class="headerlink" title="æ”¹å˜é¢œè‰²ç©ºé—´"></a>æ”¹å˜é¢œè‰²ç©ºé—´</h2><p>OpenCVä¸­æœ‰è¶…è¿‡150ç§é¢œè‰²ç©ºé—´è½¬æ¢æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬å°†ç ”ç©¶åªæœ‰ä¸¤ä¸ªæœ€å¹¿æ³›ä½¿ç”¨çš„,BGRâ†”ç°è‰²å’ŒBGRâ†”HSVã€‚</p>
<p>å¯¹äºé¢œè‰²è½¬æ¢ï¼Œæˆ‘ä»¬ä½¿ç”¨cvå‡½æ•°ã€‚cvtColor(input_image, flag)ï¼Œå…¶ä¸­flagå†³å®šè½¬æ¢çš„ç±»å‹ã€‚</p>
<p>å¯¹äºBGRâ†’ç°åº¦è½¬æ¢ï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‡å¿—cv.COLOR_BGR2GRAYã€‚ç±»ä¼¼åœ°ï¼Œå¯¹äºBGRâ†’HSVï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‡å¿—cv.COLOR_BGR2HSVã€‚</p>
<p>è¦è·å–å…¶ä»–æ ‡è®°ï¼Œåªéœ€åœ¨Pythonç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤</p>
<p>æ³¨æ„ HSVçš„è‰²ç›¸èŒƒå›´ä¸º[0,179]ï¼Œé¥±å’Œåº¦èŒƒå›´ä¸º[0,255]ï¼Œå€¼èŒƒå›´ä¸º[0,255]ã€‚ä¸åŒçš„è½¯ä»¶ä½¿ç”¨ä¸åŒçš„è§„æ¨¡ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœä½ è¦å°†OpenCVå€¼å’Œå®ƒä»¬æ¯”è¾ƒï¼Œä½ éœ€è¦å°†è¿™äº›èŒƒå›´æ ‡å‡†åŒ–ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">flags = [i <span class="keyword">for</span> i <span class="keyword">in</span> dir(cv) <span class="keyword">if</span> i.startswith(<span class="string">'COLOR_'</span>)]</span><br><span class="line">flags</span><br></pre></td></tr></table></figure>




<pre><code>[&apos;COLOR_BAYER_BG2BGR&apos;,
 &apos;COLOR_BAYER_BG2BGRA&apos;,
 &apos;COLOR_BAYER_BG2BGR_EA&apos;,
 &apos;COLOR_BAYER_BG2BGR_VNG&apos;,
 &apos;COLOR_BAYER_BG2GRAY&apos;,
 &apos;COLOR_BAYER_BG2RGB&apos;,
 &apos;COLOR_BAYER_BG2RGBA&apos;,
 &apos;COLOR_BAYER_BG2RGB_EA&apos;,
 &apos;COLOR_BAYER_BG2RGB_VNG&apos;,
 &apos;COLOR_BAYER_GB2BGR&apos;,
 &apos;COLOR_BAYER_GB2BGRA&apos;,
 &apos;COLOR_BAYER_GB2BGR_EA&apos;,
 &apos;COLOR_BAYER_GB2BGR_VNG&apos;,
 &apos;COLOR_BAYER_GB2GRAY&apos;,
 &apos;COLOR_BAYER_GB2RGB&apos;,
 &apos;COLOR_BAYER_GB2RGBA&apos;,
 &apos;COLOR_BAYER_GB2RGB_EA&apos;,
 &apos;COLOR_BAYER_GB2RGB_VNG&apos;,
 &apos;COLOR_BAYER_GR2BGR&apos;,
 &apos;COLOR_BAYER_GR2BGRA&apos;,
 &apos;COLOR_BAYER_GR2BGR_EA&apos;,
 &apos;COLOR_BAYER_GR2BGR_VNG&apos;,
 &apos;COLOR_BAYER_GR2GRAY&apos;,
 &apos;COLOR_BAYER_GR2RGB&apos;,
 &apos;COLOR_BAYER_GR2RGBA&apos;,
 &apos;COLOR_BAYER_GR2RGB_EA&apos;,
 &apos;COLOR_BAYER_GR2RGB_VNG&apos;,
 &apos;COLOR_BAYER_RG2BGR&apos;,
 &apos;COLOR_BAYER_RG2BGRA&apos;,
 &apos;COLOR_BAYER_RG2BGR_EA&apos;,
 &apos;COLOR_BAYER_RG2BGR_VNG&apos;,
 &apos;COLOR_BAYER_RG2GRAY&apos;,
 &apos;COLOR_BAYER_RG2RGB&apos;,
 &apos;COLOR_BAYER_RG2RGBA&apos;,
 &apos;COLOR_BAYER_RG2RGB_EA&apos;,
 &apos;COLOR_BAYER_RG2RGB_VNG&apos;,
 &apos;COLOR_BGR2BGR555&apos;,
 &apos;COLOR_BGR2BGR565&apos;,
 &apos;COLOR_BGR2BGRA&apos;,
 &apos;COLOR_BGR2GRAY&apos;,
 &apos;COLOR_BGR2HLS&apos;,
 &apos;COLOR_BGR2HLS_FULL&apos;,
 &apos;COLOR_BGR2HSV&apos;,
 &apos;COLOR_BGR2HSV_FULL&apos;,
 &apos;COLOR_BGR2LAB&apos;,
 &apos;COLOR_BGR2LUV&apos;,
 &apos;COLOR_BGR2Lab&apos;,
 &apos;COLOR_BGR2Luv&apos;,
 &apos;COLOR_BGR2RGB&apos;,
 &apos;COLOR_BGR2RGBA&apos;,
 &apos;COLOR_BGR2XYZ&apos;,
 &apos;COLOR_BGR2YCR_CB&apos;,
 &apos;COLOR_BGR2YCrCb&apos;,
 &apos;COLOR_BGR2YUV&apos;,
 &apos;COLOR_BGR2YUV_I420&apos;,
 &apos;COLOR_BGR2YUV_IYUV&apos;,
 &apos;COLOR_BGR2YUV_YV12&apos;,
 &apos;COLOR_BGR5552BGR&apos;,
 &apos;COLOR_BGR5552BGRA&apos;,
 &apos;COLOR_BGR5552GRAY&apos;,
 &apos;COLOR_BGR5552RGB&apos;,
 &apos;COLOR_BGR5552RGBA&apos;,
 &apos;COLOR_BGR5652BGR&apos;,
 &apos;COLOR_BGR5652BGRA&apos;,
 &apos;COLOR_BGR5652GRAY&apos;,
 &apos;COLOR_BGR5652RGB&apos;,
 &apos;COLOR_BGR5652RGBA&apos;,
 &apos;COLOR_BGRA2BGR&apos;,
 &apos;COLOR_BGRA2BGR555&apos;,
 &apos;COLOR_BGRA2BGR565&apos;,
 &apos;COLOR_BGRA2GRAY&apos;,
 &apos;COLOR_BGRA2RGB&apos;,
 &apos;COLOR_BGRA2RGBA&apos;,
 &apos;COLOR_BGRA2YUV_I420&apos;,
 &apos;COLOR_BGRA2YUV_IYUV&apos;,
 &apos;COLOR_BGRA2YUV_YV12&apos;,
 &apos;COLOR_BayerBG2BGR&apos;,
 &apos;COLOR_BayerBG2BGRA&apos;,
 &apos;COLOR_BayerBG2BGR_EA&apos;,
 &apos;COLOR_BayerBG2BGR_VNG&apos;,
 &apos;COLOR_BayerBG2GRAY&apos;,
 &apos;COLOR_BayerBG2RGB&apos;,
 &apos;COLOR_BayerBG2RGBA&apos;,
 &apos;COLOR_BayerBG2RGB_EA&apos;,
 &apos;COLOR_BayerBG2RGB_VNG&apos;,
 &apos;COLOR_BayerGB2BGR&apos;,
 &apos;COLOR_BayerGB2BGRA&apos;,
 &apos;COLOR_BayerGB2BGR_EA&apos;,
 &apos;COLOR_BayerGB2BGR_VNG&apos;,
 &apos;COLOR_BayerGB2GRAY&apos;,
 &apos;COLOR_BayerGB2RGB&apos;,
 &apos;COLOR_BayerGB2RGBA&apos;,
 &apos;COLOR_BayerGB2RGB_EA&apos;,
 &apos;COLOR_BayerGB2RGB_VNG&apos;,
 &apos;COLOR_BayerGR2BGR&apos;,
 &apos;COLOR_BayerGR2BGRA&apos;,
 &apos;COLOR_BayerGR2BGR_EA&apos;,
 &apos;COLOR_BayerGR2BGR_VNG&apos;,
 &apos;COLOR_BayerGR2GRAY&apos;,
 &apos;COLOR_BayerGR2RGB&apos;,
 &apos;COLOR_BayerGR2RGBA&apos;,
 &apos;COLOR_BayerGR2RGB_EA&apos;,
 &apos;COLOR_BayerGR2RGB_VNG&apos;,
 &apos;COLOR_BayerRG2BGR&apos;,
 &apos;COLOR_BayerRG2BGRA&apos;,
 &apos;COLOR_BayerRG2BGR_EA&apos;,
 &apos;COLOR_BayerRG2BGR_VNG&apos;,
 &apos;COLOR_BayerRG2GRAY&apos;,
 &apos;COLOR_BayerRG2RGB&apos;,
 &apos;COLOR_BayerRG2RGBA&apos;,
 &apos;COLOR_BayerRG2RGB_EA&apos;,
 &apos;COLOR_BayerRG2RGB_VNG&apos;,
 &apos;COLOR_COLORCVT_MAX&apos;,
 &apos;COLOR_GRAY2BGR&apos;,
 &apos;COLOR_GRAY2BGR555&apos;,
 &apos;COLOR_GRAY2BGR565&apos;,
 &apos;COLOR_GRAY2BGRA&apos;,
 &apos;COLOR_GRAY2RGB&apos;,
 &apos;COLOR_GRAY2RGBA&apos;,
 &apos;COLOR_HLS2BGR&apos;,
 &apos;COLOR_HLS2BGR_FULL&apos;,
 &apos;COLOR_HLS2RGB&apos;,
 &apos;COLOR_HLS2RGB_FULL&apos;,
 &apos;COLOR_HSV2BGR&apos;,
 &apos;COLOR_HSV2BGR_FULL&apos;,
 &apos;COLOR_HSV2RGB&apos;,
 &apos;COLOR_HSV2RGB_FULL&apos;,
 &apos;COLOR_LAB2BGR&apos;,
 &apos;COLOR_LAB2LBGR&apos;,
 &apos;COLOR_LAB2LRGB&apos;,
 &apos;COLOR_LAB2RGB&apos;,
 &apos;COLOR_LBGR2LAB&apos;,
 &apos;COLOR_LBGR2LUV&apos;,
 &apos;COLOR_LBGR2Lab&apos;,
 &apos;COLOR_LBGR2Luv&apos;,
 &apos;COLOR_LRGB2LAB&apos;,
 &apos;COLOR_LRGB2LUV&apos;,
 &apos;COLOR_LRGB2Lab&apos;,
 &apos;COLOR_LRGB2Luv&apos;,
 &apos;COLOR_LUV2BGR&apos;,
 &apos;COLOR_LUV2LBGR&apos;,
 &apos;COLOR_LUV2LRGB&apos;,
 &apos;COLOR_LUV2RGB&apos;,
 &apos;COLOR_Lab2BGR&apos;,
 &apos;COLOR_Lab2LBGR&apos;,
 &apos;COLOR_Lab2LRGB&apos;,
 &apos;COLOR_Lab2RGB&apos;,
 &apos;COLOR_Luv2BGR&apos;,
 &apos;COLOR_Luv2LBGR&apos;,
 &apos;COLOR_Luv2LRGB&apos;,
 &apos;COLOR_Luv2RGB&apos;,
 &apos;COLOR_M_RGBA2RGBA&apos;,
 &apos;COLOR_RGB2BGR&apos;,
 &apos;COLOR_RGB2BGR555&apos;,
 &apos;COLOR_RGB2BGR565&apos;,
 &apos;COLOR_RGB2BGRA&apos;,
 &apos;COLOR_RGB2GRAY&apos;,
 &apos;COLOR_RGB2HLS&apos;,
 &apos;COLOR_RGB2HLS_FULL&apos;,
 &apos;COLOR_RGB2HSV&apos;,
 &apos;COLOR_RGB2HSV_FULL&apos;,
 &apos;COLOR_RGB2LAB&apos;,
 &apos;COLOR_RGB2LUV&apos;,
 &apos;COLOR_RGB2Lab&apos;,
 &apos;COLOR_RGB2Luv&apos;,
 &apos;COLOR_RGB2RGBA&apos;,
 &apos;COLOR_RGB2XYZ&apos;,
 &apos;COLOR_RGB2YCR_CB&apos;,
 &apos;COLOR_RGB2YCrCb&apos;,
 &apos;COLOR_RGB2YUV&apos;,
 &apos;COLOR_RGB2YUV_I420&apos;,
 &apos;COLOR_RGB2YUV_IYUV&apos;,
 &apos;COLOR_RGB2YUV_YV12&apos;,
 &apos;COLOR_RGBA2BGR&apos;,
 &apos;COLOR_RGBA2BGR555&apos;,
 &apos;COLOR_RGBA2BGR565&apos;,
 &apos;COLOR_RGBA2BGRA&apos;,
 &apos;COLOR_RGBA2GRAY&apos;,
 &apos;COLOR_RGBA2M_RGBA&apos;,
 &apos;COLOR_RGBA2RGB&apos;,
 &apos;COLOR_RGBA2YUV_I420&apos;,
 &apos;COLOR_RGBA2YUV_IYUV&apos;,
 &apos;COLOR_RGBA2YUV_YV12&apos;,
 &apos;COLOR_RGBA2mRGBA&apos;,
 &apos;COLOR_XYZ2BGR&apos;,
 &apos;COLOR_XYZ2RGB&apos;,
 &apos;COLOR_YCR_CB2BGR&apos;,
 &apos;COLOR_YCR_CB2RGB&apos;,
 &apos;COLOR_YCrCb2BGR&apos;,
 &apos;COLOR_YCrCb2RGB&apos;,
 &apos;COLOR_YUV2BGR&apos;,
 &apos;COLOR_YUV2BGRA_I420&apos;,
 &apos;COLOR_YUV2BGRA_IYUV&apos;,
 &apos;COLOR_YUV2BGRA_NV12&apos;,
 &apos;COLOR_YUV2BGRA_NV21&apos;,
 &apos;COLOR_YUV2BGRA_UYNV&apos;,
 &apos;COLOR_YUV2BGRA_UYVY&apos;,
 &apos;COLOR_YUV2BGRA_Y422&apos;,
 &apos;COLOR_YUV2BGRA_YUNV&apos;,
 &apos;COLOR_YUV2BGRA_YUY2&apos;,
 &apos;COLOR_YUV2BGRA_YUYV&apos;,
 &apos;COLOR_YUV2BGRA_YV12&apos;,
 &apos;COLOR_YUV2BGRA_YVYU&apos;,
 &apos;COLOR_YUV2BGR_I420&apos;,
 &apos;COLOR_YUV2BGR_IYUV&apos;,
 &apos;COLOR_YUV2BGR_NV12&apos;,
 &apos;COLOR_YUV2BGR_NV21&apos;,
 &apos;COLOR_YUV2BGR_UYNV&apos;,
 &apos;COLOR_YUV2BGR_UYVY&apos;,
 &apos;COLOR_YUV2BGR_Y422&apos;,
 &apos;COLOR_YUV2BGR_YUNV&apos;,
 &apos;COLOR_YUV2BGR_YUY2&apos;,
 &apos;COLOR_YUV2BGR_YUYV&apos;,
 &apos;COLOR_YUV2BGR_YV12&apos;,
 &apos;COLOR_YUV2BGR_YVYU&apos;,
 &apos;COLOR_YUV2GRAY_420&apos;,
 &apos;COLOR_YUV2GRAY_I420&apos;,
 &apos;COLOR_YUV2GRAY_IYUV&apos;,
 &apos;COLOR_YUV2GRAY_NV12&apos;,
 &apos;COLOR_YUV2GRAY_NV21&apos;,
 &apos;COLOR_YUV2GRAY_UYNV&apos;,
 &apos;COLOR_YUV2GRAY_UYVY&apos;,
 &apos;COLOR_YUV2GRAY_Y422&apos;,
 &apos;COLOR_YUV2GRAY_YUNV&apos;,
 &apos;COLOR_YUV2GRAY_YUY2&apos;,
 &apos;COLOR_YUV2GRAY_YUYV&apos;,
 &apos;COLOR_YUV2GRAY_YV12&apos;,
 &apos;COLOR_YUV2GRAY_YVYU&apos;,
 &apos;COLOR_YUV2RGB&apos;,
 &apos;COLOR_YUV2RGBA_I420&apos;,
 &apos;COLOR_YUV2RGBA_IYUV&apos;,
 &apos;COLOR_YUV2RGBA_NV12&apos;,
 &apos;COLOR_YUV2RGBA_NV21&apos;,
 &apos;COLOR_YUV2RGBA_UYNV&apos;,
 &apos;COLOR_YUV2RGBA_UYVY&apos;,
 &apos;COLOR_YUV2RGBA_Y422&apos;,
 &apos;COLOR_YUV2RGBA_YUNV&apos;,
 &apos;COLOR_YUV2RGBA_YUY2&apos;,
 &apos;COLOR_YUV2RGBA_YUYV&apos;,
 &apos;COLOR_YUV2RGBA_YV12&apos;,
 &apos;COLOR_YUV2RGBA_YVYU&apos;,
 &apos;COLOR_YUV2RGB_I420&apos;,
 &apos;COLOR_YUV2RGB_IYUV&apos;,
 &apos;COLOR_YUV2RGB_NV12&apos;,
 &apos;COLOR_YUV2RGB_NV21&apos;,
 &apos;COLOR_YUV2RGB_UYNV&apos;,
 &apos;COLOR_YUV2RGB_UYVY&apos;,
 &apos;COLOR_YUV2RGB_Y422&apos;,
 &apos;COLOR_YUV2RGB_YUNV&apos;,
 &apos;COLOR_YUV2RGB_YUY2&apos;,
 &apos;COLOR_YUV2RGB_YUYV&apos;,
 &apos;COLOR_YUV2RGB_YV12&apos;,
 &apos;COLOR_YUV2RGB_YVYU&apos;,
 &apos;COLOR_YUV420P2BGR&apos;,
 &apos;COLOR_YUV420P2BGRA&apos;,
 &apos;COLOR_YUV420P2GRAY&apos;,
 &apos;COLOR_YUV420P2RGB&apos;,
 &apos;COLOR_YUV420P2RGBA&apos;,
 &apos;COLOR_YUV420SP2BGR&apos;,
 &apos;COLOR_YUV420SP2BGRA&apos;,
 &apos;COLOR_YUV420SP2GRAY&apos;,
 &apos;COLOR_YUV420SP2RGB&apos;,
 &apos;COLOR_YUV420SP2RGBA&apos;,
 &apos;COLOR_YUV420p2BGR&apos;,
 &apos;COLOR_YUV420p2BGRA&apos;,
 &apos;COLOR_YUV420p2GRAY&apos;,
 &apos;COLOR_YUV420p2RGB&apos;,
 &apos;COLOR_YUV420p2RGBA&apos;,
 &apos;COLOR_YUV420sp2BGR&apos;,
 &apos;COLOR_YUV420sp2BGRA&apos;,
 &apos;COLOR_YUV420sp2GRAY&apos;,
 &apos;COLOR_YUV420sp2RGB&apos;,
 &apos;COLOR_YUV420sp2RGBA&apos;,
 &apos;COLOR_mRGBA2RGBA&apos;]</code></pre><h2 id="å¦‚ä½•æ‰¾åˆ°è¦è¿½è¸ªçš„HSVå€¼ï¼Ÿ"><a href="#å¦‚ä½•æ‰¾åˆ°è¦è¿½è¸ªçš„HSVå€¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ‰¾åˆ°è¦è¿½è¸ªçš„HSVå€¼ï¼Ÿ"></a>å¦‚ä½•æ‰¾åˆ°è¦è¿½è¸ªçš„HSVå€¼ï¼Ÿ</h2><p>è¿™æ˜¯åœ¨stackoverflow.comä¸Šå‘ç°çš„ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚å®ƒéå¸¸ç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å‡½æ•°<strong>cv.cvtColor()</strong>ã€‚</p>
<p>ä½ åªéœ€ä¼ é€’ä½ æƒ³è¦çš„BGRå€¼ï¼Œè€Œä¸æ˜¯ä¼ é€’å›¾åƒã€‚ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾ç»¿è‰²çš„HSVå€¼ï¼Œè¯·åœ¨Pythonç»ˆç«¯ä¸­å°è¯•ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">green = np.uint8([[[<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>]]])</span><br><span class="line">hsv_green = cv.cvtColor(green,cv.COLOR_BGR2HSV)</span><br><span class="line">hsv_green</span><br></pre></td></tr></table></figure>




<pre><code>array([[[ 60, 255, 255]]], dtype=uint8)</code></pre><h1 id="å›¾åƒçš„å‡ ä½•å˜æ¢"><a href="#å›¾åƒçš„å‡ ä½•å˜æ¢" class="headerlink" title="å›¾åƒçš„å‡ ä½•å˜æ¢"></a><span id="header2">å›¾åƒçš„å‡ ä½•å˜æ¢</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>å­¦ä¹ å°†ä¸åŒçš„å‡ ä½•å˜æ¢åº”ç”¨åˆ°å›¾åƒä¸Šï¼Œå¦‚å¹³ç§»ã€æ—‹è½¬ã€ä»¿å°„å˜æ¢ç­‰ã€‚</p>
<p>ä½ ä¼šçœ‹åˆ°è¿™äº›å‡½æ•°: cv.getPerspectiveTransform</p>
<h2 id="å˜æ¢"><a href="#å˜æ¢" class="headerlink" title="å˜æ¢"></a>å˜æ¢</h2><p>OpenCVæä¾›äº†ä¸¤ä¸ªè½¬æ¢å‡½æ•°<strong>cv.warpAffine</strong>å’Œ<strong>cv.warpPerspective</strong>ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒä»¬è¿›è¡Œå„ç§è½¬æ¢ã€‚</p>
<p><strong>cv.warpAffine</strong>é‡‡ç”¨2x3è½¬æ¢çŸ©é˜µï¼Œè€Œ<strong>cv.warpPerspective</strong>é‡‡ç”¨3x3è½¬æ¢çŸ©é˜µä½œä¸ºè¾“å…¥ã€‚</p>
<h2 id="ç¼©æ”¾"><a href="#ç¼©æ”¾" class="headerlink" title="ç¼©æ”¾"></a>ç¼©æ”¾</h2><p>ç¼©æ”¾åªæ˜¯è°ƒæ•´å›¾åƒçš„å¤§å°ã€‚ä¸ºæ­¤ï¼ŒOpenCVå¸¦æœ‰ä¸€ä¸ªå‡½æ•°**cv.resize()ã€‚å›¾åƒçš„å¤§å°å¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç¼©æ”¾æ¯”ä¾‹ã€‚</p>
<p>ä¹Ÿå¯ä½¿ç”¨ä¸åŒçš„æ’å€¼æ–¹æ³•ã€‚é¦–é€‰çš„æ’å€¼æ–¹æ³•æ˜¯<strong>cv.INTER_AREA</strong>ç”¨äºç¼©å°ï¼Œ<strong>cv.INTER_CUBICï¼ˆæ…¢ï¼‰å’Œ</strong>cv.INTER_LINEAR**ç”¨äºç¼©æ”¾ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡ºäºæ‰€æœ‰è°ƒæ•´å¤§å°çš„ç›®çš„ï¼Œä½¿ç”¨çš„æ’å€¼æ–¹æ³•ä¸º<strong>cv.INTER_LINEAR</strong>ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è°ƒæ•´è¾“å…¥å›¾åƒçš„å¤§å°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">res = cv.resize(img,<span class="literal">None</span>,fx=<span class="number">2</span>, fy=<span class="number">2</span>, interpolation = cv.INTER_AREA)</span><br><span class="line">cv.imshow(<span class="string">'res1'</span>,res)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line"><span class="comment">#æˆ–è€…</span></span><br><span class="line">height, width = img.shape[:<span class="number">2</span>]</span><br><span class="line">res = cv.resize(img,(<span class="number">2</span>*width, <span class="number">2</span>*height), interpolation = cv.INTER_CUBIC)</span><br><span class="line">cv.imshow(<span class="string">'res2'</span>,res)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="å¹³ç§»"><a href="#å¹³ç§»" class="headerlink" title="å¹³ç§»"></a>å¹³ç§»</h2><p>å¹³ç§»æ˜¯ç‰©ä½“ä½ç½®çš„ç§»åŠ¨ã€‚å¦‚æœæ‚¨çŸ¥é“åœ¨(x,y)æ–¹å‘ä¸Šçš„ä½ç§»ï¼Œåˆ™å°†å…¶è®¾ä¸º(tx,ty)ï¼Œä½ å¯ä»¥åˆ›å»ºè½¬æ¢çŸ©é˜µMï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>M = $$<br> \left[<br> \begin{matrix}<br>   1 &amp; 0 &amp; tx \<br>   0 &amp; 1 &amp; ty<br>  \end{matrix}<br>  \right] <br>$$<br>æ‚¨å¯ä»¥å°†å…¶æ”¾å…¥<strong>np.float32</strong>ç±»å‹çš„Numpyæ•°ç»„ä¸­ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™<strong>cv.warpAffine</strong>å‡½æ•°ã€‚</p>
<p>å‚è§ä¸‹é¢åç§»ä¸º(100, 50)çš„ç¤ºä¾‹ï¼š</p>
<p><strong>cv.warpAffine</strong>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¾“å‡ºå›¾åƒçš„å¤§å°ï¼Œå…¶å½¢å¼åº”ä¸º(widthï¼Œheight)ã€‚è®°ä½width =åˆ—æ•°ï¼Œheight =è¡Œæ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">rows,cols = img.shape</span><br><span class="line">M = np.float32([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">100</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">50</span>]])</span><br><span class="line">dst = cv.warpAffine(img,M,(cols,rows))</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,dst)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="æ—‹è½¬"><a href="#æ—‹è½¬" class="headerlink" title="æ—‹è½¬"></a>æ—‹è½¬</h2><p>å›¾åƒæ—‹è½¬è§’åº¦ä¸ºÎ¸æ˜¯é€šè¿‡ä»¥ä¸‹å½¢å¼çš„å˜æ¢çŸ©é˜µå®ç°çš„ï¼š</p>
<p>M=$$<br> \left[<br> \begin{matrix}<br>   \cos \theta &amp; \sin \theta  \<br>   \sin \theta &amp; \cos \theta<br>  \end{matrix}<br>  \right] <br>$$<br>ä½†æ˜¯OpenCVæä¾›äº†å¯ç¼©æ”¾çš„æ—‹è½¬ä»¥åŠå¯è°ƒæ•´çš„æ—‹è½¬ä¸­å¿ƒï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨è‡ªå·±å–œæ¬¢çš„ä»»ä½•ä½ç½®æ—‹è½¬ã€‚ä¿®æ”¹åçš„å˜æ¢çŸ©é˜µä¸º</p>
<p>$$<br> \left[<br> \begin{matrix}<br>   \alpha &amp; \beta &amp; (1-\alpha)Â·centerÂ·x-\betaÂ·centerÂ·y \<br>   -\beta &amp; \alpha &amp; \betaÂ·centerÂ·x+(1-\alpha)Â·centerÂ·y<br>  \end{matrix}<br>  \right] <br>$$<br>å…¶ä¸­ï¼š</p>
<p>$$Î±=scaleâ‹…\cos \theta,Î²=scaleâ‹…\sin \theta $$</p>
<p>ä¸ºäº†æ‰¾åˆ°æ­¤è½¬æ¢çŸ©é˜µï¼ŒOpenCVæä¾›äº†ä¸€ä¸ªå‡½æ•°<strong>cv.getRotationMatrix2D</strong>ã€‚</p>
<p>è¯·æ£€æŸ¥ä»¥ä¸‹ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹å°†å›¾åƒç›¸å¯¹äºä¸­å¿ƒæ—‹è½¬90åº¦è€Œæ²¡æœ‰ä»»ä½•ç¼©æ”¾æ¯”ä¾‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">rows,cols = img.shape</span><br><span class="line"><span class="comment"># cols-1 å’Œ rows-1 æ˜¯åæ ‡é™åˆ¶</span></span><br><span class="line">M = cv.getRotationMatrix2D(((cols<span class="number">-1</span>)/<span class="number">2.0</span>,(rows<span class="number">-1</span>)/<span class="number">2.0</span>),<span class="number">90</span>,<span class="number">2</span>)</span><br><span class="line">dst = cv.warpAffine(img,M,(cols,rows))</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,dst)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="ä»¿å°„å˜æ¢"><a href="#ä»¿å°„å˜æ¢" class="headerlink" title="ä»¿å°„å˜æ¢"></a>ä»¿å°„å˜æ¢</h2><p>åœ¨ä»¿å°„å˜æ¢ä¸­ï¼ŒåŸå§‹å›¾åƒä¸­çš„æ‰€æœ‰å¹³è¡Œçº¿åœ¨è¾“å‡ºå›¾åƒä¸­ä»å°†å¹³è¡Œã€‚</p>
<p>ä¸ºäº†æ‰¾åˆ°å˜æ¢çŸ©é˜µï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥å›¾åƒä¸­çš„ä¸‰ä¸ªç‚¹åŠå…¶åœ¨è¾“å‡ºå›¾åƒä¸­çš„å¯¹åº”ä½ç½®ã€‚</p>
<p>ç„¶å<strong>cv.getAffineTransform</strong>å°†åˆ›å»ºä¸€ä¸ª2x3çŸ©é˜µï¼Œè¯¥çŸ©é˜µå°†ä¼ é€’ç»™<strong>cv.warpAffine</strong>ã€‚</p>
<p>æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼Œå¹¶æŸ¥çœ‹æˆ‘é€‰æ‹©çš„ç‚¹ï¼ˆä»¥ç»¿è‰²æ ‡è®°ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'drawing.png'</span>)</span><br><span class="line">rows,cols,ch = img.shape</span><br><span class="line">pts1 = np.float32([[<span class="number">50</span>,<span class="number">50</span>],[<span class="number">200</span>,<span class="number">50</span>],[<span class="number">50</span>,<span class="number">200</span>]])</span><br><span class="line">pts2 = np.float32([[<span class="number">10</span>,<span class="number">100</span>],[<span class="number">200</span>,<span class="number">50</span>],[<span class="number">100</span>,<span class="number">250</span>]])</span><br><span class="line">M = cv.getAffineTransform(pts1,pts2)</span><br><span class="line">dst = cv.warpAffine(img,M,(cols,rows))</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Input'</span>)</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(dst),plt.title(<span class="string">'Output'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>(&lt;matplotlib.axes._subplots.AxesSubplot at 0x1bb7651dcc0&gt;,
 &lt;matplotlib.image.AxesImage at 0x1bb76bc5c18&gt;,
 Text(0.5, 1.0, &apos;Output&apos;))</code></pre><p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_9_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img = cv.imread(<span class="string">'sudoku.png'</span>)</span><br><span class="line">rows,cols,ch = img.shape</span><br><span class="line">pts1 = np.float32([[<span class="number">56</span>,<span class="number">65</span>],[<span class="number">368</span>,<span class="number">52</span>],[<span class="number">28</span>,<span class="number">387</span>],[<span class="number">389</span>,<span class="number">390</span>]])</span><br><span class="line">pts2 = np.float32([[<span class="number">0</span>,<span class="number">0</span>],[<span class="number">300</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">300</span>],[<span class="number">300</span>,<span class="number">300</span>]])</span><br><span class="line">M = cv.getPerspectiveTransform(pts1,pts2)</span><br><span class="line">dst = cv.warpPerspective(img,M,(<span class="number">300</span>,<span class="number">300</span>))</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Input'</span>)</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(dst),plt.title(<span class="string">'Output'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_10_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="å›¾åƒé˜ˆå€¼"><a href="#å›¾åƒé˜ˆå€¼" class="headerlink" title="å›¾åƒé˜ˆå€¼"></a><span id="header3">å›¾åƒé˜ˆå€¼</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ ç®€å•é˜ˆå€¼ï¼Œè‡ªé€‚åº”é˜ˆå€¼å’ŒOtsué˜ˆå€¼ã€‚</p>
<p>ä½ å°†å­¦ä¹ å‡½æ•°<strong>cv.threshold</strong>å’Œ<strong>cv.adaptiveThreshold</strong>ã€‚</p>
<h2 id="ç®€å•é˜ˆå€¼"><a href="#ç®€å•é˜ˆå€¼" class="headerlink" title="ç®€å•é˜ˆå€¼"></a>ç®€å•é˜ˆå€¼</h2><p>åœ¨è¿™é‡Œï¼Œé—®é¢˜ç›´æˆªäº†å½“ã€‚å¯¹äºæ¯ä¸ªåƒç´ ï¼Œåº”ç”¨ç›¸åŒçš„é˜ˆå€¼ã€‚</p>
<p>å¦‚æœåƒç´ å€¼å°äºé˜ˆå€¼ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸º0ï¼Œå¦åˆ™å°†å…¶è®¾ç½®ä¸ºæœ€å¤§å€¼ã€‚å‡½æ•°<strong>cv.threshold</strong>ç”¨äºåº”ç”¨é˜ˆå€¼ã€‚</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æºå›¾åƒï¼Œå®ƒ<strong>åº”è¯¥æ˜¯ç°åº¦å›¾åƒ</strong>ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯é˜ˆå€¼ï¼Œç”¨äºå¯¹åƒç´ å€¼è¿›è¡Œåˆ†ç±»ã€‚</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯åˆ†é…ç»™è¶…è¿‡é˜ˆå€¼çš„åƒç´ å€¼çš„æœ€å¤§å€¼ã€‚</li>
<li>ç¬¬å››ä¸ªå‚æ•°OpenCVæä¾›äº†ä¸åŒç±»å‹çš„é˜ˆå€¼,é€šè¿‡ä½¿ç”¨<strong>cv.THRESH_BINARY</strong>ç±»å‹ã€‚æ‰€æœ‰ç®€å•çš„é˜ˆå€¼ç±»å‹ä¸ºï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cv.THRESH_BINARY</span><br><span class="line">cv.THRESH_BINARY_INV</span><br><span class="line">cv.THRESH_TRUNC</span><br><span class="line">cv.THRESH_TOZERO</span><br><span class="line">cv.THRESH_TOZERO_INV</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>è¯¥æ–¹æ³•è¿”å›ä¸¤ä¸ªè¾“å‡ºã€‚ç¬¬ä¸€ä¸ªæ˜¯ä½¿ç”¨çš„é˜ˆå€¼ï¼Œç¬¬äºŒä¸ªè¾“å‡ºæ˜¯<strong>é˜ˆå€¼åçš„å›¾åƒ</strong>ã€‚</p>
<p>æ­¤ä»£ç æ¯”è¾ƒäº†ä¸åŒçš„ç®€å•é˜ˆå€¼ç±»å‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'gradient.png'</span>,<span class="number">0</span>)</span><br><span class="line">ret,thresh1 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_BINARY)</span><br><span class="line">ret,thresh2 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_BINARY_INV)</span><br><span class="line">ret,thresh3 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_TRUNC)</span><br><span class="line">ret,thresh4 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_TOZERO)</span><br><span class="line">ret,thresh5 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_TOZERO_INV)</span><br><span class="line">titles = [<span class="string">'Original Image'</span>,<span class="string">'BINARY'</span>,<span class="string">'BINARY_INV'</span>,<span class="string">'TRUNC'</span>,<span class="string">'TOZERO'</span>,<span class="string">'TOZERO_INV'</span>]</span><br><span class="line">images = [img, thresh1, thresh2, thresh3, thresh4, thresh5]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">3</span>,i+<span class="number">1</span>),plt.imshow(images[i],<span class="string">'gray'</span>)</span><br><span class="line">    plt.title(titles[i])</span><br><span class="line">    plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_2_1.png" alt="png"></p>
<h2 id="è‡ªé€‚åº”é˜ˆå€¼"><a href="#è‡ªé€‚åº”é˜ˆå€¼" class="headerlink" title="è‡ªé€‚åº”é˜ˆå€¼"></a>è‡ªé€‚åº”é˜ˆå€¼</h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå…¨å±€å€¼ä½œä¸ºé˜ˆå€¼ã€‚ä½†è¿™å¯èƒ½å¹¶éåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å¾ˆå¥½ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå›¾åƒåœ¨ä¸åŒåŒºåŸŸå…·æœ‰ä¸åŒçš„å…‰ç…§æ¡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªé€‚åº”é˜ˆå€¼é˜ˆå€¼åŒ–å¯ä»¥æä¾›å¸®åŠ©ã€‚åœ¨æ­¤ï¼Œç®—æ³•åŸºäºåƒç´ å‘¨å›´çš„å°åŒºåŸŸç¡®å®šåƒç´ çš„é˜ˆå€¼ã€‚å› æ­¤ï¼Œå¯¹äºåŒä¸€å›¾åƒçš„ä¸åŒåŒºåŸŸï¼Œæˆ‘ä»¬è·å¾—äº†ä¸åŒçš„é˜ˆå€¼ï¼Œè¿™ä¸ºå…‰ç…§åº¦å˜åŒ–çš„å›¾åƒæä¾›äº†æ›´å¥½çš„ç»“æœã€‚</p>
<p>é™¤ä¸Šè¿°å‚æ•°å¤–ï¼Œæ–¹æ³•<strong>cv.adaptiveThreshold</strong>è¿˜åŒ…å«ä¸‰ä¸ªè¾“å…¥å‚æ•°ï¼š</p>
<p>è¯¥<strong>adaptiveMethod</strong>å†³å®šé˜ˆå€¼æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼š</p>
<p>cv.ADAPTIVE_THRESH_MEAN_C::é˜ˆå€¼æ˜¯é‚»è¿‘åŒºåŸŸçš„å¹³å‡å€¼å‡å»å¸¸æ•°<strong>C</strong>ã€‚ </p>
<p>cv.ADAPTIVE_THRESH_GAUSSIAN_C:é˜ˆå€¼æ˜¯é‚»åŸŸå€¼çš„é«˜æ–¯åŠ æƒæ€»å’Œå‡å»å¸¸æ•°<strong>C</strong>ã€‚</p>
<p>è¯¥<strong>BLOCKSIZE</strong>ç¡®å®šé™„è¿‘åŒºåŸŸçš„å¤§å°ï¼Œ<strong>C</strong>æ˜¯ä»é‚»åŸŸåƒç´ çš„å¹³å‡æˆ–åŠ æƒæ€»å’Œä¸­å‡å»çš„ä¸€ä¸ªå¸¸æ•°ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç æ¯”è¾ƒäº†å…‰ç…§å˜åŒ–çš„å›¾åƒçš„å…¨å±€é˜ˆå€¼å’Œè‡ªé€‚åº”é˜ˆå€¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'sudoku.png'</span>,<span class="number">0</span>)</span><br><span class="line">ret,th1 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_BINARY)</span><br><span class="line">th2 = cv.adaptiveThreshold(img,<span class="number">255</span>,cv.ADAPTIVE_THRESH_MEAN_C,\</span><br><span class="line">            cv.THRESH_BINARY,<span class="number">11</span>,<span class="number">2</span>)</span><br><span class="line">th3 = cv.adaptiveThreshold(img,<span class="number">255</span>,cv.ADAPTIVE_THRESH_GAUSSIAN_C,\</span><br><span class="line">            cv.THRESH_BINARY,<span class="number">11</span>,<span class="number">2</span>)</span><br><span class="line">titles = [<span class="string">'Original Image'</span>, <span class="string">'Global Thresholding (v = 127)'</span>,</span><br><span class="line">            <span class="string">'Adaptive Mean Thresholding'</span>, <span class="string">'Adaptive Gaussian Thresholding'</span>]</span><br><span class="line">images = [img, th1, th2, th3]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">2</span>,i+<span class="number">1</span>),plt.imshow(images[i],<span class="string">'gray'</span>)</span><br><span class="line">    plt.title(titles[i])</span><br><span class="line">    plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_4_0.png" alt="png"></p>
<h2 id="Otsuçš„äºŒå€¼åŒ–"><a href="#Otsuçš„äºŒå€¼åŒ–" class="headerlink" title="Otsuçš„äºŒå€¼åŒ–"></a>Otsuçš„äºŒå€¼åŒ–</h2><p>åœ¨å…¨å±€é˜ˆå€¼åŒ–ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»»æ„é€‰æ‹©çš„å€¼ä½œä¸ºé˜ˆå€¼ã€‚ç›¸åï¼ŒOtsuçš„æ–¹æ³•é¿å…äº†å¿…é¡»é€‰æ‹©ä¸€ä¸ªå€¼å¹¶è‡ªåŠ¨ç¡®å®šå®ƒçš„æƒ…å†µã€‚</p>
<p>è€ƒè™‘ä»…å…·æœ‰ä¸¤ä¸ªä¸åŒå›¾åƒå€¼çš„å›¾åƒï¼ˆåŒå³°å›¾åƒï¼‰ï¼Œå…¶ä¸­ç›´æ–¹å›¾å°†ä»…åŒ…å«ä¸¤ä¸ªå³°ã€‚ä¸€ä¸ªå¥½çš„é˜ˆå€¼åº”è¯¥åœ¨è¿™ä¸¤ä¸ªå€¼çš„ä¸­é—´ã€‚ç±»ä¼¼åœ°ï¼ŒOtsuçš„æ–¹æ³•ä»å›¾åƒç›´æ–¹å›¾ä¸­ç¡®å®šæœ€ä½³å…¨å±€é˜ˆå€¼ã€‚</p>
<p>ä¸ºæ­¤ï¼Œä½¿ç”¨äº†<strong>cv.threshold</strong>ä½œä¸ºé™„åŠ æ ‡å¿—ä¼ é€’ã€‚é˜ˆå€¼å¯ä»¥ä»»æ„é€‰æ‹©ã€‚ç„¶åï¼Œç®—æ³•æ‰¾åˆ°æœ€ä½³é˜ˆå€¼ï¼Œè¯¥é˜ˆå€¼ä½œä¸ºç¬¬ä¸€è¾“å‡ºè¿”å›ã€‚</p>
<p>æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ã€‚è¾“å…¥å›¾åƒä¸ºå™ªç‚¹å›¾åƒã€‚</p>
<p>åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œé‡‡ç”¨å€¼ä¸º127çš„å…¨å±€é˜ˆå€¼ã€‚</p>
<p>åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œç›´æ¥é‡‡ç”¨Otsué˜ˆå€¼æ³•ã€‚</p>
<p>åœ¨ç¬¬ä¸‰ç§æƒ…å†µä¸‹ï¼Œé¦–å…ˆä½¿ç”¨5x5é«˜æ–¯æ ¸å¯¹å›¾åƒè¿›è¡Œæ»¤æ³¢ä»¥å»é™¤å™ªå£°ï¼Œç„¶ååº”ç”¨Otsué˜ˆå€¼å¤„ç†ã€‚äº†è§£å™ªå£°æ»¤æ³¢å¦‚ä½•æ”¹å–„ç»“æœã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'sudoku.png'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># å…¨å±€é˜ˆå€¼</span></span><br><span class="line">ret1,th1 = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,cv.THRESH_BINARY)</span><br><span class="line"><span class="comment"># Otsué˜ˆå€¼</span></span><br><span class="line">ret2,th2 = cv.threshold(img,<span class="number">0</span>,<span class="number">255</span>,cv.THRESH_BINARY+cv.THRESH_OTSU)</span><br><span class="line"><span class="comment"># é«˜æ–¯æ»¤æ³¢åå†é‡‡ç”¨Otsué˜ˆå€¼</span></span><br><span class="line">blur = cv.GaussianBlur(img,(<span class="number">5</span>,<span class="number">5</span>),<span class="number">0</span>)</span><br><span class="line">ret3,th3 = cv.threshold(blur,<span class="number">0</span>,<span class="number">255</span>,cv.THRESH_BINARY+cv.THRESH_OTSU)</span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ‰€æœ‰å›¾åƒåŠå…¶ç›´æ–¹å›¾</span></span><br><span class="line">images = [img, <span class="number">0</span>, th1,</span><br><span class="line">          img, <span class="number">0</span>, th2,</span><br><span class="line">          blur, <span class="number">0</span>, th3]</span><br><span class="line">titles = [<span class="string">'Original Noisy Image'</span>,<span class="string">'Histogram'</span>,<span class="string">'Global Thresholding (v=127)'</span>,</span><br><span class="line">          <span class="string">'Original Noisy Image'</span>,<span class="string">'Histogram'</span>,<span class="string">"Otsu's Thresholding"</span>,</span><br><span class="line">          <span class="string">'Gaussian filtered Image'</span>,<span class="string">'Histogram'</span>,<span class="string">"Otsu's Thresholding"</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    plt.subplot(<span class="number">3</span>,<span class="number">3</span>,i*<span class="number">3</span>+<span class="number">1</span>),plt.imshow(images[i*<span class="number">3</span>],<span class="string">'gray'</span>)</span><br><span class="line">    plt.title(titles[i*<span class="number">3</span>]), plt.xticks([]), plt.yticks([])</span><br><span class="line">    plt.subplot(<span class="number">3</span>,<span class="number">3</span>,i*<span class="number">3</span>+<span class="number">2</span>),plt.hist(images[i*<span class="number">3</span>].ravel(),<span class="number">256</span>)</span><br><span class="line">    plt.title(titles[i*<span class="number">3</span>+<span class="number">1</span>]), plt.xticks([]), plt.yticks([])</span><br><span class="line">    plt.subplot(<span class="number">3</span>,<span class="number">3</span>,i*<span class="number">3</span>+<span class="number">3</span>),plt.imshow(images[i*<span class="number">3</span>+<span class="number">2</span>],<span class="string">'gray'</span>)</span><br><span class="line">    plt.title(titles[i*<span class="number">3</span>+<span class="number">2</span>]), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_6_0.png" alt="png"></p>
<h2 id="Otsuçš„äºŒå€¼åŒ–å¦‚ä½•å®ç°ï¼Ÿ"><a href="#Otsuçš„äºŒå€¼åŒ–å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="Otsuçš„äºŒå€¼åŒ–å¦‚ä½•å®ç°ï¼Ÿ"></a>Otsuçš„äºŒå€¼åŒ–å¦‚ä½•å®ç°ï¼Ÿ</h2><p>æœ¬èŠ‚æ¼”ç¤ºäº†OtsuäºŒå€¼åŒ–çš„Pythonå®ç°ï¼Œä»¥å±•ç¤ºå…¶å®é™…å·¥ä½œæ–¹å¼ã€‚</p>
<p>ç”±äºæˆ‘ä»¬æ­£åœ¨å¤„ç†åŒå³°å›¾åƒï¼Œå› æ­¤Otsuçš„ç®—æ³•å°è¯•æ‰¾åˆ°ä¸€ä¸ªé˜ˆå€¼(t)ï¼Œè¯¥é˜ˆå€¼å°†ç”±å…³ç³»å¼ç»™å‡ºçš„<strong>åŠ æƒç±»å†…æ–¹å·®</strong>æœ€å°åŒ–ï¼š</p>
<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/Otsu.png" alt></p>
<p>å®é™…ä¸Šï¼Œå®ƒæ‰¾åˆ°ä½äºä¸¤ä¸ªå³°å€¼ä¹‹é—´çš„tå€¼ï¼Œä»¥ä½¿ä¸¤ä¸ªç±»åˆ«çš„å·®å¼‚æœ€å°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img = cv.imread(<span class="string">'sudoku.png'</span>,<span class="number">0</span>)</span><br><span class="line">blur = cv.GaussianBlur(img,(<span class="number">5</span>,<span class="number">5</span>),<span class="number">0</span>)</span><br><span class="line"><span class="comment"># å¯»æ‰¾å½’ä¸€åŒ–ç›´æ–¹å›¾å’Œå¯¹åº”çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°</span></span><br><span class="line">hist = cv.calcHist([blur],[<span class="number">0</span>],<span class="literal">None</span>,[<span class="number">256</span>],[<span class="number">0</span>,<span class="number">256</span>])</span><br><span class="line">hist_norm = hist.ravel()/hist.max()</span><br><span class="line">Q = hist_norm.cumsum()</span><br><span class="line">bins = np.arange(<span class="number">256</span>)</span><br><span class="line">fn_min = np.inf</span><br><span class="line">thresh = <span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">    p1,p2 = np.hsplit(hist_norm,[i]) <span class="comment"># æ¦‚ç‡</span></span><br><span class="line">    q1,q2 = Q[i],Q[<span class="number">255</span>]-Q[i] <span class="comment"># å¯¹ç±»æ±‚å’Œ</span></span><br><span class="line">    b1,b2 = np.hsplit(bins,[i]) <span class="comment"># æƒé‡</span></span><br><span class="line">    <span class="comment"># å¯»æ‰¾å‡å€¼å’Œæ–¹å·®</span></span><br><span class="line">    m1,m2 = np.sum(p1*b1)/q1, np.sum(p2*b2)/q2</span><br><span class="line">    v1,v2 = np.sum(((b1-m1)**<span class="number">2</span>)*p1)/q1,np.sum(((b2-m2)**<span class="number">2</span>)*p2)/q2</span><br><span class="line">    <span class="comment"># è®¡ç®—æœ€å°åŒ–å‡½æ•°</span></span><br><span class="line">    fn = v1*q1 + v2*q2</span><br><span class="line">    <span class="keyword">if</span> fn &lt; fn_min:</span><br><span class="line">        fn_min = fn</span><br><span class="line">        thresh = i</span><br><span class="line"><span class="comment"># ä½¿ç”¨OpenCVå‡½æ•°æ‰¾åˆ°otsuçš„é˜ˆå€¼</span></span><br><span class="line">ret, otsu = cv.threshold(blur,<span class="number">0</span>,<span class="number">255</span>,cv.THRESH_BINARY+cv.THRESH_OTSU)</span><br><span class="line">print( <span class="string">"&#123;&#125; &#123;&#125;"</span>.format(thresh,ret) )</span><br></pre></td></tr></table></figure>

<pre><code>101 100.0


c:\users\18025\appdata\local\programs\python\python37\lib\site-packages\ipykernel_launcher.py:15: RuntimeWarning: invalid value encountered in double_scalars
  from ipykernel import kernelapp as app
c:\users\18025\appdata\local\programs\python\python37\lib\site-packages\ipykernel_launcher.py:15: RuntimeWarning: divide by zero encountered in double_scalars
  from ipykernel import kernelapp as app
c:\users\18025\appdata\local\programs\python\python37\lib\site-packages\ipykernel_launcher.py:16: RuntimeWarning: invalid value encountered in multiply
  app.launch_new_instance()</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="å›¾åƒå¹³æ»‘"><a href="#å›¾åƒå¹³æ»‘" class="headerlink" title="å›¾åƒå¹³æ»‘"></a><span id="header4">å›¾åƒå¹³æ»‘</span></h1><h2 id="ç›®æ ‡-3"><a href="#ç›®æ ‡-3" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>å­¦ä¼šï¼š - ä½¿ç”¨å„ç§ä½é€šæ»¤é•œæ¨¡ç³Šå›¾åƒ - å°†å®šåˆ¶çš„æ»¤é•œåº”ç”¨äºå›¾åƒï¼ˆ2Då·ç§¯ï¼‰</p>
<h2 id="2Då·ç§¯ï¼ˆå›¾åƒè¿‡æ»¤ï¼‰"><a href="#2Då·ç§¯ï¼ˆå›¾åƒè¿‡æ»¤ï¼‰" class="headerlink" title="2Då·ç§¯ï¼ˆå›¾åƒè¿‡æ»¤ï¼‰"></a>2Då·ç§¯ï¼ˆå›¾åƒè¿‡æ»¤ï¼‰</h2><p>ä¸ä¸€ç»´ä¿¡å·ä¸€æ ·ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å„ç§ä½é€šæ»¤æ³¢å™¨ï¼ˆLPFï¼‰ï¼Œé«˜é€šæ»¤æ³¢å™¨ï¼ˆHPFï¼‰ç­‰å¯¹å›¾åƒè¿›è¡Œæ»¤æ³¢ã€‚LPFæœ‰åŠ©äºæ¶ˆé™¤å™ªå£°ï¼Œä½¿å›¾åƒæ¨¡ç³Šç­‰ã€‚HPFæ»¤æ³¢å™¨æœ‰åŠ©äºåœ¨å›¾åƒä¸­æ‰¾åˆ°è¾¹ç¼˜ã€‚</p>
<p>OpenCVæä¾›äº†ä¸€ä¸ªå‡½æ•°<strong>cv.filter2D</strong>æ¥å°†å†…æ ¸ä¸å›¾åƒè¿›è¡Œå·ç§¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†å°è¯•å¯¹å›¾åƒè¿›è¡Œå¹³å‡æ»¤æ³¢ã€‚5x5å¹³å‡æ»¤æ³¢å™¨å†…æ ¸å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>K=$$\frac{1}{25}<br> \left[<br> \begin{matrix}<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1<br>  \end{matrix}<br>  \right] <br>$$<br>æ“ä½œå¦‚ä¸‹:ä¿æŒè¿™ä¸ªå†…æ ¸åœ¨ä¸€ä¸ªåƒç´ ä¸Šï¼Œå°†æ‰€æœ‰ä½äºè¿™ä¸ªå†…æ ¸çš„25ä¸ªåƒç´ ç›¸åŠ ï¼Œå–å…¶å¹³å‡å€¼ï¼Œç„¶åç”¨æ–°çš„å¹³å‡å€¼æ›¿æ¢ä¸­å¿ƒåƒç´ ã€‚å®ƒå°†å¯¹å›¾åƒä¸­çš„æ‰€æœ‰åƒç´ ç»§ç»­æ­¤æ“ä½œã€‚è¯•è¯•è¿™ä¸ªä»£ç ï¼Œå¹¶æ£€æŸ¥ç»“æœ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">kernel = np.ones((<span class="number">5</span>,<span class="number">5</span>),np.float32)/<span class="number">25</span></span><br><span class="line">dst = cv.filter2D(img,<span class="number">-1</span>,kernel)</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Original'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(dst),plt.title(<span class="string">'Averaging'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_2_0.png" alt="png"></p>
<h2 id="å›¾åƒæ¨¡ç³Šï¼ˆå›¾åƒå¹³æ»‘ï¼‰"><a href="#å›¾åƒæ¨¡ç³Šï¼ˆå›¾åƒå¹³æ»‘ï¼‰" class="headerlink" title="å›¾åƒæ¨¡ç³Šï¼ˆå›¾åƒå¹³æ»‘ï¼‰"></a>å›¾åƒæ¨¡ç³Šï¼ˆå›¾åƒå¹³æ»‘ï¼‰</h2><p>é€šè¿‡å°†å›¾åƒä¸ä½é€šæ»¤æ³¢å™¨å†…æ ¸è¿›è¡Œå·ç§¯æ¥å®ç°å›¾åƒæ¨¡ç³Šã€‚è¿™å¯¹äºæ¶ˆé™¤å™ªéŸ³å¾ˆæœ‰ç”¨ã€‚å®ƒå®é™…ä¸Šä»å›¾åƒä¸­æ¶ˆé™¤äº†é«˜é¢‘éƒ¨åˆ†ï¼ˆä¾‹å¦‚å™ªå£°ï¼Œè¾¹ç¼˜ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨æ­¤æ“ä½œä¸­è¾¹ç¼˜æœ‰äº›æ¨¡ç³Šã€‚ï¼ˆæœ‰ä¸€äº›æ¨¡ç³ŠæŠ€æœ¯ä¹Ÿå¯ä»¥ä¸æ¨¡ç³Šè¾¹ç¼˜ï¼‰ã€‚OpenCVä¸»è¦æä¾›å››ç§ç±»å‹çš„æ¨¡ç³ŠæŠ€æœ¯ã€‚</p>
<h3 id="1-å¹³å‡"><a href="#1-å¹³å‡" class="headerlink" title="1.å¹³å‡"></a>1.å¹³å‡</h3><p>è¿™æ˜¯é€šè¿‡å°†å›¾åƒä¸å½’ä¸€åŒ–æ¡†æ»¤é•œè¿›è¡Œå·ç§¯æ¥å®Œæˆçš„ã€‚å®ƒä»…è·å–å†…æ ¸åŒºåŸŸä¸‹æ‰€æœ‰åƒç´ çš„å¹³å‡å€¼ï¼Œå¹¶æ›¿æ¢ä¸­å¿ƒå…ƒç´ ã€‚è¿™æ˜¯é€šè¿‡åŠŸèƒ½<strong>cv.blur()æˆ–</strong>cv.boxFilter()å®Œæˆçš„ã€‚æ£€æŸ¥æ–‡æ¡£ä»¥è·å–æœ‰å…³å†…æ ¸çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚æˆ‘ä»¬åº”è¯¥æŒ‡å®šå†…æ ¸çš„å®½åº¦å’Œé«˜åº¦ã€‚3x3å½’ä¸€åŒ–æ¡†å¼è¿‡æ»¤å™¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>K=$$\frac{1}{9}<br> \left[<br> \begin{matrix}<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\<br>    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1<br>  \end{matrix}<br>  \right] <br>$$<br>æ³¨æ„ å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨æ ‡å‡†åŒ–çš„æ¡†å¼è¿‡æ»¤å™¨ï¼Œè¯·ä½¿ç”¨<strong>cv.boxFilter()</strong>ã€‚å°†å‚æ•°normalize = Falseä¼ é€’ç»™å‡½æ•°ã€‚</p>
<p>æŸ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºï¼Œå…¶å†…æ ¸å¤§å°ä¸º5x5ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">blur = cv.blur(img,(<span class="number">5</span>,<span class="number">5</span>))</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Original'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(blur),plt.title(<span class="string">'Blurred'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_5_0.png" alt="png"></p>
<h3 id="2-é«˜æ–¯æ¨¡ç³Š"><a href="#2-é«˜æ–¯æ¨¡ç³Š" class="headerlink" title="2.é«˜æ–¯æ¨¡ç³Š"></a>2.é«˜æ–¯æ¨¡ç³Š</h3><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£æ›¿ç›’å¼æ»¤æ³¢å™¨ï¼Œä½¿ç”¨äº†é«˜æ–¯æ ¸ã€‚</p>
<p>è¿™æ˜¯é€šè¿‡åŠŸèƒ½<strong>cv.GaussianBlur()</strong> å®Œæˆçš„ã€‚æˆ‘ä»¬åº”æŒ‡å®šå†…æ ¸çš„å®½åº¦å’Œé«˜åº¦ï¼Œè¯¥å®½åº¦å’Œé«˜åº¦åº”ä¸ºæ­£æ•°å’Œå¥‡æ•°ã€‚</p>
<p>æˆ‘ä»¬è¿˜åº”æŒ‡å®šXå’ŒYæ–¹å‘çš„æ ‡å‡†åå·®ï¼Œåˆ†åˆ«ä¸ºsigmaXå’ŒsigmaYã€‚å¦‚æœä»…æŒ‡å®šsigmaXï¼Œåˆ™å°†sigmaYä¸sigmaXç›¸åŒã€‚</p>
<p>å¦‚æœä¸¤ä¸ªéƒ½ä¸ºé›¶ï¼Œåˆ™æ ¹æ®å†…æ ¸å¤§å°è¿›è¡Œè®¡ç®—ã€‚é«˜æ–¯æ¨¡ç³Šå¯¹äºä»å›¾åƒä¸­å»é™¤é«˜æ–¯å™ªå£°éå¸¸æœ‰æ•ˆã€‚</p>
<p>å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°<strong>cv.getGaussianKernel()</strong> åˆ›å»ºé«˜æ–¯å†…æ ¸ã€‚</p>
<p>å¯ä»¥ä¿®æ”¹ä»¥ä¸Šä»£ç ä»¥å®ç°é«˜æ–¯æ¨¡ç³Šï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">blur = cv.GaussianBlur(img,(<span class="number">5</span>,<span class="number">5</span>),<span class="number">0</span>)</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Original'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(blur),plt.title(<span class="string">'Blurred'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_7_0.png" alt="png"></p>
<h3 id="3-ä¸­ä½æ¨¡ç³Š"><a href="#3-ä¸­ä½æ¨¡ç³Š" class="headerlink" title="3.ä¸­ä½æ¨¡ç³Š"></a>3.ä¸­ä½æ¨¡ç³Š</h3><p>åœ¨è¿™é‡Œï¼Œå‡½æ•°<strong>cv.medianBlur()</strong> æå–å†…æ ¸åŒºåŸŸä¸‹æ‰€æœ‰åƒç´ çš„ä¸­å€¼ï¼Œå¹¶å°†ä¸­å¿ƒå…ƒç´ æ›¿æ¢ä¸ºè¯¥ä¸­å€¼ã€‚</p>
<p>è¿™å¯¹äºæ¶ˆé™¤å›¾åƒä¸­çš„æ¤’ç›å™ªå£°éå¸¸æœ‰æ•ˆã€‚æœ‰è¶£çš„æ˜¯ï¼Œåœ¨ä¸Šè¿°è¿‡æ»¤å™¨ä¸­ï¼Œä¸­å¿ƒå…ƒç´ æ˜¯æ–°è®¡ç®—çš„å€¼ï¼Œè¯¥å€¼å¯ä»¥æ˜¯å›¾åƒä¸­çš„åƒç´ å€¼æˆ–æ–°å€¼ã€‚</p>
<p>ä½†æ˜¯åœ¨ä¸­å€¼æ¨¡ç³Šä¸­ï¼Œä¸­å¿ƒå…ƒç´ æ€»æ˜¯è¢«å›¾åƒä¸­çš„æŸäº›åƒç´ å€¼ä»£æ›¿ã€‚æœ‰æ•ˆé™ä½å™ªéŸ³ã€‚å…¶å†…æ ¸å¤§å°åº”ä¸ºæ­£å¥‡æ•°æ•´æ•°ã€‚</p>
<p>åœ¨æ­¤æ¼”ç¤ºä¸­ï¼Œæˆ‘å‘åŸå§‹å›¾åƒæ·»åŠ äº†50ï¼…çš„å™ªå£°å¹¶åº”ç”¨äº†ä¸­å€¼æ¨¡ç³Šã€‚æ£€æŸ¥ç»“æœï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">median = cv.medianBlur(img,<span class="number">5</span>)</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Original'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(median),plt.title(<span class="string">'Blurred'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_9_0.png" alt="png"></p>
<h3 id="4-åŒè¾¹æ»¤æ³¢"><a href="#4-åŒè¾¹æ»¤æ³¢" class="headerlink" title="4.åŒè¾¹æ»¤æ³¢"></a>4.åŒè¾¹æ»¤æ³¢</h3><p>cv.bilateralFilter() åœ¨å»é™¤å™ªå£°çš„åŒæ—¶ä¿æŒè¾¹ç¼˜æ¸…æ™°é”åˆ©éå¸¸æœ‰æ•ˆã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸å…¶ä»–è¿‡æ»¤å™¨ç›¸æ¯”ï¼Œè¯¥æ“ä½œé€Ÿåº¦è¾ƒæ…¢ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œé«˜æ–¯æ»¤æ³¢å™¨é‡‡ç”¨åƒç´ å‘¨å›´çš„é‚»åŸŸå¹¶æ‰¾åˆ°å…¶é«˜æ–¯åŠ æƒå¹³å‡å€¼ã€‚</p>
<p>é«˜æ–¯æ»¤æ³¢å™¨ä»…æ˜¯ç©ºé—´çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ»¤æ³¢æ—¶ä¼šè€ƒè™‘é™„è¿‘çš„åƒç´ ã€‚å®ƒä¸è€ƒè™‘åƒç´ æ˜¯å¦å…·æœ‰å‡ ä¹ç›¸åŒçš„å¼ºåº¦ã€‚å®ƒä¸è€ƒè™‘åƒç´ æ˜¯å¦æ˜¯è¾¹ç¼˜åƒç´ ã€‚å› æ­¤å®ƒä¹Ÿæ¨¡ç³Šäº†è¾¹ç¼˜ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³åšçš„ã€‚</p>
<p>åŒè¾¹æ»¤æ³¢å™¨åœ¨ç©ºé—´ä¸­ä¹Ÿé‡‡ç”¨é«˜æ–¯æ»¤æ³¢å™¨ï¼Œä½†æ˜¯åˆæœ‰ä¸€ä¸ªé«˜æ–¯æ»¤æ³¢å™¨ï¼Œå®ƒæ˜¯åƒç´ å·®çš„å‡½æ•°ã€‚</p>
<p>ç©ºé—´çš„é«˜æ–¯å‡½æ•°ç¡®ä¿ä»…è€ƒè™‘é™„è¿‘åƒç´ çš„æ¨¡ç³Šï¼Œè€Œå¼ºåº¦å·®çš„é«˜æ–¯å‡½æ•°ç¡®ä¿ä»…è€ƒè™‘å¼ºåº¦ä¸ä¸­å¿ƒåƒç´ ç›¸ä¼¼çš„é‚£äº›åƒç´ çš„æ¨¡ç³Šã€‚ç”±äºè¾¹ç¼˜çš„åƒç´ å¼ºåº¦å˜åŒ–è¾ƒå¤§ï¼Œå› æ­¤å¯ä»¥ä¿ç•™è¾¹ç¼˜ã€‚</p>
<p>ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ä½¿ç”¨åŒè¾¹è¿‡æ»¤å™¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">blur = cv.bilateralFilter(img,<span class="number">9</span>,<span class="number">75</span>,<span class="number">75</span>)</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img),plt.title(<span class="string">'Original'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(blur),plt.title(<span class="string">'Blurred'</span>)</span><br><span class="line">plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%861/output_11_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>opencvä¸­çš„å›¾åƒå¤„ç†2</title>
    <url>/2020/07/13/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%862/</url>
    <content><![CDATA[<ul>
<li>5.<a href="#header1">å½¢æ€è½¬æ¢</a></li>
<li>6.<a href="#header2">å›¾åƒæ¢¯åº¦</a></li>
<li>7.<a href="#header3">Cannyè¾¹ç¼˜æ£€æµ‹</a></li>
<li>8.<a href="#header4">å›¾åƒé‡‘å­—å¡”</a><a id="more"></a>


</li>
</ul>
<h1 id="å½¢æ€å­¦è½¬æ¢"><a href="#å½¢æ€å­¦è½¬æ¢" class="headerlink" title="å½¢æ€å­¦è½¬æ¢"></a><span id="header1">å½¢æ€å­¦è½¬æ¢</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨è¿™ä¸€ç« å½“ä¸­ï¼Œ æˆ‘ä»¬å°†å­¦ä¹ ä¸åŒçš„å½¢æ€å­¦æ“ä½œï¼Œä¾‹å¦‚ä¾µèš€ï¼Œè†¨èƒ€ï¼Œå¼€è¿ç®—ï¼Œé—­è¿ç®—ç­‰ã€‚<br>æˆ‘ä»¬å°†çœ‹åˆ°ä¸åŒçš„åŠŸèƒ½ï¼Œ</p>
<p>ä¾‹å¦‚ï¼šcv.erode(),cv.dilate(), cv.morphologyEx()ç­‰ã€‚</p>
<h2 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>å½¢æ€å˜æ¢æ˜¯ä¸€äº›åŸºäºå›¾åƒå½¢çŠ¶çš„ç®€å•æ“ä½œã€‚é€šå¸¸åœ¨äºŒè¿›åˆ¶å›¾åƒä¸Šæ‰§è¡Œã€‚</p>
<p>å®ƒéœ€è¦ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬çš„åŸå§‹å›¾åƒï¼Œç¬¬äºŒä¸ªæ˜¯å†³å®š<strong>æ“ä½œæ€§è´¨çš„ç»“æ„å…ƒç´ </strong>æˆ–<strong>å†…æ ¸</strong>ã€‚</p>
<p>ä¸¤ç§åŸºæœ¬çš„å½¢æ€å­¦ç®—å­æ˜¯ä¾µèš€å’Œè†¨èƒ€ã€‚</p>
<p>ç„¶åï¼Œå®ƒçš„å˜ä½“å½¢å¼ï¼ˆå¦‚â€œæ‰“å¼€â€ï¼Œâ€œå…³é—­â€ï¼Œâ€œæ¸å˜â€ç­‰ï¼‰ä¹Ÿå¼€å§‹èµ·ä½œç”¨ã€‚åœ¨ä¸‹å›¾çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å°†ä¸€ä¸€çœ‹åˆ°å®ƒä»¬ï¼š</p>
<h2 id="1-ä¾µèš€"><a href="#1-ä¾µèš€" class="headerlink" title="1. ä¾µèš€"></a>1. ä¾µèš€</h2><p>ä¾µèš€çš„åŸºæœ¬æ€æƒ³å°±åƒåœŸå£¤ä¾µèš€ä¸€æ ·ï¼Œå®ƒä¾µèš€å‰æ™¯ç‰©ä½“çš„è¾¹ç•Œ(å°½é‡ä½¿å‰æ™¯ä¿æŒç™½è‰²)ã€‚</p>
<p>å®ƒæ˜¯åšä»€ä¹ˆçš„å‘¢?å†…æ ¸æ»‘åŠ¨é€šè¿‡å›¾åƒ(åœ¨2Då·ç§¯ä¸­)ã€‚</p>
<p>åŸå§‹å›¾åƒä¸­çš„ä¸€ä¸ªåƒç´ (æ— è®ºæ˜¯1è¿˜æ˜¯0)åªæœ‰å½“å†…æ ¸ä¸‹çš„æ‰€æœ‰åƒç´ éƒ½æ˜¯1æ—¶æ‰è¢«è®¤ä¸ºæ˜¯1ï¼Œå¦åˆ™å®ƒå°±ä¼šè¢«ä¾µèš€(å˜æˆ0)ã€‚</p>
<p>ç»“æœæ˜¯ï¼Œæ ¹æ®å†…æ ¸çš„å¤§å°ï¼Œè¾¹ç•Œé™„è¿‘çš„æ‰€æœ‰åƒç´ éƒ½ä¼šè¢«ä¸¢å¼ƒã€‚</p>
<p>å› æ­¤ï¼Œå‰æ™¯ç‰©ä½“çš„åšåº¦æˆ–å¤§å°å‡å°ï¼Œæˆ–åªæ˜¯å›¾åƒä¸­çš„ç™½è‰²åŒºåŸŸå‡å°ã€‚</p>
<p>å®ƒæœ‰åŠ©äºå»é™¤å°çš„ç™½è‰²å™ªå£°(æ­£å¦‚æˆ‘ä»¬åœ¨é¢œè‰²ç©ºé—´ç« èŠ‚ä¸­çœ‹åˆ°çš„)ï¼Œåˆ†ç¦»ä¸¤ä¸ªè¿æ¥çš„å¯¹è±¡ç­‰ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ª5x5å†…æ ¸ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰çš„1ã€‚</p>
<h2 id="2-æ‰©å¼ "><a href="#2-æ‰©å¼ " class="headerlink" title="2. æ‰©å¼ "></a>2. æ‰©å¼ </h2><p>å®ƒä¸ä¾µèš€æ­£å¥½ç›¸åã€‚å¦‚æœå†…æ ¸ä¸‹çš„è‡³å°‘ä¸€ä¸ªåƒç´ ä¸ºâ€œ 1â€ï¼Œåˆ™åƒç´ å…ƒç´ ä¸ºâ€œ 1â€ã€‚</p>
<p>å› æ­¤ï¼Œå®ƒä¼šå¢åŠ å›¾åƒä¸­çš„ç™½è‰²åŒºåŸŸæˆ–å¢åŠ å‰æ™¯å¯¹è±¡çš„å¤§å°ã€‚</p>
<p>é€šå¸¸ï¼Œåœ¨æ¶ˆé™¤å™ªéŸ³çš„æƒ…å†µä¸‹ï¼Œè…èš€åä¼šè†¨èƒ€ã€‚å› ä¸ºè…èš€ä¼šæ¶ˆé™¤ç™½å™ªå£°ï¼Œä½†ä¹Ÿä¼šç¼©å°ç‰©ä½“ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œäº†æ‰©å±•ã€‚ç”±äºå™ªéŸ³æ¶ˆå¤±äº†ï¼Œå®ƒä»¬ä¸ä¼šå›æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡åŒºåŸŸå¢åŠ äº†ã€‚åœ¨è¿æ¥å¯¹è±¡çš„æŸåéƒ¨åˆ†æ—¶ä¹Ÿå¾ˆæœ‰ç”¨ã€‚</p>
<h2 id="3-å¼€è¿ç®—"><a href="#3-å¼€è¿ç®—" class="headerlink" title="3. å¼€è¿ç®—"></a>3. å¼€è¿ç®—</h2><p>å¼€æ”¾åªæ˜¯<strong>ä¾µèš€ç„¶åæ‰©å¼ </strong>çš„å¦ä¸€ä¸ªåç§°ã€‚</p>
<p>å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œå®ƒå¯¹äºæ¶ˆé™¤å™ªéŸ³å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°<strong>cv.morphologyEx</strong>()</p>
<h2 id="4-é—­è¿ç®—"><a href="#4-é—­è¿ç®—" class="headerlink" title="4. é—­è¿ç®—"></a>4. é—­è¿ç®—</h2><p>é—­è¿ç®—ä¸å¼€è¿ç®—ç›¸åï¼Œå…ˆæ‰©å¼ ç„¶åå†ä¾µèš€ã€‚</p>
<p>åœ¨å…³é—­å‰æ™¯å¯¹è±¡å†…éƒ¨çš„å°å­”æˆ–å¯¹è±¡ä¸Šçš„å°é»‘ç‚¹æ—¶å¾ˆæœ‰ç”¨ã€‚</p>
<h2 id="5-å½¢æ€å­¦æ¢¯åº¦"><a href="#5-å½¢æ€å­¦æ¢¯åº¦" class="headerlink" title="5. å½¢æ€å­¦æ¢¯åº¦"></a>5. å½¢æ€å­¦æ¢¯åº¦</h2><p>è¿™æ˜¯å›¾åƒæ‰©å¼ å’Œä¾µèš€ä¹‹é—´çš„åŒºåˆ«ã€‚</p>
<p>ç»“æœå°†çœ‹èµ·æ¥åƒå¯¹è±¡çš„è½®å»“ã€‚</p>
<h2 id="6-é¡¶å¸½"><a href="#6-é¡¶å¸½" class="headerlink" title="6. é¡¶å¸½"></a>6. é¡¶å¸½</h2><p>å®ƒæ˜¯è¾“å…¥å›¾åƒå’Œå›¾åƒå¼€è¿ç®—ä¹‹å·®ã€‚ä¸‹é¢çš„ç¤ºä¾‹é’ˆå¯¹9x9å†…æ ¸å®Œæˆã€‚</p>
<h2 id="7-é»‘å¸½"><a href="#7-é»‘å¸½" class="headerlink" title="7. é»‘å¸½"></a>7. é»‘å¸½</h2><p>è¿™æ˜¯è¾“å…¥å›¾åƒå’Œå›¾åƒé—­è¿ç®—ä¹‹å·®ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> pylab <span class="keyword">import</span> mpl </span><br><span class="line">mpl.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>] <span class="comment"># æŒ‡å®šé»˜è®¤å­—ä½“ </span></span><br><span class="line">mpl.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="literal">False</span> <span class="comment"># è§£å†³ä¿å­˜å›¾åƒæ˜¯è´Ÿå·'-'æ˜¾ç¤ºä¸ºæ–¹å—çš„é—®é¢˜</span></span><br><span class="line">img = cv.imread(<span class="string">'j.png'</span>,<span class="number">0</span>)</span><br><span class="line">kernel = np.ones((<span class="number">5</span>,<span class="number">5</span>),np.uint8)</span><br><span class="line">erosion = cv.erode(img,kernel,iterations = <span class="number">1</span>)</span><br><span class="line">dilation = cv.dilate(img,kernel,iterations = <span class="number">1</span>) </span><br><span class="line">opening = cv.morphologyEx(img, cv.MORPH_OPEN, kernel) </span><br><span class="line">closing = cv.morphologyEx(img, cv.MORPH_CLOSE, kernel) </span><br><span class="line">gradient = cv.morphologyEx(img, cv.MORPH_GRADIENT, kernel) </span><br><span class="line">tophat = cv.morphologyEx(img, cv.MORPH_TOPHAT, kernel) </span><br><span class="line">blackhat = cv.morphologyEx(img, cv.MORPH_BLACKHAT, kernel) </span><br><span class="line">imgs = [img,erosion,dilation,opening,closing,gradient,tophat,blackhat]</span><br><span class="line">titles = [<span class="string">'åŸå›¾'</span>,<span class="string">'ä¾µèš€'</span>,<span class="string">'è†¨èƒ€'</span>,<span class="string">'å¼€è¿ç®—'</span>,<span class="string">'é—­è¿ç®—'</span>,<span class="string">'å½¢æ€å­¦æ¢¯åº¦'</span>,<span class="string">'é¡¶å¸½'</span>,<span class="string">'é»‘å¸½'</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(imgs)):</span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">4</span>,i+<span class="number">1</span>)</span><br><span class="line">    plt.imshow(imgs[i])</span><br><span class="line">    plt.title(titles[i])</span><br><span class="line">    plt.xticks([])</span><br><span class="line">    plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/13/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%862/output_9_0.png" alt="png"></p>
<h2 id="ç»“æ„å…ƒç´ "><a href="#ç»“æ„å…ƒç´ " class="headerlink" title="ç»“æ„å…ƒç´ "></a>ç»“æ„å…ƒç´ </h2><p>åœ¨Numpyçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­æ‰‹åŠ¨åˆ›å»ºäº†ä¸€ä¸ªç»“æ„å…ƒç´ ã€‚</p>
<p>å®ƒæ˜¯çŸ©å½¢ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æ¤­åœ†å½¢/åœ†å½¢çš„å†…æ ¸ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºæ­¤ï¼ŒOpenCVå…·æœ‰ä¸€ä¸ªå‡½æ•°<strong>cv.getStructuringElement</strong>()ã€‚</p>
<p>æ‚¨åªéœ€ä¼ é€’å†…æ ¸çš„å½¢çŠ¶å’Œå¤§å°ï¼Œå³å¯è·å¾—æ‰€éœ€çš„å†…æ ¸</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># çŸ©å½¢</span></span><br><span class="line">cv.getStructuringElement(cv.MORPH_RECT,(<span class="number">5</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure>




<pre><code>array([[1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1]], dtype=uint8)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¤­åœ†å†…æ ¸</span></span><br><span class="line">cv.getStructuringElement(cv.MORPH_ELLIPSE,(<span class="number">5</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure>




<pre><code>array([[0, 0, 1, 0, 0],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [0, 0, 1, 0, 0]], dtype=uint8)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åå­—å†…æ ¸</span></span><br><span class="line">cv.getStructuringElement(cv.MORPH_CROSS,(<span class="number">5</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure>




<pre><code>array([[0, 0, 1, 0, 0],
       [0, 0, 1, 0, 0],
       [1, 1, 1, 1, 1],
       [0, 0, 1, 0, 0],
       [0, 0, 1, 0, 0]], dtype=uint8)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="å›¾åƒæ¢¯åº¦"><a href="#å›¾åƒæ¢¯åº¦" class="headerlink" title="å›¾åƒæ¢¯åº¦"></a><span id="header2">å›¾åƒæ¢¯åº¦</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š - æŸ¥æ‰¾å›¾åƒæ¢¯åº¦ï¼Œè¾¹ç¼˜ç­‰ - </p>
<p>æˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹å‡½æ•°ï¼šcv.Sobel()ï¼Œcv.Scharr()ï¼Œcv.Laplacian()ç­‰</p>
<h2 id="ç†è®º-1"><a href="#ç†è®º-1" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>OpenCVæä¾›ä¸‰ç§ç±»å‹çš„æ¢¯åº¦æ»¤æ³¢å™¨æˆ–é«˜é€šæ»¤æ³¢å™¨ï¼Œå³Sobelï¼ŒScharrå’ŒLaplacianã€‚æˆ‘ä»¬å°†çœ‹åˆ°ä»–ä»¬æ¯ä¸€ç§ã€‚</p>
<h2 id="1-Sobel-å’Œ-Scharr-ç®—å­"><a href="#1-Sobel-å’Œ-Scharr-ç®—å­" class="headerlink" title="1. Sobel å’Œ Scharr ç®—å­"></a>1. Sobel å’Œ Scharr ç®—å­</h2><p>Sobelç®—å­æ˜¯é«˜æ–¯å¹³æ»‘åŠ å¾®åˆ†è¿ç®—çš„è”åˆè¿ç®—ï¼Œå› æ­¤å®ƒæ›´æŠ—å™ªå£°ã€‚é€†å¯ä»¥æŒ‡å®šè¦é‡‡ç”¨çš„å¯¼æ•°æ–¹å‘ï¼Œå‚ç›´æˆ–æ°´å¹³ï¼ˆåˆ†åˆ«é€šè¿‡å‚æ•°yorderå’Œxorderï¼‰ã€‚é€†è¿˜å¯ä»¥é€šè¿‡å‚æ•°ksizeæŒ‡å®šå†…æ ¸çš„å¤§å°ã€‚å¦‚æœksize = -1ï¼Œåˆ™ä½¿ç”¨3x3 Scharræ»¤æ³¢å™¨ï¼Œæ¯”3x3 Sobelæ»¤æ³¢å™¨å…·æœ‰æ›´å¥½çš„ç»“æœã€‚è¯·å‚é˜…æ–‡æ¡£ä»¥äº†è§£æ‰€ä½¿ç”¨çš„å†…æ ¸ã€‚</p>
<h2 id="2-Laplacian-ç®—å­"><a href="#2-Laplacian-ç®—å­" class="headerlink" title="2. Laplacian ç®—å­"></a>2. Laplacian ç®—å­</h2><p>å®ƒè®¡ç®—äº†ç”±å…³ç³»Î”src=$\frac{\delta^2 src}{\delta x^2}+\frac{\delta^2 src}{\delta y^2}$ç»™å‡ºçš„å›¾åƒçš„æ‹‰æ™®æ‹‰æ–¯å›¾,å®ƒæ˜¯æ¯ä¸€é˜¶å¯¼æ•°é€šè¿‡Sobelç®—å­è®¡ç®—ã€‚å¦‚æœksize = 1,ç„¶åä½¿ç”¨ä»¥ä¸‹å†…æ ¸ç”¨äºè¿‡æ»¤:</p>
<p>kernel=$$<br> \left[<br> \begin{matrix}<br>   0 &amp; 1 &amp; 0 \<br>   1 &amp; -4 &amp; 1 \<br>   0 &amp; 1 &amp; 0<br>  \end{matrix}<br>  \right] <br>$$<br>ä»£ç <br>ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†å•ä¸ªå›¾è¡¨ä¸­çš„æ‰€æœ‰ç®—å­ã€‚æ‰€æœ‰å†…æ ¸éƒ½æ˜¯5x5å¤§å°ã€‚è¾“å‡ºå›¾åƒçš„æ·±åº¦é€šè¿‡-1å¾—åˆ°ç»“æœçš„np.uint8å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'dave.png'</span>,<span class="number">0</span>)</span><br><span class="line">laplacian = cv.Laplacian(img,cv.CV_64F)</span><br><span class="line">sobelx = cv.Sobel(img,cv.CV_64F,<span class="number">1</span>,<span class="number">0</span>,ksize=<span class="number">5</span>)</span><br><span class="line">sobely = cv.Sobel(img,cv.CV_64F,<span class="number">0</span>,<span class="number">1</span>,ksize=<span class="number">5</span>)</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>),plt.imshow(img,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Original'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>),plt.imshow(laplacian,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Laplacian'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>),plt.imshow(sobelx,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Sobel X'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>),plt.imshow(sobely,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Sobel Y'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/13/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%862/output_1_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="Cannyè¾¹ç¼˜æ£€æµ‹"><a href="#Cannyè¾¹ç¼˜æ£€æµ‹" class="headerlink" title="Cannyè¾¹ç¼˜æ£€æµ‹"></a><span id="header3">Cannyè¾¹ç¼˜æ£€æµ‹</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  - Cannyè¾¹ç¼˜æ£€æµ‹çš„æ¦‚å¿µ - OpenCVå‡½æ•°: cv.Canny()</p>
<h2 id="ç†è®º-2"><a href="#ç†è®º-2" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>Canny Edge Detectionæ˜¯ä¸€ç§æµè¡Œçš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•ã€‚å®ƒç”±John F. Cannyå‘æ˜</p>
<p>è¿™æ˜¯ä¸€ä¸ªå¤šé˜¶æ®µç®—æ³•ï¼Œæˆ‘ä»¬å°†ç»å†æ¯ä¸ªé˜¶æ®µã€‚</p>
<h2 id="é™å™ª"><a href="#é™å™ª" class="headerlink" title="é™å™ª"></a>é™å™ª</h2><p>ç”±äºè¾¹ç¼˜æ£€æµ‹å®¹æ˜“å—åˆ°å›¾åƒä¸­å™ªå£°çš„å½±å“ï¼Œå› æ­¤ç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨5x5é«˜æ–¯æ»¤æ³¢å™¨æ¶ˆé™¤å›¾åƒä¸­çš„å™ªå£°ã€‚æˆ‘ä»¬å·²ç»åœ¨å‰é¢çš„ç« èŠ‚ä¸­çœ‹åˆ°äº†è¿™ä¸€ç‚¹ã€‚</p>
<p>æŸ¥æ‰¾å›¾åƒçš„å¼ºåº¦æ¢¯åº¦<br>ç„¶åä½¿ç”¨Sobelæ ¸åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šå¯¹å¹³æ»‘çš„å›¾åƒè¿›è¡Œæ»¤æ³¢ï¼Œä»¥åœ¨æ°´å¹³æ–¹å‘(Gx)å’Œå‚ç›´æ–¹å‘(Gy)ä¸Šè·å¾—ä¸€é˜¶å¯¼æ•°ã€‚ä»è¿™ä¸¤å¼ å›¾ç‰‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ¯ä¸ªåƒç´ çš„è¾¹ç¼˜æ¸å˜å’Œæ–¹å‘ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>$$<br>Edge_Gradient ; (G) = \sqrt{G_x^2 + G_y^2} \ Angle ; (\theta) = \tan^{-1} \bigg(\frac{G_y}{G_x}\bigg)<br>$$<br>æ¸å˜æ–¹å‘å§‹ç»ˆå‚ç›´äºè¾¹ç¼˜ã€‚å°†å…¶èˆå…¥ä¸ºä»£è¡¨å‚ç›´ï¼Œæ°´å¹³å’Œä¸¤ä¸ªå¯¹è§’çº¿æ–¹å‘çš„å››ä¸ªè§’åº¦ä¹‹ä¸€ã€‚</p>
<p>éæå¤§å€¼æŠ‘åˆ¶ åœ¨è·å¾—æ¢¯åº¦å¤§å°å’Œæ–¹å‘åï¼Œå°†å¯¹å›¾åƒè¿›è¡Œå…¨é¢æ‰«æï¼Œä»¥å»é™¤å¯èƒ½ä¸æ„æˆè¾¹ç¼˜çš„æ‰€æœ‰ä¸éœ€è¦çš„åƒç´ ã€‚</p>
<p>ä¸ºæ­¤ï¼Œåœ¨æ¯ä¸ªåƒç´ å¤„ï¼Œæ£€æŸ¥åƒç´ æ˜¯å¦æ˜¯å…¶åœ¨æ¢¯åº¦æ–¹å‘ä¸Šé™„è¿‘çš„å±€éƒ¨æœ€å¤§å€¼ã€‚æŸ¥çœ‹ä¸‹é¢çš„å›¾ç‰‡ï¼š<br><img src="http://qiniu.aihubs.net/nms.jpg" alt></p>
<p>ç‚¹Aåœ¨è¾¹ç¼˜ï¼ˆå‚ç›´æ–¹å‘ï¼‰ä¸Šã€‚æ¸å˜æ–¹å‘å‚ç›´äºè¾¹ç¼˜ã€‚ç‚¹Bå’ŒCåœ¨æ¢¯åº¦æ–¹å‘ä¸Šã€‚å› æ­¤ï¼Œå°†Aç‚¹ä¸Bç‚¹å’ŒCç‚¹è¿›è¡Œæ£€æŸ¥ï¼Œçœ‹æ˜¯å¦å½¢æˆå±€éƒ¨æœ€å¤§å€¼ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™è€ƒè™‘å°†å…¶ç”¨äºä¸‹ä¸€é˜¶æ®µï¼Œå¦åˆ™å°†å…¶æŠ‘åˆ¶ï¼ˆç½®ä¸ºé›¶ï¼‰ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œä½ å¾—åˆ°çš„ç»“æœæ˜¯å¸¦æœ‰â€œç»†è¾¹â€çš„äºŒè¿›åˆ¶å›¾åƒã€‚</p>
<h2 id="ç£æ»é˜ˆå€¼"><a href="#ç£æ»é˜ˆå€¼" class="headerlink" title="ç£æ»é˜ˆå€¼"></a>ç£æ»é˜ˆå€¼</h2><p>è¯¥é˜¶æ®µç¡®å®šå“ªäº›è¾¹ç¼˜å…¨éƒ¨æ˜¯çœŸæ­£çš„è¾¹ç¼˜ï¼Œå“ªäº›ä¸æ˜¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªé˜ˆå€¼minValå’ŒmaxValã€‚å¼ºåº¦æ¢¯åº¦å¤§äºmaxValçš„ä»»ä½•è¾¹ç¼˜å¿…å®šæ˜¯è¾¹ç¼˜ï¼Œè€Œå°äºminValçš„é‚£äº›è¾¹ç¼˜å¿…å®šæ˜¯éè¾¹ç¼˜ï¼Œå› æ­¤å°†å…¶ä¸¢å¼ƒã€‚ä»‹äºè¿™ä¸¤ä¸ªé˜ˆå€¼ä¹‹é—´çš„å¯¹è±¡æ ¹æ®å…¶è¿é€šæ€§è¢«åˆ†ç±»ä¸ºè¾¹ç¼˜æˆ–éè¾¹ç¼˜ã€‚å¦‚æœå°†å®ƒä»¬è¿æ¥åˆ°â€œè¾¹ç¼˜â€åƒç´ ï¼Œåˆ™å°†å®ƒä»¬è§†ä¸ºè¾¹ç¼˜çš„ä¸€éƒ¨åˆ†ã€‚å¦åˆ™ï¼Œå®ƒä»¬ä¹Ÿå°†è¢«ä¸¢å¼ƒã€‚è§ä¸‹å›¾ï¼š</p>
<p><img src="http://qiniu.aihubs.net/hysteresis.jpg" alt><br>è¾¹ç¼˜Aåœ¨maxValä¹‹ä¸Šï¼Œå› æ­¤è¢«è§†ä¸ºâ€œç¡®å®šè¾¹ç¼˜â€ã€‚å°½ç®¡è¾¹Cä½äºmaxValï¼Œä½†å®ƒè¿æ¥åˆ°è¾¹Aï¼Œå› æ­¤ä¹Ÿè¢«è§†ä¸ºæœ‰æ•ˆè¾¹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å®Œæ•´çš„æ›²çº¿ã€‚ä½†æ˜¯è¾¹ç¼˜Bå°½ç®¡åœ¨minValä¹‹ä¸Šå¹¶ä¸”ä¸è¾¹ç¼˜Cå¤„äºåŒä¸€åŒºåŸŸï¼Œä½†æ˜¯å®ƒæ²¡æœ‰è¿æ¥åˆ°ä»»ä½•â€œç¡®ä¿è¾¹ç¼˜â€ï¼Œå› æ­¤è¢«ä¸¢å¼ƒã€‚å› æ­¤ï¼Œéå¸¸é‡è¦çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬å¿…é¡»ç›¸åº”åœ°é€‰æ‹©minValå’ŒmaxValä»¥è·å¾—æ­£ç¡®çš„ç»“æœã€‚</p>
<p>åœ¨è¾¹ç¼˜ä¸ºé•¿çº¿çš„å‡è®¾ä¸‹ï¼Œè¯¥é˜¶æ®µè¿˜æ¶ˆé™¤äº†å°åƒç´ å™ªå£°ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„æ˜¯å›¾åƒä¸­çš„å¼ºè¾¹ç¼˜ã€‚</p>
<h2 id="OpenCVä¸­çš„Canny-Edgeæ£€æµ‹"><a href="#OpenCVä¸­çš„Canny-Edgeæ£€æµ‹" class="headerlink" title="OpenCVä¸­çš„Canny Edgeæ£€æµ‹"></a>OpenCVä¸­çš„Canny Edgeæ£€æµ‹</h2><p>OpenCVå°†ä»¥ä¸Šæ‰€æœ‰å†…å®¹æ”¾åœ¨å•ä¸ªå‡½æ•°<strong>cv.Canny</strong>()ä¸­ã€‚æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„è¾“å…¥å›¾åƒã€‚</p>
<p>ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯æˆ‘ä»¬çš„minValå’ŒmaxValã€‚</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯perture_sizeã€‚å®ƒæ˜¯ç”¨äºæŸ¥æ‰¾å›¾åƒæ¸å˜çš„Sobelå†…æ ¸çš„å¤§å°ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸º3ã€‚</p>
<p>æœ€åä¸€ä¸ªå‚æ•°æ˜¯L2gradientï¼Œå®ƒæŒ‡å®šç”¨äºæŸ¥æ‰¾æ¢¯åº¦å¹…åº¦çš„æ–¹ç¨‹å¼ã€‚</p>
<p>å¦‚æœä¸ºTrueï¼Œåˆ™ä½¿ç”¨ä¸Šé¢æåˆ°çš„æ›´ç²¾ç¡®çš„å…¬å¼ï¼Œå¦åˆ™ä½¿ç”¨ä»¥ä¸‹å‡½æ•°ï¼šEdge_Gradient(G)=|Gx|+|Gy|ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¸ºFalseã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">edges = cv.Canny(img,<span class="number">100</span>,<span class="number">200</span>)</span><br><span class="line">plt.subplot(<span class="number">121</span>),plt.imshow(img,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Original Image'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>),plt.imshow(edges,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'Edge Image'</span>), plt.xticks([]), plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/13/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%862/output_2_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="å›¾åƒé‡‘å­—å¡”"><a href="#å›¾åƒé‡‘å­—å¡”" class="headerlink" title="å›¾åƒé‡‘å­—å¡”"></a><span id="header4">å›¾åƒé‡‘å­—å¡”</span></h1><h1 id="ç›®æ ‡-3"><a href="#ç›®æ ‡-3" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h1><p>åœ¨æœ¬ç« ä¸­ï¼Œ - æˆ‘ä»¬å°†å­¦ä¹ å›¾åƒé‡‘å­—å¡” - æˆ‘ä»¬å°†ä½¿ç”¨å›¾åƒé‡‘å­—å¡”åˆ›å»ºä¸€ä¸ªæ–°çš„æ°´æœâ€œOrappleâ€ - </p>
<p>æˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹åŠŸèƒ½ï¼šcv.pyrUp()ï¼Œcv.pyrDown()</p>
<h2 id="ç†è®º-3"><a href="#ç†è®º-3" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>é€šå¸¸ï¼Œæˆ‘ä»¬è¿‡å»ä½¿ç”¨çš„æ˜¯æ’å®šå¤§å°çš„å›¾åƒã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒåˆ†è¾¨ç‡çš„ï¼ˆç›¸åŒï¼‰å›¾åƒã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“åœ¨å›¾åƒä¸­æœç´¢æŸäº›ä¸œè¥¿ï¼ˆä¾‹å¦‚äººè„¸ï¼‰æ—¶ï¼Œæˆ‘ä»¬ä¸ç¡®å®šå¯¹è±¡å°†ä»¥å¤šå¤§çš„å°ºå¯¸æ˜¾ç¤ºåœ¨å›¾åƒä¸­ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†éœ€è¦åˆ›å»ºä¸€ç»„å…·æœ‰ä¸åŒåˆ†è¾¨ç‡çš„ç›¸åŒå›¾åƒï¼Œå¹¶åœ¨æ‰€æœ‰å›¾åƒä¸­æœç´¢å¯¹è±¡ã€‚</p>
<p>è¿™äº›å…·æœ‰ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒé›†ç§°ä¸ºâ€œå›¾åƒé‡‘å­—å¡”â€ï¼ˆå› ä¸ºå½“å®ƒä»¬å †å åœ¨åº•éƒ¨æ—¶ï¼Œæœ€é«˜åˆ†è¾¨ç‡çš„å›¾åƒä½äºåº•éƒ¨ï¼Œæœ€ä½åˆ†è¾¨ç‡çš„å›¾åƒä½äºé¡¶éƒ¨æ—¶ï¼Œçœ‹èµ·æ¥åƒé‡‘å­—å¡”ï¼‰ã€‚</p>
<p>æœ‰ä¸¤ç§å›¾åƒé‡‘å­—å¡”ã€‚1ï¼‰é«˜æ–¯é‡‘å­—å¡”<strong>å’Œ2ï¼‰</strong>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</p>
<p>é«˜æ–¯é‡‘å­—å¡”ä¸­çš„è¾ƒé«˜çº§åˆ«ï¼ˆä½åˆ†è¾¨ç‡ï¼‰æ˜¯é€šè¿‡åˆ é™¤è¾ƒä½çº§åˆ«ï¼ˆè¾ƒé«˜åˆ†è¾¨ç‡ï¼‰å›¾åƒä¸­çš„è¿ç»­è¡Œå’Œåˆ—è€Œå½¢æˆçš„ã€‚</p>
<p>ç„¶åï¼Œè¾ƒé«˜çº§åˆ«çš„æ¯ä¸ªåƒç´ ç”±åŸºç¡€çº§åˆ«çš„5ä¸ªåƒç´ çš„è´¡çŒ®ä¸é«˜æ–¯æƒé‡å½¢æˆã€‚</p>
<p>é€šè¿‡è¿™æ ·åšï¼ŒMÃ—Nå›¾åƒå˜æˆM/2Ã—N/2å›¾åƒã€‚å› æ­¤é¢ç§¯å‡å°‘åˆ°åŸå§‹é¢ç§¯çš„å››åˆ†ä¹‹ä¸€ã€‚</p>
<p>å®ƒç§°ä¸ºOctaveã€‚å½“æˆ‘ä»¬åœ¨é‡‘å­—å¡”ä¸­è¶Šé ä¸Šæ—¶ï¼ˆå³åˆ†è¾¨ç‡ä¸‹é™ï¼‰ï¼Œè¿™ç§æ¨¡å¼å°±ä¼šç»§ç»­ã€‚</p>
<p>åŒæ ·ï¼Œåœ¨æ‰©å±•æ—¶ï¼Œæ¯ä¸ªçº§åˆ«çš„é¢ç§¯å˜ä¸º4å€ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>cv.pyrDown</strong>()å’Œ<strong>cv.pyrUp</strong>()å‡½æ•°æ‰¾åˆ°é«˜æ–¯é‡‘å­—å¡”</p>
<p>ä»¥ä¸‹æ˜¯å›¾åƒé‡‘å­—å¡”ä¸­çš„4ä¸ªçº§åˆ«ã€‚<br><img src="http://qiniu.aihubs.net/messipyr.jpg" alt><br>ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<strong>cv.pyrUp</strong>()å‡½æ•°æŸ¥çœ‹å›¾åƒé‡‘å­—å¡”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">higher_reso2 &#x3D; cv.pyrUp(lower_reso)</span><br></pre></td></tr></table></figure>
<p>è®°ä½ï¼Œhigher_reso2ä¸ç­‰äºhigher_resoï¼Œå› ä¸ºä¸€æ—¦é™ä½äº†åˆ†è¾¨ç‡ï¼Œå°±ä¼šä¸¢å¤±ä¿¡æ¯ã€‚ä¸‹é¢çš„å›¾åƒæ˜¯3å±‚çš„é‡‘å­—å¡”ä»æœ€å°çš„å›¾åƒåœ¨å‰é¢çš„æƒ…å†µä¸‹åˆ›å»ºã€‚ä¸åŸå›¾å¯¹æ¯”:<br><img src="http://qiniu.aihubs.net/messiup.jpg" alt></p>
<p>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ç”±é«˜æ–¯é‡‘å­—å¡”å½¢æˆã€‚æ²¡æœ‰ä¸“ç”¨åŠŸèƒ½ã€‚</p>
<p>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”å›¾åƒä»…åƒè¾¹ç¼˜å›¾åƒã€‚å®ƒçš„å¤§å¤šæ•°å…ƒç´ ä¸ºé›¶ã€‚å®ƒä»¬ç”¨äºå›¾åƒå‹ç¼©ã€‚</p>
<p>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”çš„å±‚ç”±é«˜æ–¯é‡‘å­—å¡”çš„å±‚ä¸é«˜æ–¯é‡‘å­—å¡”çš„é«˜å±‚çš„æ‰©å±•ç‰ˆæœ¬ä¹‹é—´çš„å·®å½¢æˆã€‚</p>
<p>æ‹‰æ™®æ‹‰æ–¯ç­‰çº§çš„ä¸‰ä¸ªç­‰çº§å¦‚ä¸‹æ‰€ç¤ºï¼ˆè°ƒæ•´å¯¹æ¯”åº¦ä»¥å¢å¼ºå†…å®¹ï¼‰ï¼š<br><img src="http://qiniu.aihubs.net/lap.jpg" alt></p>
<h2 id="ä½¿ç”¨é‡‘å­—å¡”è¿›è¡Œå›¾åƒèåˆ"><a href="#ä½¿ç”¨é‡‘å­—å¡”è¿›è¡Œå›¾åƒèåˆ" class="headerlink" title="ä½¿ç”¨é‡‘å­—å¡”è¿›è¡Œå›¾åƒèåˆ"></a>ä½¿ç”¨é‡‘å­—å¡”è¿›è¡Œå›¾åƒèåˆ</h2><p>é‡‘å­—å¡”çš„ä¸€ç§åº”ç”¨æ˜¯å›¾åƒèåˆã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å›¾åƒæ‹¼æ¥ä¸­ï¼Œæ‚¨éœ€è¦å°†ä¸¤ä¸ªå›¾åƒå †å åœ¨ä¸€èµ·ï¼Œä½†æ˜¯ç”±äºå›¾åƒä¹‹é—´çš„ä¸è¿ç»­æ€§ï¼Œå¯èƒ½çœ‹èµ·æ¥ä¸å¤ªå¥½ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨é‡‘å­—å¡”æ··åˆå›¾åƒå¯ä»¥æ— ç¼æ··åˆï¼Œè€Œä¸ä¼šåœ¨å›¾åƒä¸­ä¿ç•™å¤§é‡æ•°æ®ã€‚</p>
<p>ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ˜¯å°†ä¸¤ç§æ°´æœï¼Œæ©™å’Œè‹¹æœæ··åˆåœ¨ä¸€èµ·</p>
<p>åªéœ€å®Œæˆä»¥ä¸‹æ­¥éª¤å³å¯ï¼š</p>
<ul>
<li>åŠ è½½è‹¹æœå’Œæ©™å­çš„ä¸¤ä¸ªå›¾åƒ</li>
<li>æŸ¥æ‰¾è‹¹æœå’Œæ©™å­çš„é«˜æ–¯é‡‘å­—å¡”ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ çº§åˆ«æ•°ä¸º6ï¼‰</li>
<li>åœ¨é«˜æ–¯é‡‘å­—å¡”ä¸­ï¼Œæ‰¾åˆ°å…¶æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</li>
<li>ç„¶ååœ¨æ¯ä¸ªæ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”çº§åˆ«ä¸­åŠ å…¥è‹¹æœçš„å·¦åŠéƒ¨åˆ†å’Œæ©™å­çš„å³åŠéƒ¨åˆ†</li>
<li>æœ€åä»æ­¤è”åˆå›¾åƒé‡‘å­—å¡”ä¸­é‡å»ºåŸå§‹å›¾åƒã€‚<br><img src="http://qiniu.aihubs.net/orapple.jpg" alt></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np,sys</span><br><span class="line">A = cv.imread(<span class="string">'apple.png'</span>)</span><br><span class="line">B = cv.imread(<span class="string">'orange.png'</span>)</span><br><span class="line"><span class="comment"># ç”ŸæˆAçš„é«˜æ–¯é‡‘å­—å¡”</span></span><br><span class="line">G = A.copy()</span><br><span class="line">gpA = [G]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    G = cv.pyrDown(G)</span><br><span class="line">    gpA.append(G)</span><br><span class="line"><span class="comment"># ç”ŸæˆBçš„é«˜æ–¯é‡‘å­—å¡”</span></span><br><span class="line">G = B.copy()</span><br><span class="line">gpB = [G]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    G = cv.pyrDown(G)</span><br><span class="line">    gpB.append(G)</span><br><span class="line"><span class="comment"># ç”ŸæˆAçš„æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</span></span><br><span class="line">lpA = [gpA[<span class="number">5</span>]]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line">    GE = cv.pyrUp(gpA[i])</span><br><span class="line">    L = cv.subtract(gpA[i<span class="number">-1</span>],GE)</span><br><span class="line">    lpA.append(L)</span><br><span class="line"><span class="comment"># ç”ŸæˆBçš„æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</span></span><br><span class="line">lpB = [gpB[<span class="number">5</span>]]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line">    GE = cv.pyrUp(gpB[i])</span><br><span class="line">    L = cv.subtract(gpB[i<span class="number">-1</span>],GE)</span><br><span class="line">    lpB.append(L)</span><br><span class="line"><span class="comment"># ç°åœ¨åœ¨æ¯ä¸ªçº§åˆ«ä¸­æ·»åŠ å·¦å³ä¸¤åŠå›¾åƒ </span></span><br><span class="line">LS = []</span><br><span class="line"><span class="keyword">for</span> la,lb <span class="keyword">in</span> zip(lpA,lpB):</span><br><span class="line">    rows,cols,dpt = la.shape</span><br><span class="line">    ls = np.hstack((la[:,<span class="number">0</span>:cols/<span class="number">2</span>], lb[:,cols/<span class="number">2</span>:]))</span><br><span class="line">    LS.append(ls)</span><br><span class="line"><span class="comment"># ç°åœ¨é‡å»º</span></span><br><span class="line">ls_ = LS[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">    ls_ = cv.pyrUp(ls_)</span><br><span class="line">    ls_ = cv.add(ls_, LS[i])</span><br><span class="line"><span class="comment"># å›¾åƒä¸ç›´æ¥è¿æ¥çš„æ¯ä¸€åŠ</span></span><br><span class="line">real = np.hstack((A[:,:cols/<span class="number">2</span>],B[:,cols/<span class="number">2</span>:]))</span><br><span class="line">cv.imwrite(<span class="string">'Pyramid_blending2.jpg'</span>,ls_)</span><br><span class="line">cv.imwrite(<span class="string">'Direct_blending.jpg'</span>,real)</span><br><span class="line"><span class="comment">##</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>opencvä¸­çš„å›¾åƒå¤„ç†3-è½®å»“</title>
    <url>/2020/07/13/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%863-%E8%BD%AE%E5%BB%93/</url>
    <content><![CDATA[<ul>
<li>9.1.<a href="#header1">è½®å»“å…¥é—¨</a></li>
<li>9.2.<a href="#header2">è½®å»“ç‰¹å¾</a></li>
<li>9.3.<a href="#header3">è½®å»“å±æ€§</a></li>
<li>9.4.<a href="#header4">è½®å»“æ›´å¤šå±æ€§</a></li>
<li>9.5.<a href="#header5">è½®å»“åˆ†å±‚</a><a id="more"></a>

</li>
</ul>
<h1 id="è½®å»“ï¼šå…¥é—¨"><a href="#è½®å»“ï¼šå…¥é—¨" class="headerlink" title="è½®å»“ï¼šå…¥é—¨"></a><span id="header1">è½®å»“ï¼šå…¥é—¨</span></h1><p>##ç›®æ ‡<br>äº†è§£è½®å»“æ˜¯ä»€ä¹ˆã€‚</p>
<p>å­¦ä¹ æŸ¥æ‰¾è½®å»“ï¼Œç»˜åˆ¶è½®å»“ç­‰ã€‚</p>
<p>ä½ å°†çœ‹åˆ°ä»¥ä¸‹åŠŸèƒ½ï¼šcv.findContours()ï¼Œcv.drawContours()</p>
<h2 id="ä»€ä¹ˆæ˜¯è½®å»“"><a href="#ä»€ä¹ˆæ˜¯è½®å»“" class="headerlink" title="ä»€ä¹ˆæ˜¯è½®å»“?"></a>ä»€ä¹ˆæ˜¯è½®å»“?</h2><p>è½®å»“å¯ä»¥ç®€å•åœ°è§£é‡Šä¸ºè¿æ¥å…·æœ‰ç›¸åŒé¢œè‰²æˆ–å¼ºåº¦çš„æ‰€æœ‰è¿ç»­ç‚¹ï¼ˆæ²¿è¾¹ç•Œï¼‰çš„æ›²çº¿ã€‚</p>
<p>è½®å»“æ˜¯ç”¨äºå½¢çŠ¶åˆ†æä»¥åŠå¯¹è±¡æ£€æµ‹å’Œè¯†åˆ«çš„æœ‰ç”¨å·¥å…·ã€‚</p>
<p>ä¸ºäº†è·å¾—æ›´é«˜çš„å‡†ç¡®æ€§ï¼Œè¯·ä½¿ç”¨äºŒè¿›åˆ¶å›¾åƒã€‚å› æ­¤ï¼Œåœ¨æ‰¾åˆ°è½®å»“ä¹‹å‰ï¼Œè¯·åº”ç”¨é˜ˆå€¼æˆ–cannyè¾¹ç¼˜æ£€æµ‹ã€‚</p>
<p>ä»OpenCV 3.2å¼€å§‹ï¼ŒfindContours()ä¸å†ä¿®æ”¹æºå›¾åƒã€‚</p>
<p>åœ¨OpenCVä¸­ï¼Œæ‰¾åˆ°è½®å»“å°±åƒä»é»‘è‰²èƒŒæ™¯ä¸­æ‰¾åˆ°ç™½è‰²ç‰©ä½“ã€‚å› æ­¤è¯·è®°ä½ï¼Œè¦æ‰¾åˆ°çš„å¯¹è±¡åº”è¯¥æ˜¯ç™½è‰²ï¼ŒèƒŒæ™¯åº”è¯¥æ˜¯é»‘è‰²ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>)</span><br><span class="line">imgray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)</span><br><span class="line">ret, thresh = cv.threshold(imgray, <span class="number">127</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">unknown,contours, hierarchy = cv.findContours(thresh, cv.RETR_TREE, cv.CHAIN_APPROX_SIMPLE)</span><br></pre></td></tr></table></figure>

<p>findcontour()å‡½æ•°ä¸­æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æºå›¾åƒï¼Œ</p>
<p>ç¬¬äºŒä¸ªæ˜¯è½®å»“æ£€ç´¢æ¨¡å¼ï¼Œ</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯è½®å»“é€¼è¿‘æ–¹æ³•ã€‚</p>
<p>è¾“å‡ºæœªçŸ¥é‡,ç­‰é«˜çº¿å’Œå±‚æ¬¡ç»“æ„ã€‚</p>
<p>è½®å»“æ˜¯å›¾åƒä¸­æ‰€æœ‰è½®å»“çš„Pythonåˆ—è¡¨ã€‚</p>
<p>æ¯ä¸ªå•ç‹¬çš„è½®å»“æ˜¯ä¸€ä¸ª(x,y)åæ ‡çš„Numpyæ•°ç»„çš„è¾¹ç•Œç‚¹çš„å¯¹è±¡ã€‚</p>
<p>æ³¨æ„ ç¨åæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªå‚æ•°ä»¥åŠæœ‰å…³å±‚æ¬¡ç»“æ„ã€‚</p>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œä»£ç ç¤ºä¾‹ä¸­èµ‹äºˆå®ƒä»¬çš„å€¼å°†é€‚ç”¨äºæ‰€æœ‰å›¾åƒã€‚</p>
<h2 id="å¦‚ä½•ç»˜åˆ¶è½®å»“"><a href="#å¦‚ä½•ç»˜åˆ¶è½®å»“" class="headerlink" title="å¦‚ä½•ç»˜åˆ¶è½®å»“?"></a>å¦‚ä½•ç»˜åˆ¶è½®å»“?</h2><p>è¦ç»˜åˆ¶è½®å»“ï¼Œè¯·ä½¿ç”¨<strong>cv.drawContours</strong>å‡½æ•°ã€‚åªè¦æœ‰è¾¹ç•Œç‚¹ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨æ¥ç»˜åˆ¶ä»»ä½•å½¢çŠ¶ã€‚</p>
<p>å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æºå›¾åƒï¼Œ</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯åº”è¯¥ä½œä¸ºPythonåˆ—è¡¨ä¼ é€’çš„è½®å»“ï¼Œ</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è½®å»“çš„ç´¢å¼•ï¼ˆåœ¨ç»˜åˆ¶å•ä¸ªè½®å»“æ—¶æœ‰ç”¨ã€‚è¦ç»˜åˆ¶æ‰€æœ‰è½®å»“ï¼Œè¯·ä¼ é€’-1ï¼‰ï¼Œå…¶ä½™å‚æ•°æ˜¯é¢œè‰²ï¼Œåšåº¦ç­‰ç­‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨å›¾åƒä¸­ç»˜åˆ¶æ‰€æœ‰è½®å»“ï¼š</span></span><br><span class="line">cv.drawContours(img, contours, <span class="number">-1</span>, (<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>), <span class="number">3</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»˜åˆ¶å•ä¸ªè½®å»“ï¼Œå¦‚ç¬¬å››ä¸ªè½®å»“ï¼š</span></span><br><span class="line">cnt = contours[<span class="number">4</span>]</span><br><span class="line">cv.drawContours(img, [cnt], <span class="number">0</span>, (<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>), <span class="number">3</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»¥ä¸‹æ–¹æ³•ä¼šå¾ˆæœ‰ç”¨ï¼š</span></span><br><span class="line">cnt = contours[<span class="number">4</span>]</span><br><span class="line">cv.drawContours(img, [cnt], <span class="number">0</span>, (<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>), <span class="number">3</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<p>è½®å»“è¿‘ä¼¼æ–¹æ³•<br>è¿™æ˜¯<strong>cv.findContours</strong>å‡½æ•°ä¸­çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚å®ƒå®é™…ä¸Šè¡¨ç¤ºä»€ä¹ˆï¼Ÿ</p>
<p>ä¸Šé¢æˆ‘ä»¬å‘Šè¯‰æˆ‘ä»¬è½®å»“æ˜¯å¼ºåº¦ç›¸åŒçš„å½¢çŠ¶çš„è¾¹ç•Œã€‚</p>
<p>å®ƒå­˜å‚¨å½¢çŠ¶è¾¹ç•Œçš„(x,y)åæ ‡ã€‚ä½†æ˜¯å®ƒå­˜å‚¨æ‰€æœ‰åæ ‡å—ï¼Ÿè¿™æ˜¯é€šè¿‡è¿™ç§è½®å»“è¿‘ä¼¼æ–¹æ³•æŒ‡å®šçš„ã€‚</p>
<p>å¦‚æœä¼ é€’<strong>cv.CHAIN_APPROX_NONE</strong>ï¼Œåˆ™å°†å­˜å‚¨æ‰€æœ‰è¾¹ç•Œç‚¹ã€‚</p>
<p>ä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬éœ€è¦æ‰€æœ‰è¿™äº›è¦ç‚¹å—ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼Œæ‚¨æ‰¾åˆ°äº†ä¸€æ¡ç›´çº¿çš„è½®å»“ã€‚æ‚¨æ˜¯å¦éœ€è¦çº¿ä¸Šçš„æ‰€æœ‰ç‚¹æ¥ä»£è¡¨è¯¥çº¿ï¼Ÿ</p>
<p>ä¸ï¼Œæˆ‘ä»¬åªéœ€è¦è¯¥çº¿çš„ä¸¤ä¸ªç«¯ç‚¹å³å¯ã€‚</p>
<p>è¿™å°±æ˜¯<strong>cv.CHAIN_APPROX_SIMPLE</strong>æ‰€åšçš„ã€‚å®ƒåˆ é™¤æ‰€æœ‰å†—ä½™ç‚¹å¹¶å‹ç¼©è½®å»“ï¼Œä»è€ŒèŠ‚çœå†…å­˜ã€‚</p>
<p>ä¸‹é¢çš„çŸ©å½¢å›¾åƒæ¼”ç¤ºäº†æ­¤æŠ€æœ¯ã€‚</p>
<p>åªéœ€åœ¨è½®å»“æ•°ç»„ä¸­çš„æ‰€æœ‰åæ ‡ä¸Šç»˜åˆ¶ä¸€ä¸ªåœ†ï¼ˆä»¥è“è‰²ç»˜åˆ¶ï¼‰ã€‚</p>
<p>ç¬¬ä¸€å¹…å›¾åƒæ˜¾ç¤ºäº†æˆ‘ç”¨<strong>cv.CHAIN_APPROX_NONE</strong>è·å¾—çš„ç§¯åˆ†ï¼ˆ734ä¸ªç‚¹ï¼‰ï¼Œ</p>
<p>ç¬¬äºŒå¹…å›¾åƒæ˜¾ç¤ºäº†æˆ‘ç”¨<strong>cv.CHAIN_APPROX_SIMPLE</strong>è·å¾—çš„æ•ˆæœï¼ˆåªæœ‰4ä¸ªç‚¹ï¼‰ã€‚</p>
<p>çœ‹ï¼Œå®ƒå¯ä»¥èŠ‚çœå¤šå°‘å†…å­˜ï¼ï¼ï¼</p>
<p><img src="http://qiniu.aihubs.net/none.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="è½®å»“ç‰¹å¾"><a href="#è½®å»“ç‰¹å¾" class="headerlink" title="è½®å»“ç‰¹å¾"></a><span id="header2">è½®å»“ç‰¹å¾</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  - å¦‚ä½•æ‰¾åˆ°è½®å»“çš„ä¸åŒç‰¹å¾ï¼Œ</p>
<p>ä¾‹å¦‚é¢ç§¯ï¼Œå‘¨é•¿ï¼Œè´¨å¿ƒï¼Œè¾¹ç•Œæ¡†ç­‰ã€‚ - æ‚¨å°†çœ‹åˆ°å¤§é‡ä¸è½®å»“æœ‰å…³çš„åŠŸèƒ½ã€‚</p>
<h2 id="1-ç‰¹å¾çŸ©"><a href="#1-ç‰¹å¾çŸ©" class="headerlink" title="1. ç‰¹å¾çŸ©"></a>1. ç‰¹å¾çŸ©</h2><p>ç‰¹å¾çŸ©å¯ä»¥å¸®åŠ©æ‚¨è®¡ç®—ä¸€äº›ç‰¹å¾ï¼Œä¾‹å¦‚ç‰©ä½“çš„è´¨å¿ƒï¼Œç‰©ä½“çš„é¢ç§¯ç­‰ã€‚</p>
<p>è¯·æŸ¥çœ‹ç‰¹å¾çŸ©ä¸Šçš„ç»´åŸºç™¾ç§‘é¡µé¢ã€‚</p>
<p>å‡½æ•°<strong>cv.moments</strong>()æä¾›äº†æ‰€æœ‰è®¡ç®—å‡ºçš„çŸ©å€¼çš„å­—å…¸ã€‚è§ä¸‹æ–‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">ret,thresh = cv.threshold(img,<span class="number">127</span>,<span class="number">255</span>,<span class="number">0</span>)</span><br><span class="line">unknown,contours,hierarchy = cv.findContours(thresh, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">cnt = contours[<span class="number">0</span>]</span><br><span class="line">M = cv.moments(cnt)</span><br><span class="line">print( M )</span><br></pre></td></tr></table></figure>

<pre><code>{&apos;m00&apos;: 2.0, &apos;m10&apos;: 536.0, &apos;m01&apos;: 1272.0, &apos;m20&apos;: 143648.3333333333, &apos;m11&apos;: 340896.0, &apos;m02&apos;: 808992.3333333333, &apos;m30&apos;: 38497932.0, &apos;m21&apos;: 91360340.0, &apos;m12&apos;: 216809945.33333334, &apos;m03&apos;: 514519548.0, &apos;mu20&apos;: 0.3333333333139308, &apos;mu11&apos;: 0.0, &apos;mu02&apos;: 0.3333333332557231, &apos;mu30&apos;: 1.4901161193847656e-08, &apos;mu21&apos;: 1.234002411365509e-08, &apos;mu12&apos;: 3.073364496231079e-08, &apos;mu03&apos;: 1.1920928955078125e-07, &apos;nu20&apos;: 0.0833333333284827, &apos;nu11&apos;: 0.0, &apos;nu02&apos;: 0.08333333331393078, &apos;nu30&apos;: 2.634178031930877e-09, &apos;nu21&apos;: 2.1814286826927578e-09, &apos;nu12&apos;: 5.432992190857434e-09, &apos;nu03&apos;: 2.1073424255447017e-08}</code></pre><p>ä»è¿™ä¸€åˆ»èµ·ï¼Œæ‚¨å¯ä»¥æå–æœ‰ç”¨çš„æ•°æ®ï¼Œ<br>ä¾‹å¦‚é¢ç§¯ï¼Œè´¨å¿ƒç­‰ã€‚è´¨å¿ƒç”±å…³ç³»ç»™å‡ºï¼Œ$C_x\frac{M_{10}}{M_{00}}$ å’Œ $C_y\frac{M_{01}}{M_{00}}$ã€‚å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cx = int(M[<span class="string">'m10'</span>]/M[<span class="string">'m00'</span>])</span><br><span class="line">cy = int(M[<span class="string">'m01'</span>]/M[<span class="string">'m00'</span>])</span><br></pre></td></tr></table></figure>

<h2 id="2-è½®å»“é¢ç§¯"><a href="#2-è½®å»“é¢ç§¯" class="headerlink" title="2. è½®å»“é¢ç§¯"></a>2. è½®å»“é¢ç§¯</h2><p>è½®å»“åŒºåŸŸç”±å‡½æ•°<strong>cv.contourArea</strong>()æˆ–ä»çŸ©M[â€˜m00â€™]ä¸­ç»™å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">area = cv.contourArea(cnt) </span><br><span class="line">print(area)</span><br><span class="line">print(M[<span class="string">'m00'</span>])</span><br></pre></td></tr></table></figure>

<pre><code>2.0
2.0</code></pre><h2 id="3-è½®å»“å‘¨é•¿"><a href="#3-è½®å»“å‘¨é•¿" class="headerlink" title="3. è½®å»“å‘¨é•¿"></a>3. è½®å»“å‘¨é•¿</h2><p>ä¹Ÿç§°ä¸ºå¼§é•¿ã€‚å¯ä»¥ä½¿ç”¨<strong>cv.arcLength</strong>()å‡½æ•°æ‰¾åˆ°å®ƒã€‚ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šå½¢çŠ¶æ˜¯é—­åˆè½®å»“(True)è¿˜æ˜¯æ›²çº¿ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">perimeter = cv.arcLength(cnt,<span class="literal">True</span>)</span><br><span class="line">perimeter</span><br></pre></td></tr></table></figure>




<pre><code>5.656854152679443</code></pre><h2 id="4-è½®å»“è¿‘ä¼¼"><a href="#4-è½®å»“è¿‘ä¼¼" class="headerlink" title="4. è½®å»“è¿‘ä¼¼"></a>4. è½®å»“è¿‘ä¼¼</h2><p>æ ¹æ®æˆ‘ä»¬æŒ‡å®šçš„ç²¾åº¦ï¼Œå®ƒå¯ä»¥å°†è½®å»“å½¢çŠ¶è¿‘ä¼¼ä¸ºé¡¶ç‚¹æ•°é‡è¾ƒå°‘çš„å…¶ä»–å½¢çŠ¶ã€‚</p>
<p>å®ƒæ˜¯Douglas-Peuckerç®—æ³•çš„å®ç°ã€‚æ£€æŸ¥ç»´åŸºç™¾ç§‘é¡µé¢ä¸Šçš„ç®—æ³•å’Œæ¼”ç¤ºã€‚</p>
<p>ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œå‡è®¾æ‚¨è¯•å›¾åœ¨å›¾åƒä¸­æ‰¾åˆ°ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œä½†æ˜¯ç”±äºå›¾åƒä¸­çš„æŸäº›é—®é¢˜ï¼Œæ‚¨æ²¡æœ‰å¾—åˆ°ä¸€ä¸ªå®Œç¾çš„æ­£æ–¹å½¢ï¼Œè€Œæ˜¯ä¸€ä¸ªâ€œåå½¢çŠ¶â€ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚</p>
<p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½æ¥è¿‘ä¼¼å½¢çŠ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ç§°ä¸ºepsilonï¼Œå®ƒæ˜¯ä»è½®å»“åˆ°è¿‘ä¼¼è½®å»“çš„æœ€å¤§è·ç¦»ã€‚</p>
<p>å®ƒæ˜¯ä¸€ä¸ªç²¾åº¦å‚æ•°ã€‚éœ€è¦æ­£ç¡®é€‰æ‹©epsilonæ‰èƒ½è·å¾—æ­£ç¡®çš„è¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">epsilon = <span class="number">0.1</span>*cv.arcLength(cnt,<span class="literal">True</span>) </span><br><span class="line">approx = cv.approxPolyDP(cnt,epsilon,<span class="literal">True</span>)</span><br><span class="line">print(epsilon)</span><br><span class="line">print(approx)</span><br></pre></td></tr></table></figure>

<pre><code>0.5656854152679444
[[[267 636]]

 [[268 635]]

 [[269 636]]

 [[268 637]]]</code></pre><p>ä¸‹é¢ï¼Œåœ¨ç¬¬äºŒå¼ å›¾ç‰‡ä¸­ï¼Œç»¿çº¿æ˜¾ç¤ºäº†Îµ=å¼§é•¿çš„10ï¼…æ—¶çš„è¿‘ä¼¼æ›²çº¿ã€‚ç¬¬ä¸‰å¹…å›¾æ˜¾ç¤ºäº†Îµ=å¼§é•¿åº¦çš„1ï¼…æ—¶çš„æƒ…å†µã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šæ›²çº¿æ˜¯å¦é—­åˆã€‚<br><img src="http://qiniu.aihubs.net/approx.jpg" alt></p>
<h2 id="5-è½®å»“å‡¸åŒ…"><a href="#5-è½®å»“å‡¸åŒ…" class="headerlink" title="5. è½®å»“å‡¸åŒ…"></a>5. è½®å»“å‡¸åŒ…</h2><p>å‡¸åŒ…å¤–è§‚çœ‹èµ·æ¥ä¸è½®å»“é€¼è¿‘ç›¸ä¼¼ï¼Œä½†ä¸ç›¸ä¼¼ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ä¸¤è€…å¯èƒ½æä¾›ç›¸åŒçš„ç»“æœï¼‰ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œcv.convexHull()å‡½æ•°æ£€æŸ¥æ›²çº¿æ˜¯å¦å­˜åœ¨å‡¸å‡¹ç¼ºé™·å¹¶å¯¹å…¶è¿›è¡Œæ ¡æ­£ã€‚</p>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œå‡¸æ›²çº¿æ˜¯å§‹ç»ˆå‡¸å‡ºæˆ–è‡³å°‘å¹³å¦çš„æ›²çº¿ã€‚å¦‚æœåœ¨å†…éƒ¨å‡¸å‡ºï¼Œåˆ™ç§°ä¸ºå‡¸åº¦ç¼ºé™·ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ£€æŸ¥ä¸‹é¢çš„æ‰‹çš„å›¾åƒã€‚çº¢çº¿æ˜¾ç¤ºæ‰‹çš„å‡¸åŒ…ã€‚åŒå‘ç®­å¤´æ ‡è®°æ˜¾ç¤ºå‡¸åº¦ç¼ºé™·ï¼Œè¿™æ˜¯å‡¸åŒ…ä¸è½®å»“çº¿ä¹‹é—´çš„å±€éƒ¨æœ€å¤§åå·®ã€‚</p>
<p><img src="http://qiniu.aihubs.net/convexitydefects.jpg" alt></p>
<p>å…³äºå®ƒçš„è¯­æ³•ï¼Œæœ‰ä¸€äº›éœ€è¦è®¨è®ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hull &#x3D; cv.convexHull(points[, hull[, clockwise[, returnPoints]]</span><br></pre></td></tr></table></figure>
<p>å‚æ•°è¯¦ç»†ä¿¡æ¯ï¼š </p>
<ul>
<li>ç‚¹**æ˜¯æˆ‘ä»¬ä¼ é€’åˆ°çš„è½®å»“ã€‚ </li>
<li><strong>å‡¸åŒ…</strong>æ˜¯è¾“å‡ºï¼Œé€šå¸¸æˆ‘ä»¬å¿½ç•¥å®ƒã€‚ </li>
<li>**é¡ºæ—¶é’ˆæ–¹å‘ï¼šæ–¹å‘æ ‡è®°ã€‚å¦‚æœä¸ºTrueï¼Œåˆ™è¾“å‡ºå‡¸åŒ…ä¸ºé¡ºæ—¶é’ˆæ–¹å‘ã€‚å¦åˆ™ï¼Œå…¶æ–¹å‘ä¸ºé€†æ—¶é’ˆæ–¹å‘ã€‚ </li>
<li>returnPointsï¼šé»˜è®¤æƒ…å†µä¸‹ä¸ºTrueã€‚ç„¶åè¿”å›å‡¸åŒ…çš„åæ ‡ã€‚å¦‚æœä¸ºFalseï¼Œåˆ™è¿”å›ä¸å‡¸åŒ…ç‚¹ç›¸å¯¹åº”çš„è½®å»“ç‚¹çš„ç´¢å¼•ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œè¦è·å¾—å¦‚ä¸Šå›¾æ‰€ç¤ºçš„å‡¸åŒ…ï¼Œä»¥ä¸‹å†…å®¹å°±è¶³å¤Ÿäº†ï¼š<br>``<br>hull = cv.convexHull(cnt) </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä½†æ˜¯ï¼Œå¦‚æœè¦æŸ¥æ‰¾å‡¸åº¦ç¼ºé™·ï¼Œåˆ™éœ€è¦ä¼ é€’returnPoints &#x3D; Falseã€‚</span><br><span class="line"></span><br><span class="line">ä¸ºäº†ç†è§£å®ƒï¼Œæˆ‘ä»¬å°†æ‹æ‘„ä¸Šé¢çš„çŸ©å½¢å›¾åƒã€‚</span><br><span class="line"></span><br><span class="line">é¦–å…ˆï¼Œæˆ‘å‘ç°å®ƒçš„è½®å»“ä¸ºcntã€‚ç°åœ¨ï¼Œæˆ‘å‘ç°å®ƒçš„å¸¦æœ‰returnPoints &#x3D; Trueçš„å‡¸åŒ…ï¼Œ</span><br><span class="line"></span><br><span class="line">å¾—åˆ°ä»¥ä¸‹å€¼ï¼š[[[234 202]]ï¼Œ[[51 202]]ï¼Œ[[51 79]]ï¼Œ[[234 79]]]ï¼Œå®ƒä»¬æ˜¯å››ä¸ªè§’ çŸ©å½¢çš„ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">ç°åœ¨ï¼Œå¦‚æœå¯¹returnPoints &#x3D; Falseæ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œ</span><br><span class="line"></span><br><span class="line">åˆ™ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š[[129]ï¼Œ[67]ï¼Œ[0]ï¼Œ[142]]ã€‚è¿™äº›æ˜¯è½®å»“ä¸­ç›¸åº”ç‚¹çš„ç´¢å¼•ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ï¼Œæ£€æŸ¥ç¬¬ä¸€ä¸ªå€¼ï¼šcnt [129] &#x3D; [[234ï¼Œ202]]ä¸ç¬¬ä¸€ä¸ªç»“æœç›¸åŒï¼ˆå¯¹äºå…¶ä»–ç»“æœä¾æ­¤ç±»æ¨ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å½“æˆ‘ä»¬è®¨è®ºå‡¸åº¦ç¼º</span><br><span class="line"></span><br><span class="line">## 6. æ£€æŸ¥å‡¸åº¦</span><br><span class="line">cv.isContourConvex()å…·æœ‰æ£€æŸ¥æ›²çº¿æ˜¯å¦å‡¸å‡ºçš„åŠŸèƒ½ã€‚å®ƒåªæ˜¯è¿”å›Trueè¿˜æ˜¯Falseã€‚æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">k &#x3D; cv.isContourConvex(cnt) </span><br><span class="line">k</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><h2 id="7-è¾¹ç•ŒçŸ©å½¢"><a href="#7-è¾¹ç•ŒçŸ©å½¢" class="headerlink" title="7. è¾¹ç•ŒçŸ©å½¢"></a>7. è¾¹ç•ŒçŸ©å½¢</h2><p>æœ‰ä¸¤ç§ç±»å‹çš„è¾¹ç•ŒçŸ©å½¢ã€‚</p>
<h3 id="7-a-ç›´è§’çŸ©å½¢"><a href="#7-a-ç›´è§’çŸ©å½¢" class="headerlink" title="7.a.ç›´è§’çŸ©å½¢"></a>7.a.ç›´è§’çŸ©å½¢</h3><p>å®ƒæ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œä¸è€ƒè™‘ç‰©ä½“çš„æ—‹è½¬ã€‚æ‰€ä»¥è¾¹ç•ŒçŸ©å½¢çš„é¢ç§¯ä¸æ˜¯æœ€å°çš„ã€‚</p>
<p>å®ƒæ˜¯ç”±å‡½æ•°<strong>cv.boundingRect</strong>()æ‰¾åˆ°çš„ã€‚</p>
<p>ä»¤(xï¼Œy)ä¸ºçŸ©å½¢çš„å·¦ä¸Šè§’åæ ‡ï¼Œè€Œ(wï¼Œh)ä¸ºçŸ©å½¢çš„å®½åº¦å’Œé«˜åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">x,y,w,h &#x3D; cv.boundingRect(cnt)</span><br><span class="line">cv.rectangle(img,(x,y),(x+w,y+h),(0,255,0),2)</span><br></pre></td></tr></table></figure>
<h3 id="7-b-æ—‹è½¬çŸ©å½¢"><a href="#7-b-æ—‹è½¬çŸ©å½¢" class="headerlink" title="7.b. æ—‹è½¬çŸ©å½¢"></a>7.b. æ—‹è½¬çŸ©å½¢</h3><p>è¿™é‡Œï¼Œè¾¹ç•ŒçŸ©å½¢æ˜¯ç”¨æœ€å°é¢ç§¯ç»˜åˆ¶çš„ï¼Œæ‰€ä»¥å®ƒä¹Ÿè€ƒè™‘äº†æ—‹è½¬ã€‚</p>
<p>ä½¿ç”¨çš„å‡½æ•°æ˜¯<strong>cv.minAreaRect</strong>()ã€‚</p>
<p>å®ƒè¿”å›ä¸€ä¸ªBox2Dç»“æ„ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹ç»†èŠ‚ -(ä¸­å¿ƒ(x,y)ï¼Œ(å®½åº¦ï¼Œé«˜åº¦)ï¼Œæ—‹è½¬è§’åº¦)ã€‚</p>
<p>ä½†è¦ç”»å‡ºè¿™ä¸ªçŸ©å½¢ï¼Œæˆ‘ä»¬éœ€è¦çŸ©å½¢çš„å››ä¸ªè§’ã€‚</p>
<p>å®ƒç”±å‡½æ•°<strong>cv.boxPoints</strong>()è·å¾—</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rect &#x3D; cv.minAreaRect(cnt)</span><br><span class="line">box &#x3D; cv.boxPoints(rect)</span><br><span class="line">box &#x3D; np.int0(box)</span><br><span class="line">cv.drawContours(img,[box],0,(0,0,255),2)</span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªçŸ©å½¢éƒ½æ˜¾ç¤ºåœ¨ä¸€å¼ å•ç‹¬çš„å›¾åƒä¸­ã€‚ç»¿è‰²çŸ©å½¢æ˜¾ç¤ºæ­£å¸¸çš„è¾¹ç•ŒçŸ©å½¢ã€‚çº¢è‰²çŸ©å½¢æ˜¯æ—‹è½¬åçš„çŸ©å½¢ã€‚</p>
<p><img src="http://qiniu.aihubs.net/boundingrect.png" alt></p>
<h2 id="8-æœ€å°é—­åˆåœˆ"><a href="#8-æœ€å°é—­åˆåœˆ" class="headerlink" title="8. æœ€å°é—­åˆåœˆ"></a>8. æœ€å°é—­åˆåœˆ</h2><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨å‡½æ•°<em>*cv.minEnclosingCircle(</em>()æŸ¥æ‰¾å¯¹è±¡çš„åœ†å‘¨ã€‚å®ƒæ˜¯ä¸€ä¸ªä»¥æœ€å°é¢ç§¯å®Œå…¨è¦†ç›–ç‰©ä½“çš„åœ†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(x,y),radius &#x3D; cv.minEnclosingCircle(cnt)</span><br><span class="line">center &#x3D; (int(x),int(y))</span><br><span class="line">radius &#x3D; int(radius)</span><br><span class="line">cv.circle(img,center,radius,(0,255,0),2)</span><br><span class="line">&#96;&#96;&#96;                            </span><br><span class="line">![](http:&#x2F;&#x2F;qiniu.aihubs.net&#x2F;circumcircle.png)</span><br><span class="line"></span><br><span class="line">## 9. æ‹Ÿåˆä¸€ä¸ªæ¤­åœ†</span><br><span class="line">ä¸‹ä¸€ä¸ªæ˜¯æŠŠä¸€ä¸ªæ¤­åœ†æ‹Ÿåˆåˆ°ä¸€ä¸ªç‰©ä½“ä¸Šã€‚å®ƒè¿”å›å†…æ¥æ¤­åœ†çš„æ—‹è½¬çŸ©å½¢ã€‚</span><br></pre></td></tr></table></figure>
<p>ellipse = cv.fitEllipse(cnt)<br>cv.ellipse(img,ellipse,(0,255,0),2)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">![](http:&#x2F;&#x2F;qiniu.aihubs.net&#x2F;fitellipse.png)</span><br><span class="line"></span><br><span class="line">## 10. æ‹Ÿåˆç›´çº¿</span><br><span class="line">åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€æ¡ç›´çº¿æ‹Ÿåˆåˆ°ä¸€ç»„ç‚¹ã€‚ä¸‹å›¾åŒ…å«ä¸€ç»„ç™½ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥è¿‘ä¼¼ä¸€æ¡ç›´çº¿ã€‚</span><br></pre></td></tr></table></figure>
<p>rows,cols = img.shape[:2]<br>[vx,vy,x,y] = cv.fitLine(cnt, cv.DIST_L2,0,0.01,0.01)<br>lefty = int((-x<em>vy/vx) + y)<br>righty = int(((cols-x)</em>vy/vx)+y)<br>cv.line(img,(cols-1,righty),(0,lefty),(0,255,0),2)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"># &lt;span id&#x3D;&quot;header3&quot;&gt;è½®å»“å±æ€§&lt;&#x2F;span&gt;</span><br><span class="line">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å­¦ä¹ æå–ä¸€äº›å¸¸ç”¨çš„ç‰©ä½“å±æ€§ï¼Œ</span><br><span class="line"></span><br><span class="line">å¦‚åšå®åº¦ï¼Œç­‰æ•ˆç›´å¾„ï¼Œæ©æ¨¡å›¾åƒï¼Œå¹³å‡å¼ºåº¦ç­‰ã€‚æ›´å¤šçš„åŠŸèƒ½å¯ä»¥åœ¨Matlab regionpropsæ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚</span><br><span class="line"></span><br><span class="line">(æ³¨:è´¨å¿ƒã€é¢ç§¯ã€å‘¨é•¿ç­‰ä¹Ÿå±äºè¿™ä¸€ç±»ï¼Œä½†æˆ‘ä»¬åœ¨ä¸Šä¸€ç« å·²ç»è§è¿‡)</span><br><span class="line"></span><br><span class="line">## 1. é•¿å®½æ¯”</span><br><span class="line">å®ƒæ˜¯å¯¹è±¡è¾¹ç•ŒçŸ©å½¢çš„å®½åº¦ä¸é«˜åº¦çš„æ¯”å€¼ã€‚</span><br><span class="line"></span><br><span class="line">Aspect Ratio&#x3D;$\frac&#123;Width&#125;&#123;Height&#125;$</span><br></pre></td></tr></table></figure>
<p>x,y,w,h = cv.boundingRect(cnt)<br>aspect_ratio = float(w)/h</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## 2. èŒƒå›´</span><br><span class="line">èŒƒå›´æ˜¯è½®å»“åŒºåŸŸä¸è¾¹ç•ŒçŸ©å½¢åŒºåŸŸçš„æ¯”å€¼ã€‚</span><br><span class="line"></span><br><span class="line">Extent&#x3D;$\frac&#123;Object Area&#125;&#123;Bounding Rectangle Area&#125;$</span><br></pre></td></tr></table></figure>
<p>area = cv.contourArea(cnt)<br>x,y,w,h = cv.boundingRect(cnt)<br>rect_area = w*h<br>extent = float(area)/rect_area</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## 3. åšå®åº¦</span><br><span class="line">åšå®åº¦æ˜¯ç­‰é«˜çº¿é¢ç§¯ä¸å…¶å‡¸åŒ…é¢ç§¯ä¹‹æ¯”ã€‚</span><br><span class="line"></span><br><span class="line">Solidity&#x3D;$\frac&#123;Contour Area&#125;&#123;ConvexHull Area&#125;$</span><br></pre></td></tr></table></figure>
<p>area = cv.contourArea(cnt)<br>hull = cv.convexHull(cnt)<br>hull_area = cv.contourArea(hull)<br>solidity = float(area)/hull_area</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## 4. ç­‰æ•ˆç›´å¾„</span><br><span class="line">ç­‰æ•ˆç›´å¾„æ˜¯é¢ç§¯ä¸è½®å»“é¢ç§¯ç›¸åŒçš„åœ†çš„ç›´å¾„ã€‚</span><br><span class="line"></span><br><span class="line">EquivalentDiameter&#x3D;$\sqrt&#123;\frac&#123;4Ã—ContourArea&#125;&#123;\Pi&#125;&#125;$</span><br></pre></td></tr></table></figure>
<p>area = cv.contourArea(cnt)<br>equi_diameter = np.sqrt(4*area/np.pi)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## 5. å–å‘</span><br><span class="line">å–å‘æ˜¯ç‰©ä½“æŒ‡å‘çš„è§’åº¦ã€‚ä»¥ä¸‹æ–¹æ³•è¿˜ç»™å‡ºäº†ä¸»è½´å’Œå‰¯è½´çš„é•¿åº¦ã€‚</span><br></pre></td></tr></table></figure>
<p>(x,y),(MA,ma),angle = cv.fitEllipse(cnt)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## 6. æ©ç å’Œåƒç´ ç‚¹</span><br><span class="line">åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ„æˆè¯¥å¯¹è±¡çš„æ‰€æœ‰ç‚¹ã€‚å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®Œæˆï¼š</span><br></pre></td></tr></table></figure>
<p>mask = np.zeros(imgray.shape,np.uint8)<br>cv.drawContours(mask,[cnt],0,255,-1)<br>pixelpoints = np.transpose(np.nonzero(mask))<br>#pixelpoints = cv.findNonZero(mask)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¿™é‡Œæä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªä½¿ç”¨Numpyå‡½æ•°ï¼Œå¦ä¸€ä¸ªä½¿ç”¨OpenCVå‡½æ•°(æœ€åçš„æ³¨é‡Šè¡Œ)ã€‚ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç•¥æœ‰ä¸åŒã€‚</span><br><span class="line"></span><br><span class="line">Numpyç»™å‡ºçš„åæ ‡æ˜¯(è¡Œã€åˆ—)æ ¼å¼ï¼Œ</span><br><span class="line"></span><br><span class="line">è€ŒOpenCVç»™å‡ºçš„åæ ‡æ˜¯(x,y)æ ¼å¼ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šç­”æ¡ˆæ˜¯å¯ä»¥äº’æ¢çš„ã€‚æ³¨æ„ï¼Œrow &#x3D; x, column &#x3D; yã€‚</span><br><span class="line"></span><br><span class="line">## 7. æœ€å¤§å€¼ï¼Œæœ€å°å€¼å’Œå®ƒä»¬çš„ä½ç½®</span><br><span class="line">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ©ç å›¾åƒæ‰¾åˆ°è¿™äº›å‚æ•°ã€‚</span><br></pre></td></tr></table></figure>
<p>min_val, max_val, min_loc, max_loc = cv.minMaxLoc(imgray,mask = mask)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 8. å¹³å‡é¢œè‰²æˆ–å¹³å‡å¼ºåº¦</span><br><span class="line">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¯¹è±¡çš„å¹³å‡é¢œè‰²ã€‚æˆ–è€…å¯ä»¥æ˜¯ç°åº¦æ¨¡å¼ä¸‹ç‰©ä½“çš„å¹³å‡å¼ºåº¦ã€‚æˆ‘ä»¬å†æ¬¡ä½¿ç”¨ç›¸åŒçš„æ©ç è¿›è¡Œæ­¤æ“ä½œã€‚</span><br></pre></td></tr></table></figure>
<p>mean_val = cv.mean(im,mask = mask)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 9. æç«¯ç‚¹</span><br><span class="line">æç‚¹æ˜¯æŒ‡å¯¹è±¡çš„æœ€é¡¶éƒ¨ï¼Œæœ€åº•éƒ¨ï¼Œæœ€å³ä¾§å’Œæœ€å·¦ä¾§çš„ç‚¹ã€‚</span><br></pre></td></tr></table></figure>
<p>leftmost = tuple(cnt[cnt[:,:,0].argmin()][0])<br>rightmost = tuple(cnt[cnt[:,:,0].argmax()][0])<br>topmost = tuple(cnt[cnt[:,:,1].argmin()][0])<br>bottommost = tuple(cnt[cnt[:,:,1].argmax()][0])</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘å°†å…¶åº”ç”¨äºå°åº¦åœ°å›¾ï¼Œåˆ™ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</span><br><span class="line">![](http:&#x2F;&#x2F;qiniu.aihubs.net&#x2F;extremepoints.jpg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br></pre></td></tr></table></figure>


<h1 id="è½®å»“ï¼šæ›´å¤šå±æ€§"><a href="#è½®å»“ï¼šæ›´å¤šå±æ€§" class="headerlink" title="è½®å»“ï¼šæ›´å¤šå±æ€§"></a><span id="header4">è½®å»“ï¼šæ›´å¤šå±æ€§</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  - å‡¸æ€§ç¼ºé™·ä»¥åŠå¦‚ä½•æ‰¾åˆ°å®ƒä»¬ - æŸ¥æ‰¾ç‚¹åˆ°å¤šè¾¹å½¢çš„æœ€çŸ­è·ç¦» - åŒ¹é…ä¸åŒçš„å½¢çŠ¶</p>
<h2 id="ç†è®ºå’Œä»£ç "><a href="#ç†è®ºå’Œä»£ç " class="headerlink" title="ç†è®ºå’Œä»£ç "></a>ç†è®ºå’Œä»£ç </h2><h3 id="1-å‡¸æ€§ç¼ºé™·"><a href="#1-å‡¸æ€§ç¼ºé™·" class="headerlink" title="1. å‡¸æ€§ç¼ºé™·"></a>1. å‡¸æ€§ç¼ºé™·</h3><p>æˆ‘ä»¬çœ‹åˆ°äº†å…³äºè½®å»“çš„ç¬¬äºŒç« çš„å‡¸åŒ…ã€‚ä»è¿™ä¸ªå‡¸åŒ…ä¸Šçš„ä»»ä½•åå·®éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯å‡¸æ€§ç¼ºé™·ã€‚ OpenCVæœ‰ä¸€ä¸ªå‡½æ•°æ¥æ‰¾åˆ°è¿™ä¸ª,cv.convexityDefects()ã€‚ä¸€ä¸ªåŸºæœ¬çš„å‡½æ•°è°ƒç”¨å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hull &#x3D; cv.convexHull(cnt,returnPoints &#x3D; False)</span><br><span class="line">defects &#x3D; cv.convexityDefects(cnt,hull)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ è®°ä½,æˆ‘ä»¬å¿…é¡»åœ¨å‘ç°å‡¸åŒ…æ—¶,ä¼ é€’returnPoints= False,ä»¥æ‰¾åˆ°å‡¸æ€§ç¼ºé™·ã€‚</p>
<p>å®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ¯è¡ŒåŒ…å«è¿™äº›å€¼â€”[èµ·ç‚¹ã€ç»ˆç‚¹ã€æœ€è¿œç‚¹ã€åˆ°æœ€è¿œç‚¹çš„è¿‘ä¼¼è·ç¦»]ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å›¾åƒæŠŠå®ƒå½¢è±¡åŒ–ã€‚æˆ‘ä»¬ç”»ä¸€æ¡è¿æ¥èµ·ç‚¹å’Œç»ˆç‚¹çš„çº¿ï¼Œç„¶ååœ¨æœ€è¿œå¤„ç”»ä¸€ä¸ªåœ†ã€‚è®°ä½ï¼Œè¿”å›çš„å‰ä¸‰ä¸ªå€¼æ˜¯cntçš„ç´¢å¼•ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä»cntä¸­è·å–è¿™äº›å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import cv2 as cv</span><br><span class="line">import numpy as np</span><br><span class="line">img &#x3D; cv.imread(&#39;star.jpg&#39;)</span><br><span class="line">img_gray &#x3D; cv.cvtColor(img,cv.COLOR_BGR2GRAY)</span><br><span class="line">ret,thresh &#x3D; cv.threshold(img_gray, 127, 255,0)</span><br><span class="line">contours,hierarchy &#x3D; cv.findContours(thresh,2,1)</span><br><span class="line">cnt &#x3D; contours[0]</span><br><span class="line">hull &#x3D; cv.convexHull(cnt,returnPoints &#x3D; False)</span><br><span class="line">defects &#x3D; cv.convexityDefects(cnt,hull)</span><br><span class="line">for i in range(defects.shape[0]):</span><br><span class="line">    s,e,f,d &#x3D; defects[i,0]</span><br><span class="line">    start &#x3D; tuple(cnt[s][0])</span><br><span class="line">    end &#x3D; tuple(cnt[e][0])</span><br><span class="line">    far &#x3D; tuple(cnt[f][0])</span><br><span class="line">    cv.line(img,start,end,[0,255,0],2)</span><br><span class="line">    cv.circle(img,far,5,[0,0,255],-1)</span><br><span class="line">cv.imshow(&#39;img&#39;,img)</span><br><span class="line">cv.waitKey(0)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç»“æœï¼š<br><img src="http://qiniu.aihubs.net/defects.jpg" alt></p>
<h3 id="2-ç‚¹å¤šè¾¹å½¢æµ‹è¯•"><a href="#2-ç‚¹å¤šè¾¹å½¢æµ‹è¯•" class="headerlink" title="2. ç‚¹å¤šè¾¹å½¢æµ‹è¯•"></a>2. ç‚¹å¤šè¾¹å½¢æµ‹è¯•</h3><p>è¿™ä¸ªå‡½æ•°æ‰¾å‡ºå›¾åƒä¸­ä¸€ç‚¹åˆ°è½®å»“çº¿çš„æœ€çŸ­è·ç¦»ã€‚å®ƒè¿”å›çš„è·ç¦»ï¼Œç‚¹åœ¨è½®å»“çº¿å¤–æ—¶ä¸ºè´Ÿï¼Œç‚¹åœ¨è½®å»“çº¿å†…æ—¶ä¸ºæ­£ï¼Œç‚¹åœ¨è½®å»“çº¿ä¸Šæ—¶ä¸ºé›¶ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ç‚¹(50,50)å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dist &#x3D; cv.pointPolygonTest(cnt,(50,50),True)</span><br></pre></td></tr></table></figure>
<p>åœ¨å‡½æ•°ä¸­ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯measureDistã€‚å¦‚æœå®ƒæ˜¯çœŸçš„ï¼Œå®ƒä¼šæ‰¾åˆ°æœ‰ç¬¦å·çš„è·ç¦»ã€‚å¦‚æœä¸ºå‡ï¼Œåˆ™æŸ¥æ‰¾è¯¥ç‚¹æ˜¯åœ¨è½®å»“çº¿å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨(åˆ†åˆ«è¿”å›+1ã€-1å’Œ0)ã€‚</p>
<p>æ³¨æ„ å¦‚æœæ‚¨ä¸æƒ³æ‰¾åˆ°è·ç¦»ï¼Œè¯·ç¡®ä¿ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºFalseï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªè€—æ—¶çš„è¿‡ç¨‹ã€‚å› æ­¤ï¼Œå°†å…¶è®¾ç½®ä¸ºFalseå¯ä½¿é€Ÿåº¦æé«˜2-3å€ã€‚</p>
<h3 id="3-å½¢çŠ¶åŒ¹é…"><a href="#3-å½¢çŠ¶åŒ¹é…" class="headerlink" title="3. å½¢çŠ¶åŒ¹é…"></a>3. å½¢çŠ¶åŒ¹é…</h3><p>OpenCVé™„å¸¦ä¸€ä¸ªå‡½æ•°<strong>cv.matchShapes</strong>()ï¼Œè¯¥å‡½æ•°ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ¯”è¾ƒä¸¤ä¸ªå½¢çŠ¶æˆ–ä¸¤ä¸ªè½®å»“ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ˜¾ç¤ºç›¸ä¼¼æ€§çš„åº¦é‡ã€‚ç»“æœè¶Šä½ï¼ŒåŒ¹é…è¶Šå¥½ã€‚å®ƒæ˜¯æ ¹æ®çŸ©å€¼è®¡ç®—å‡ºæ¥çš„ã€‚ä¸åŒçš„æµ‹é‡æ–¹æ³•åœ¨æ–‡æ¡£ä¸­æœ‰è§£é‡Šã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import cv2 as cv</span><br><span class="line">import numpy as np</span><br><span class="line">img1 &#x3D; cv.imread(&#39;star.jpg&#39;,0)</span><br><span class="line">img2 &#x3D; cv.imread(&#39;star2.jpg&#39;,0)</span><br><span class="line">ret, thresh &#x3D; cv.threshold(img1, 127, 255,0)</span><br><span class="line">ret, thresh2 &#x3D; cv.threshold(img2, 127, 255,0)</span><br><span class="line">contours,hierarchy &#x3D; cv.findContours(thresh,2,1)</span><br><span class="line">cnt1 &#x3D; contours[0]</span><br><span class="line">contours,hierarchy &#x3D; cv.findContours(thresh2,2,1)</span><br><span class="line">cnt2 &#x3D; contours[0]</span><br><span class="line">ret &#x3D; cv.matchShapes(cnt1,cnt2,1,0.0)</span><br><span class="line">print( ret )</span><br></pre></td></tr></table></figure>
<p>æˆ‘å°è¯•è¿‡åŒ¹é…ä¸‹é¢ç»™å‡ºçš„ä¸åŒå½¢çŠ¶çš„å½¢çŠ¶ï¼š<br><img src="http://qiniu.aihubs.net/matchshapes.jpg" alt></p>
<p>æˆ‘å¾—åˆ°ä»¥ä¸‹ç»“æœ: - åŒ¹é…çš„å›¾åƒAä¸æœ¬èº«= 0.0 - åŒ¹é…å›¾åƒAä¸å›¾åƒB = 0.001946 - åŒ¹é…å›¾åƒAä¸å›¾åƒC = 0.326911</p>
<p>çœ‹,å³ä½¿æ˜¯å›¾åƒæ—‹è½¬ä¹Ÿä¸ä¼šå¯¹è¿™ä¸ªæ¯”è¾ƒäº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚</p>
<p>å‚è€ƒ HuçŸ©æ˜¯å¹³ç§»ã€æ—‹è½¬å’Œæ¯”ä¾‹ä¸å˜çš„ä¸ƒä¸ªçŸ©ã€‚ç¬¬ä¸ƒä¸ªæ˜¯æ— åæ–œé‡ã€‚è¿™äº›å€¼å¯ä»¥ä½¿ç”¨<strong>cpu.HuMoments</strong>()å‡½æ•°æ‰¾åˆ°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="è½®å»“åˆ†å±‚"><a href="#è½®å»“åˆ†å±‚" class="headerlink" title="è½®å»“åˆ†å±‚"></a><span id="header5">è½®å»“åˆ†å±‚</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>è¿™æ¬¡æˆ‘ä»¬å­¦ä¹ è½®å»“çš„å±‚æ¬¡ï¼Œå³è½®å»“ä¸­çš„çˆ¶å­å…³ç³»ã€‚</p>
<h2 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>åœ¨å‰å‡ ç¯‡å…³äºè½®å»“çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†ä¸OpenCVæä¾›çš„è½®å»“ç›¸å…³çš„å‡ ä¸ªå‡½æ•°ã€‚</p>
<p>ä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨<strong>cv.findcontour</strong>()å‡½æ•°åœ¨å›¾åƒä¸­æ‰¾åˆ°è½®å»“æ—¶ï¼Œæˆ‘ä»¬å·²ç»ä¼ é€’äº†ä¸€ä¸ªå‚æ•°ï¼Œè½®å»“æ£€ç´¢æ¨¡å¼ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸é€šè¿‡äº†<strong>cv.RETR_LIST</strong>æˆ–<strong>cv.RETR_TREE</strong>ï¼Œæ•ˆæœå¾ˆå¥½ã€‚ä½†è¿™åˆ°åº•æ„å‘³ç€ä»€ä¹ˆå‘¢?</p>
<p>å¦å¤–ï¼Œåœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸‰ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªæ˜¯å›¾åƒï¼Œç¬¬äºŒä¸ªæ˜¯è½®å»“ï¼Œè¿˜æœ‰ä¸€ä¸ªæˆ‘ä»¬å‘½åä¸º<strong>hierarchy</strong>çš„è¾“å‡º(è¯·æ£€æŸ¥å‰é¢æ–‡ç« ä¸­çš„ä»£ç )ã€‚</p>
<p>ä½†æˆ‘ä»¬ä»æœªåœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿‡è¿™ç§å±‚æ¬¡ç»“æ„ã€‚é‚£ä¹ˆè¿™ä¸ªå±‚çº§æ˜¯ä»€ä¹ˆ?å®ƒæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„?å®ƒä¸å‰é¢æåˆ°çš„å‡½æ•°å‚æ•°æœ‰ä»€ä¹ˆå…³ç³»?</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­è¦è®¨è®ºçš„å†…å®¹ã€‚</p>
<h2 id="å±‚æ¬¡ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#å±‚æ¬¡ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å±‚æ¬¡ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>å±‚æ¬¡ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨<strong>cv.findcontour</strong>()å‡½æ•°æ¥æ£€æµ‹å›¾åƒä¸­çš„å¯¹è±¡ï¼Œå¯¹å§ï¼Ÿ</p>
<p>æœ‰æ—¶å¯¹è±¡åœ¨ä¸åŒçš„ä½ç½®ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŸäº›å½¢çŠ¶åœ¨å…¶ä»–å½¢çŠ¶ä¸­ã€‚</p>
<p>å°±åƒåµŒå¥—çš„å›¾å½¢ä¸€æ ·ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æŠŠå¤–éƒ¨çš„ç§°ä¸º<strong>çˆ¶ç±»</strong>ï¼ŒæŠŠå†…éƒ¨çš„ç§°ä¸º<strong>å­ç±»</strong>ã€‚</p>
<p>è¿™æ ·ï¼Œå›¾åƒä¸­çš„è½®å»“å°±æœ‰äº†ä¸€å®šçš„ç›¸äº’å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªè½®å»“æ˜¯å¦‚ä½•ç›¸äº’è¿æ¥çš„ï¼Œæ¯”å¦‚ï¼Œå®ƒæ˜¯å¦ä¸€ä¸ªè½®å»“çš„å­è½®å»“ï¼Œè¿˜æ˜¯çˆ¶è½®å»“ç­‰ç­‰ã€‚è¿™ç§å…³ç³»çš„è¡¨ç¤ºç§°ä¸º<strong>å±‚æ¬¡ç»“æ„</strong>ã€‚</p>
<p><img src="http://qiniu.aihubs.net/hierarchy.png" alt><br>åœ¨è¿™å¼ å›¾ä¸­ï¼Œæœ‰ä¸€äº›å½¢çŠ¶æˆ‘å·²ç»ä»<strong>0-5</strong>å¼€å§‹ç¼–å·ã€‚<em>2</em>å’Œ<em>2a</em>è¡¨ç¤ºæœ€å¤–å±‚ç›’å­çš„å¤–éƒ¨å’Œå†…éƒ¨è½®å»“ã€‚</p>
<p>è¿™é‡Œï¼Œç­‰é«˜çº¿0,1,2åœ¨<strong>å¤–éƒ¨æˆ–æœ€å¤–é¢</strong>ã€‚æˆ‘ä»¬å¯ä»¥è¯´ï¼Œå®ƒä»¬åœ¨<strong>å±‚çº§-0</strong>ä¸­ï¼Œæˆ–è€…ç®€å•åœ°è¯´ï¼Œå®ƒä»¬åœ¨<strong>åŒä¸€ä¸ªå±‚çº§</strong>ä¸­ã€‚</p>
<p>å…¶æ¬¡æ˜¯<strong>contour-2a</strong>ã€‚å®ƒå¯ä»¥è¢«è®¤ä¸ºæ˜¯<strong>contour-2çš„å­çº§</strong>(æˆ–è€…åè¿‡æ¥ï¼Œcontour-2æ˜¯contour-2açš„çˆ¶çº§)ã€‚</p>
<p>å‡è®¾å®ƒåœ¨<strong>å±‚çº§-1</strong>ä¸­ã€‚ç±»ä¼¼åœ°ï¼Œcontour-3æ˜¯contour-2çš„å­çº§ï¼Œå®ƒä½äºä¸‹ä¸€ä¸ªå±‚æ¬¡ç»“æ„ä¸­ã€‚</p>
<p>æœ€åï¼Œè½®å»“4,5æ˜¯contour-3açš„å­çº§ï¼Œä»–ä»¬åœ¨æœ€åä¸€ä¸ªå±‚çº§ã€‚</p>
<p>ä»å¯¹æ–¹æ¡†çš„ç¼–å·æ¥çœ‹ï¼Œæˆ‘è®¤ä¸ºcontour-4æ˜¯contour-3açš„ç¬¬ä¸€ä¸ªå­çº§(å®ƒä¹Ÿå¯ä»¥æ˜¯contour-5)ã€‚</p>
<p>æˆ‘æåˆ°è¿™äº›æ˜¯ä¸ºäº†ç†è§£ä¸€äº›æœ¯è¯­ï¼Œæ¯”å¦‚<strong>ç›¸åŒå±‚çº§</strong>ï¼Œå¤–éƒ¨è½®å»“ï¼Œå­è½®å»“ï¼Œçˆ¶è½®å»“ï¼Œ<strong>ç¬¬ä¸€ä¸ªå­è½®å»“</strong>ç­‰ç­‰ã€‚ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥OpenCVã€‚</p>
<h2 id="OpenCVä¸­çš„åˆ†çº§è¡¨ç¤º"><a href="#OpenCVä¸­çš„åˆ†çº§è¡¨ç¤º" class="headerlink" title="OpenCVä¸­çš„åˆ†çº§è¡¨ç¤º"></a>OpenCVä¸­çš„åˆ†çº§è¡¨ç¤º</h2><p>æ‰€ä»¥æ¯ä¸ªè½®å»“éƒ½æœ‰å®ƒè‡ªå·±çš„ä¿¡æ¯å…³äºå®ƒæ˜¯ä»€ä¹ˆå±‚æ¬¡ï¼Œè°æ˜¯å®ƒçš„å­©å­ï¼Œè°æ˜¯å®ƒçš„çˆ¶æ¯ç­‰ç­‰ã€‚</p>
<p>OpenCVå°†å®ƒè¡¨ç¤ºä¸ºä¸€ä¸ªåŒ…å«å››ä¸ªå€¼çš„æ•°ç»„:[Next, Previous, First_Child, Parent]</p>
<p>â€œNextè¡¨ç¤ºåŒä¸€å±‚æ¬¡çš„ä¸‹ä¸€ä¸ªè½®å»“ã€‚â€</p>
<p>ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„å›¾ç‰‡ä¸­å–contour-0ã€‚è°æ˜¯ä¸‹ä¸€ä¸ªåŒçº§åˆ«çš„ç­‰é«˜çº¿?è¿™æ˜¯contour-1ã€‚</p>
<p>ç®€å•åœ°ä»¤Next = 1ã€‚ç±»ä¼¼åœ°ï¼ŒContour-1ä¹Ÿæ˜¯contour-2ã€‚æ‰€ä»¥Next = 2ã€‚ contour-2å‘¢?åŒä¸€æ°´å¹³çº¿ä¸Šæ²¡æœ‰ä¸‹ä¸€æ¡ç­‰é«˜çº¿ã€‚</p>
<p>ç®€å•åœ°ï¼Œè®©Next = -1ã€‚contour-4å‘¢?å®ƒä¸contour-5å¤„äºåŒä¸€çº§åˆ«ã€‚å®ƒçš„ä¸‹ä¸€æ¡ç­‰é«˜çº¿æ˜¯contour-5ï¼Œæ‰€ä»¥next = 5ã€‚</p>
<p>â€œPreviousè¡¨ç¤ºåŒä¸€å±‚æ¬¡ä¸Šçš„å…ˆå‰è½®å»“ã€‚â€</p>
<p>å’Œä¸Šé¢ä¸€æ ·ã€‚contour-1ä¹‹å‰çš„ç­‰å€¼çº¿ä¸ºåŒçº§åˆ«çš„contour-0ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œcontour-2ä¹Ÿæ˜¯contour-1ã€‚å¯¹äºcontour-0ï¼Œæ²¡æœ‰å‰é¡¹ï¼Œæ‰€ä»¥è®¾ä¸º-1ã€‚</p>
<p>â€œFirst_Childè¡¨ç¤ºå®ƒçš„ç¬¬ä¸€ä¸ªå­è½®å»“ã€‚â€</p>
<p>æ²¡æœ‰å¿…è¦ä½œä»»ä½•è§£é‡Šã€‚å¯¹äºcontour-2, childæ˜¯contour-2aã€‚ä»è€Œå¾—åˆ°contour-2aå¯¹åº”çš„æŒ‡æ ‡å€¼ã€‚</p>
<p>contour-3aå‘¢?å®ƒæœ‰ä¸¤ä¸ªå­©å­ã€‚ä½†æˆ‘ä»¬åªå…³æ³¨ç¬¬ä¸€ä¸ªå­©å­ã€‚å®ƒæ˜¯contour-4ã€‚é‚£ä¹ˆFirst_Child = 4 å¯¹contour-3aè€Œè¨€ã€‚</p>
<p>â€œParentè¡¨ç¤ºå…¶çˆ¶è½®å»“çš„ç´¢å¼•ã€‚â€</p>
<p>å®ƒä¸<strong>First_Child</strong>ç›¸åã€‚å¯¹äºè½®å»“çº¿-4å’Œè½®å»“çº¿-5ï¼Œçˆ¶è½®å»“çº¿éƒ½æ˜¯è½®å»“çº¿-3aã€‚å¯¹äºè½®å»“3aï¼Œå®ƒæ˜¯è½®å»“-3ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>æ³¨æ„ å¦‚æœæ²¡æœ‰å­å…ƒç´ æˆ–çˆ¶å…ƒç´ ï¼Œåˆ™è¯¥å­—æ®µè¢«è§†ä¸º-1</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†OpenCVä¸­ä½¿ç”¨çš„å±‚æ¬¡æ ·å¼ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸Šé¢ç»™å‡ºçš„ç›¸åŒå›¾åƒæ¥æ£€æŸ¥OpenCVä¸­çš„è½®å»“æ£€ç´¢æ¨¡å¼ã€‚</p>
<p>ä¸€äº›æ ‡å¿—å¦‚ cv.RETR_LIST, cv.RETR_TREE,cv.RETR_CCOMP, <strong>cv.RETR_EXTERNAL</strong>ç­‰ç­‰çš„å«ä¹‰ã€‚</p>
<h2 id="è½®å»“æ£€ç´¢æ¨¡å¼"><a href="#è½®å»“æ£€ç´¢æ¨¡å¼" class="headerlink" title="è½®å»“æ£€ç´¢æ¨¡å¼"></a>è½®å»“æ£€ç´¢æ¨¡å¼</h2><h3 id="1-RETR-LIST"><a href="#1-RETR-LIST" class="headerlink" title="1. RETR_LIST"></a>1. RETR_LIST</h3><p>è¿™æ˜¯å››ä¸ªæ ‡å¿—ä¸­æœ€ç®€å•çš„ä¸€ä¸ª(ä»è§£é‡Šçš„è§’åº¦æ¥çœ‹)ã€‚å®ƒåªæ˜¯æ£€ç´¢æ‰€æœ‰çš„è½®å»“ï¼Œä½†ä¸åˆ›å»ºä»»ä½•äº²å­å…³ç³»ã€‚</p>
<p>åœ¨è¿™ä¸ªè§„åˆ™ä¸‹ï¼Œçˆ¶è½®å»“å’Œå­è½®å»“æ˜¯å¹³ç­‰çš„ï¼Œä»–ä»¬åªæ˜¯è½®å»“ã€‚ä»–ä»¬éƒ½å±äºåŒä¸€å±‚çº§ã€‚</p>
<p>è¿™é‡Œï¼Œç¬¬3å’Œç¬¬4é¡¹æ€»æ˜¯-1ã€‚ä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œä¸‹ä¸€é¡¹å’Œä¸Šä¸€é¡¹éƒ½æœ‰å¯¹åº”çš„å€¼ã€‚ä½ è‡ªå·±æ£€æŸ¥ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘å¾—åˆ°çš„ç»“æœï¼Œæ¯ä¸€è¡Œæ˜¯å¯¹åº”è½®å»“çš„å±‚æ¬¡ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€è¡Œå¯¹åº”äºè½®å»“0ã€‚ä¸‹ä¸€æ¡è½®å»“æ˜¯è½®å»“1ã€‚æ‰€ä»¥Next = 1ã€‚</p>
<p>æ²¡æœ‰å…ˆå‰çš„è½®å»“ï¼Œæ‰€ä»¥Previous=-1ã€‚å‰©ä¸‹çš„ä¸¤ä¸ªï¼Œå¦‚å‰æ‰€è¿°ï¼Œæ˜¯-1ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; hierarchy</span><br><span class="line">array([[[ 1, -1, -1, -1],</span><br><span class="line">        [ 2,  0, -1, -1],</span><br><span class="line">        [ 3,  1, -1, -1],</span><br><span class="line">        [ 4,  2, -1, -1],</span><br><span class="line">        [ 5,  3, -1, -1],</span><br><span class="line">        [ 6,  4, -1, -1],</span><br><span class="line">        [ 7,  5, -1, -1],</span><br><span class="line">        [-1,  6, -1, -1]]])</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨ä»»ä½•å±‚æ¬¡ç»“æ„ç‰¹æ€§ï¼Œé‚£ä¹ˆè¿™æ˜¯åœ¨æ‚¨çš„ä»£ç ä¸­ä½¿ç”¨çš„æœ€ä½³é€‰æ‹©ã€‚</p>
<h3 id="2-RETR-EXTERNAL"><a href="#2-RETR-EXTERNAL" class="headerlink" title="2. RETR_EXTERNAL"></a>2. RETR_EXTERNAL</h3><p>å¦‚æœä½¿ç”¨æ­¤æ ‡å¿—ï¼Œå®ƒåªè¿”å›æç«¯å¤–éƒ¨æ ‡å¿—ã€‚æ‰€æœ‰å­©å­çš„è½®å»“éƒ½è¢«ç•™ä¸‹äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è¯´ï¼Œæ ¹æ®è¿™é¡¹è§„åˆ™ï¼Œæ¯ä¸ªå®¶åº­åªæœ‰é•¿å­å¾—åˆ°å…³æ³¨ã€‚å®ƒä¸å…³å¿ƒå®¶åº­çš„å…¶ä»–æˆå‘˜:)ã€‚</p>
<p>æ‰€ä»¥åœ¨æˆ‘ä»¬çš„å›¾åƒä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæç«¯çš„å¤–è½®å»“?åœ¨ç­‰çº§0çº§?æœ‰3ä¸ªï¼Œå³ç­‰å€¼çº¿æ˜¯0 1 2ï¼Œå¯¹å§?</p>
<p>ç°åœ¨è¯•ç€ç”¨è¿™ä¸ªæ ‡å¿—æ‰¾å‡ºç­‰é«˜çº¿ã€‚è¿™é‡Œï¼Œç»™æ¯ä¸ªå…ƒç´ çš„å€¼ä¸ä¸Šé¢ç›¸åŒã€‚å¹¶ä¸ä¸Šè¿°ç»“æœè¿›è¡Œäº†æ¯”è¾ƒã€‚ä»¥ä¸‹æ˜¯æˆ‘å¾—åˆ°çš„:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; hierarchy</span><br><span class="line">array([[[ 1, -1, -1, -1],</span><br><span class="line">        [ 2,  0, -1, -1],</span><br><span class="line">        [-1,  1, -1, -1]]])</span><br></pre></td></tr></table></figure>
<p>å¦‚æœåªæƒ³æå–å¤–éƒ¨è½®å»“ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ ‡å¿—ã€‚å®ƒåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æœ‰ç”¨ã€‚</p>
<h3 id="3-RETR-CCOMP"><a href="#3-RETR-CCOMP" class="headerlink" title="3. RETR_CCOMP"></a>3. RETR_CCOMP</h3><p>æ­¤æ ‡å¿—æ£€ç´¢æ‰€æœ‰è½®å»“å¹¶å°†å…¶æ’åˆ—ä¸º2çº§å±‚æ¬¡ç»“æ„ã€‚ç‰©ä½“çš„å¤–éƒ¨è½®å»“(å³ç‰©ä½“çš„è¾¹ç•Œ)æ”¾åœ¨å±‚æ¬¡ç»“æ„-1ä¸­ã€‚</p>
<p>å¯¹è±¡å†…éƒ¨å­”æ´çš„è½®å»“(å¦‚æœæœ‰)æ”¾åœ¨å±‚æ¬¡ç»“æ„-2ä¸­ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•å¯¹è±¡ï¼Œåˆ™å…¶è½®å»“ä»…åœ¨å±‚æ¬¡ç»“æ„1ä¸­é‡æ–°æ”¾ç½®ã€‚ä»¥åŠå®ƒåœ¨å±‚çº§2ä¸­çš„æ¼æ´ç­‰ç­‰ã€‚</p>
<p>åªéœ€è€ƒè™‘åœ¨é»‘è‰²èƒŒæ™¯ä¸Šçš„â€œç™½è‰²çš„é›¶â€å›¾åƒã€‚é›¶çš„å¤–åœ†å±äºç¬¬ä¸€çº§ï¼Œé›¶çš„å†…åœ†å±äºç¬¬äºŒçº§ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„å›¾åƒæ¥è§£é‡Šå®ƒã€‚è¿™é‡Œæˆ‘ç”¨çº¢è‰²æ ‡æ³¨äº†ç­‰é«˜çº¿çš„é¡ºåºå’Œå®ƒä»¬æ‰€å±çš„å±‚æ¬¡ï¼Œç”¨ç»¿è‰²æ ‡æ³¨(1æˆ–2)ï¼Œé¡ºåºä¸OpenCVæ£€æµ‹ç­‰é«˜çº¿çš„é¡ºåºç›¸åŒã€‚<br><img src="http://qiniu.aihubs.net/ccomp_hierarchy.png" alt><br>è€ƒè™‘ç¬¬ä¸€ä¸ªè½®å»“ï¼Œå³contour-0ã€‚è¿™æ˜¯hierarchy-1ã€‚å®ƒæœ‰ä¸¤ä¸ªå­”ï¼Œåˆ†åˆ«æ˜¯ç­‰é«˜çº¿1å’Œ2ï¼Œå±äºç¬¬äºŒçº§ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºè½®å»“-0ï¼Œåœ¨åŒä¸€å±‚æ¬¡çš„ä¸‹ä¸€ä¸ªè½®å»“æ˜¯è½®å»“-3ã€‚previousä¹Ÿæ²¡æœ‰ã€‚åœ¨hierarchy-2ä¸­ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå­ç»“ç‚¹æ˜¯contour-1ã€‚</p>
<p>å®ƒæ²¡æœ‰çˆ¶ç±»ï¼Œå› ä¸ºå®ƒåœ¨hierarchy-1ä¸­ã€‚æ‰€ä»¥å®ƒçš„å±‚æ¬¡æ•°ç»„æ˜¯[3ï¼Œ-1,1ï¼Œ-1]</p>
<p>ç°åœ¨contour-1ã€‚å®ƒåœ¨å±‚çº§-2ä¸­ã€‚ç›¸åŒå±‚æ¬¡ç»“æ„ä¸­çš„ä¸‹ä¸€ä¸ª(åœ¨contour-1çš„çˆ¶æ¯å…³ç³»ä¸‹)æ˜¯contour-2ã€‚</p>
<p>æ²¡æœ‰previousã€‚æ²¡æœ‰childï¼Œä½†æ˜¯parentæ˜¯contour-0ã€‚æ‰€ä»¥æ•°ç»„æ˜¯[2ï¼Œ-1ï¼Œ-1,0]</p>
<p>ç±»ä¼¼çš„contour-2:å®ƒåœ¨hierarchy-2ä¸­ã€‚åœ¨contour-0ä¸‹ï¼ŒåŒä¸€å±‚æ¬¡ç»“æ„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªè½®å»“ã€‚</p>
<p>æ‰€ä»¥æ²¡æœ‰Nextã€‚previousæ˜¯contour-1ã€‚æ²¡æœ‰childï¼Œparentæ˜¯contour0ã€‚æ‰€ä»¥æ•°ç»„æ˜¯[-1,1ï¼Œ-1,0]</p>
<p>contour-3:å±‚æ¬¡-1çš„ä¸‹ä¸€ä¸ªæ˜¯è½®å»“-5ã€‚ä»¥å‰æ˜¯contour-0ã€‚childæ˜¯contour4ï¼Œæ²¡æœ‰parentã€‚æ‰€ä»¥æ•°ç»„æ˜¯[5,0,4ï¼Œ-1]</p>
<p>contour-4:å®ƒåœ¨contour-3ä¸‹çš„å±‚æ¬¡ç»“æ„2ä¸­ï¼Œå®ƒæ²¡æœ‰å…„å¼Ÿå§å¦¹ã€‚æ²¡æœ‰nextï¼Œæ²¡æœ‰previousï¼Œæ²¡æœ‰childï¼Œparentæ˜¯contour-3ã€‚</p>
<p>æ‰€ä»¥æ•°ç»„æ˜¯[-1ï¼Œ-1ï¼Œ-1,3]</p>
<p>å‰©ä¸‹çš„ä½ å¯ä»¥è¡¥å……ã€‚è¿™æ˜¯æˆ‘å¾—åˆ°çš„æœ€ç»ˆç­”æ¡ˆ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; hierarchy</span><br><span class="line">array([[[ 3, -1,  1, -1],</span><br><span class="line">        [ 2, -1, -1,  0],</span><br><span class="line">        [-1,  1, -1,  0],</span><br><span class="line">        [ 5,  0,  4, -1],</span><br><span class="line">        [-1, -1, -1,  3],</span><br><span class="line">        [ 7,  3,  6, -1],</span><br><span class="line">        [-1, -1, -1,  5],</span><br><span class="line">        [ 8,  5, -1, -1],</span><br><span class="line">        [-1,  7, -1, -1]]])</span><br></pre></td></tr></table></figure>
<h3 id="4-RETR-TREE"><a href="#4-RETR-TREE" class="headerlink" title="4. RETR_TREE"></a>4. RETR_TREE</h3><p>è¿™æ˜¯æœ€åä¸€ä¸ªå®¶ä¼™ï¼Œå®Œç¾å…ˆç”Ÿã€‚å®ƒæ£€ç´¢æ‰€æœ‰çš„è½®å»“å¹¶åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„å®¶æ—å±‚æ¬¡ç»“æ„åˆ—è¡¨ã€‚å®ƒç”šè‡³å‘Šè¯‰ï¼Œè°æ˜¯çˆ·çˆ·ï¼Œçˆ¶äº²ï¼Œå„¿å­ï¼Œå­™å­ï¼Œç”šè‡³æ›´å¤šâ€¦:)ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘æ‹¿ä¸Šé¢çš„å›¾ç‰‡ï¼Œé‡å†™äº†cvçš„ä»£ç ã€‚RETR_TREEï¼Œæ ¹æ®OpenCVç»™å‡ºçš„ç»“æœé‡æ–°æ’åºç­‰é«˜çº¿å¹¶è¿›è¡Œåˆ†æã€‚</p>
<p>åŒæ ·ï¼Œçº¢è‰²çš„å­—æ¯è¡¨ç¤ºè½®å»“æ•°ï¼Œç»¿è‰²çš„å­—æ¯è¡¨ç¤ºå±‚æ¬¡é¡ºåºã€‚<br><img src="http://qiniu.aihubs.net/tree_hierarchy.png" alt><br>å–contour-0:å®ƒåœ¨hierarchy-0ä¸­ã€‚åŒä¸€å±‚æ¬¡ç»“æ„çš„nextè½®å»“æ˜¯è½®å»“-7ã€‚æ²¡æœ‰previousçš„è½®å»“ã€‚childæ˜¯contour-1ï¼Œæ²¡æœ‰parentã€‚æ‰€ä»¥æ•°ç»„æ˜¯[7ï¼Œ-1,1ï¼Œ-1]</p>
<p>ä»¥contour-2ä¸ºä¾‹:å®ƒåœ¨hierarchy-1ä¸­ã€‚æ²¡æœ‰è½®å»“åœ¨åŒä¸€æ°´å¹³ã€‚æ²¡æœ‰previousã€‚childæ˜¯contour-3ã€‚çˆ¶æ¯æ˜¯contour-1ã€‚æ‰€ä»¥æ•°ç»„æ˜¯[-1ï¼Œ-1,3,1]</p>
<p>å‰©ä¸‹çš„ï¼Œä½ è‡ªå·±è¯•è¯•ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´ç­”æ¡ˆ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; hierarchy</span><br><span class="line">array([[[ 7, -1,  1, -1],</span><br><span class="line">        [-1, -1,  2,  0],</span><br><span class="line">        [-1, -1,  3,  1],</span><br><span class="line">        [-1, -1,  4,  2],</span><br><span class="line">        [-1, -1,  5,  3],</span><br><span class="line">        [ 6, -1, -1,  4],</span><br><span class="line">        [-1,  5, -1,  4],</span><br><span class="line">        [ 8,  0, -1, -1],</span><br><span class="line">        [-1,  7, -1, -1]]])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>notebookä½¿ç”¨</title>
    <url>/2020/07/08/notebook%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<ul>
<li>1.<a href="#header1">ä¸»é¢˜ä¿®æ”¹</a></li>
<li>2.<a href="#header2">å¯†ç ä¿®æ”¹</a></li>
<li>3.<a href="#header3">æ·»åŠ å†…æ ¸</a></li>
</ul>
<a id="more"></a>

<h1 id="ä¸»é¢˜ä¿®æ”¹å‚è€ƒ"><a href="#ä¸»é¢˜ä¿®æ”¹å‚è€ƒ" class="headerlink" title="ä¸»é¢˜ä¿®æ”¹å‚è€ƒ"></a><span id="header1">ä¸»é¢˜ä¿®æ”¹<a href="https://blog.csdn.net/wh8514/article/details/81532286/" target="_blank" rel="noopener">å‚è€ƒ</a></span></h1><p>å®‰è£…Jupyterä¸»é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install  jupyterthemes</span><br></pre></td></tr></table></figure>
<p>æ›´æ–°Jupyterä¸»é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install --upgrade jupyterthemes</span><br></pre></td></tr></table></figure>
<p>è£…å’Œæ›´æ–°æˆåŠŸä»¥åï¼Œå¯ä»¥æŸ¥çœ‹å¯ç”¨ä¸»é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jt -l</span><br></pre></td></tr></table></figure>
<p>å¦‚å›¾<img src="/2020/07/08/notebook%E4%BD%BF%E7%94%A8/2.jpg" alt="x"><br>å‚æ•°å«ä¹‰å¦‚ä¸‹<br><img src="/2020/07/08/notebook%E4%BD%BF%E7%94%A8/3.png" alt="x"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jt -t monokai -f fira -fs 13 -cellw 90% -ofs 11 -dfs 11 -T -N</span><br><span class="line">-f(å­—ä½“)  -fs(å­—ä½“å¤§å°) -cellw(å å±æ¯”æˆ–å®½åº¦)  -ofs(è¾“å‡ºæ®µçš„å­—å·)  -T(æ˜¾ç¤ºå·¥å…·æ )  -N(æ˜¾ç¤ºè‡ªå·±ä¸»æœºå)</span><br></pre></td></tr></table></figure>
<p>è§£å†³è¾“å‡ºæ˜¾ç¤ºä¸å…¨çš„é—®é¢˜<br><br>åœ¨C:\Users\XXX.jupyter\custom\custom.cssé‡Œ,æ‰¾åˆ°div.output_area</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">div.output_area&#123;</span><br><span class="line">    display:-webkit-box;</span><br><span class="line">&#125;</span><br><span class="line">æ”¹ä¸º</span><br><span class="line">div.output_area&#123;</span><br><span class="line">    display:-webkit-box;</span><br><span class="line">    padding:13px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="å¯†ç ä¿®æ”¹"><a href="#å¯†ç ä¿®æ”¹" class="headerlink" title="å¯†ç ä¿®æ”¹"></a><span id="header2">å¯†ç ä¿®æ”¹</span></h1><p>ç»ˆç«¯è¿è¡Œï¼Œè¾“å…¥æ–°çš„å¯†ç å³å¯<a href="https://blog.csdn.net/qq_36950604/article/details/103848631" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jupyter notebook password</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/08/notebook%E4%BD%BF%E7%94%A8/1.jpg" alt="x"></p>
<h1 id="æ·»åŠ å†…æ ¸"><a href="#æ·»åŠ å†…æ ¸" class="headerlink" title="æ·»åŠ å†…æ ¸"></a><span id="header3">æ·»åŠ å†…æ ¸</span></h1><ul>
<li>é¦–å…ˆæ·»åŠ è™šæ‹Ÿç¯å¢ƒ,æ¯”å¦‚æˆ‘è¦æ·»åŠ pyç‰ˆæœ¬ä¸º2.7,ç¯å¢ƒåä¸ºpy2çš„ç¯å¢ƒ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">conda create -n py2 python&#x3D;2.7</span><br></pre></td></tr></table></figure></li>
<li>ç„¶åè¿›å…¥å½“å‰è™šæ‹Ÿç¯å¢ƒä¸‹<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">activate py2</span><br></pre></td></tr></table></figure></li>
<li>åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…ipykernel<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install ipykernel</span><br></pre></td></tr></table></figure></li>
<li>æ·»åŠ å†…æ ¸åˆ°jupyteré‡Œ:python -m ipykernel install â€“user â€“name ç¯å¢ƒåç§° â€“display-name â€œåœ¨jupyterä¸­æ˜¾ç¤ºçš„ç¯å¢ƒåç§°â€ï¼Œæ³¨æ„ä¸è¦å¿˜è®°äº†åŒå¼•å·<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python -m ipykernel install --user --name py2 --display-name &quot;py2&quot;</span><br></pre></td></tr></table></figure>
æˆåŠŸ<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/py2-1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/py2.png" alt></li>
</ul>
]]></content>
      <tags>
        <tag>jupyter notebook</tag>
      </tags>
  </entry>
  <entry>
    <title>opencvå›¾åƒæ ¸å¿ƒæ“ä½œ</title>
    <url>/2020/07/12/opencv%E5%9B%BE%E5%83%8F%E6%A0%B8%E5%BF%83%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<ul>
<li>1.<a href="#header1">å›¾ç‰‡çš„åŸºæœ¬æ“ä½œ</a></li>
<li>2.<a href="#header2">å›¾ç‰‡çš„ç®—æ³•æ“ä½œ</a></li>
<li>3.<a href="#header3">æ€§èƒ½è¡¡é‡å’Œæå‡æŠ€æœ¯</a><a id="more"></a>

</li>
</ul>
<h1 id="å›¾åƒçš„åŸºæœ¬æ“ä½œ"><a href="#å›¾åƒçš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å›¾åƒçš„åŸºæœ¬æ“ä½œ"></a><span id="header1">å›¾åƒçš„åŸºæœ¬æ“ä½œ</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>å­¦ä¼šï¼š - è®¿é—®åƒç´ å€¼å¹¶ä¿®æ”¹å®ƒä»¬ - è®¿é—®å›¾åƒå±æ€§ - è®¾ç½®æ„Ÿå…´è¶£åŒºåŸŸ(ROI) - åˆ†å‰²å’Œåˆå¹¶å›¾åƒ</p>
<p>æœ¬èŠ‚ä¸­çš„å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½ä¸»è¦ä¸Numpyç›¸å…³ï¼Œè€Œä¸æ˜¯ä¸OpenCVç›¸å…³ã€‚è¦ä½¿ç”¨OpenCVç¼–å†™æ›´å¥½çš„ä¼˜åŒ–ä»£ç ï¼Œéœ€è¦Numpyçš„ä¸°å¯ŒçŸ¥è¯†ã€‚</p>
<h2 id="è®¿é—®å’Œä¿®æ”¹åƒç´ å€¼"><a href="#è®¿é—®å’Œä¿®æ”¹åƒç´ å€¼" class="headerlink" title="è®¿é—®å’Œä¿®æ”¹åƒç´ å€¼"></a>è®¿é—®å’Œä¿®æ”¹åƒç´ å€¼</h2><p>å¯¹äº BGR å›¾åƒï¼Œå®ƒè¿”å›ä¸€ä¸ªç”±è“è‰²ã€ç»¿è‰²å’Œçº¢è‰²å€¼ç»„æˆçš„æ•°ç»„ã€‚å¯¹äºç°åº¦å›¾åƒï¼Œåªè¿”å›ç›¸åº”çš„ç°åº¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>) <span class="comment"># è½½å…¥å½©è‰²å›¾åƒ</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">px = img[<span class="number">210</span>,<span class="number">490</span>] <span class="comment"># è®¿é—®210,490ç‚¹å¤„çš„å…¨éƒ¨å…ƒç´ </span></span><br><span class="line">px</span><br></pre></td></tr></table></figure>




<pre><code>array([237, 189, 147], dtype=uint8)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">blue = img[<span class="number">210</span>,<span class="number">490</span>,<span class="number">0</span>] <span class="comment"># ä»…è®¿é—®è“è‰²å…ƒç´ </span></span><br><span class="line">blue</span><br></pre></td></tr></table></figure>




<pre><code>237</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img[<span class="number">100</span>,<span class="number">100</span>] = [<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>]<span class="comment"># ä¿®æ”¹åƒç´ å€¼</span></span><br><span class="line">img[<span class="number">100</span>,<span class="number">100</span>]</span><br></pre></td></tr></table></figure>




<pre><code>array([255, 255, 255], dtype=uint8)</code></pre><h3 id="è­¦å‘Š"><a href="#è­¦å‘Š" class="headerlink" title="è­¦å‘Š"></a>è­¦å‘Š</h3><p>Numpyæ˜¯ç”¨äºå¿«é€Ÿæ•°ç»„è®¡ç®—çš„ä¼˜åŒ–åº“ã€‚å› æ­¤ï¼Œç®€å•åœ°è®¿é—®æ¯ä¸ªåƒç´ å€¼å¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹å°†éå¸¸ç¼“æ…¢ï¼Œå› æ­¤ä¸å»ºè®®ä½¿ç”¨ã€‚</p>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>ä¸Šé¢çš„æ–¹æ³•é€šå¸¸ç”¨äºé€‰æ‹©æ•°ç»„çš„åŒºåŸŸï¼Œä¾‹å¦‚å‰5è¡Œå’Œå3åˆ—ã€‚</p>
<p>å¯¹äºå•ä¸ªåƒç´ è®¿é—®ï¼ŒNumpyæ•°ç»„æ–¹æ³•array.item()å’Œarray.itemset())è¢«è®¤ä¸ºæ›´å¥½ï¼Œä½†æ˜¯å®ƒä»¬å§‹ç»ˆè¿”å›æ ‡é‡ã€‚</p>
<p>å¦‚æœè¦è®¿é—®æ‰€æœ‰Bï¼ŒGï¼ŒRå€¼ï¼Œåˆ™éœ€è¦åˆ†åˆ«è°ƒç”¨æ‰€æœ‰çš„array.item()ã€‚</p>
<p>ä¸‹é¢æ˜¯æ›´å¥½çš„åƒç´ è®¿é—®å’Œç¼–è¾‘æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">red = img.item(<span class="number">100</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line">red</span><br></pre></td></tr></table></figure>




<pre><code>255</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img.itemset((<span class="number">100</span>,<span class="number">100</span>,<span class="number">2</span>),<span class="number">222</span>)</span><br><span class="line">red = img.item(<span class="number">100</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line">red</span><br></pre></td></tr></table></figure>




<pre><code>222</code></pre><h2 id="è®¿é—®å›¾åƒå±æ€§"><a href="#è®¿é—®å›¾åƒå±æ€§" class="headerlink" title="è®¿é—®å›¾åƒå±æ€§"></a>è®¿é—®å›¾åƒå±æ€§</h2><p>å›¾åƒå±æ€§åŒ…æ‹¬è¡Œæ•°ï¼Œåˆ—æ•°å’Œé€šé“æ•°ï¼Œå›¾åƒæ•°æ®ç±»å‹ï¼Œåƒç´ æ•°ç­‰ã€‚</p>
<p>å›¾åƒçš„å½¢çŠ¶å¯é€šè¿‡img.shapeè®¿é—®ã€‚å®ƒè¿”å›è¡Œï¼Œåˆ—å’Œé€šé“æ•°çš„å…ƒç»„ï¼ˆå¦‚æœå›¾åƒæ˜¯å½©è‰²çš„ï¼‰ï¼š</p>
<p>æ³¨æ„ å¦‚æœå›¾åƒæ˜¯ç°åº¦çš„ï¼Œåˆ™è¿”å›çš„å…ƒç»„ä»…åŒ…å«è¡Œæ•°å’Œåˆ—æ•°ï¼Œå› æ­¤è¿™æ˜¯æ£€æŸ¥åŠ è½½çš„å›¾åƒæ˜¯ç°åº¦è¿˜æ˜¯å½©è‰²çš„å¥½æ–¹æ³•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img.shape</span><br></pre></td></tr></table></figure>




<pre><code>(640, 640, 3)</code></pre><p>åƒç´ æ€»æ•°å¯é€šè¿‡è®¿é—®img.sizeï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img.size</span><br></pre></td></tr></table></figure>




<pre><code>1228800</code></pre><p>å›¾åƒæ•°æ®ç±»å‹é€šè¿‡img.dtypeè·å¾—ï¼š</p>
<p>æ³¨æ„ img.dtypeåœ¨è°ƒè¯•æ—¶éå¸¸é‡è¦ï¼Œå› ä¸ºOpenCV-Pythonä»£ç ä¸­çš„å¤§é‡é”™è¯¯æ˜¯ç”±æ— æ•ˆçš„æ•°æ®ç±»å‹å¼•èµ·çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img.dtype</span><br></pre></td></tr></table></figure>




<pre><code>dtype(&apos;uint8&apos;)</code></pre><h2 id="å›¾åƒæ„Ÿå…´è¶£åŒºåŸŸROI"><a href="#å›¾åƒæ„Ÿå…´è¶£åŒºåŸŸROI" class="headerlink" title="å›¾åƒæ„Ÿå…´è¶£åŒºåŸŸROI"></a>å›¾åƒæ„Ÿå…´è¶£åŒºåŸŸROI</h2><p>æœ‰æ—¶å€™ï¼Œä½ ä¸å¾—ä¸å¤„ç†ä¸€äº›ç‰¹å®šåŒºåŸŸçš„å›¾åƒã€‚</p>
<p>å¯¹äºå›¾åƒä¸­çš„çœ¼ç›æ£€æµ‹ï¼Œé¦–å…ˆå¯¹æ•´ä¸ªå›¾åƒè¿›è¡Œäººè„¸æ£€æµ‹ã€‚</p>
<p>åœ¨è·å–äººè„¸å›¾åƒæ—¶ï¼Œæˆ‘ä»¬åªé€‰æ‹©äººè„¸åŒºåŸŸï¼Œæœç´¢å…¶ä¸­çš„çœ¼ç›ï¼Œè€Œä¸æ˜¯æœç´¢æ•´ä¸ªå›¾åƒã€‚</p>
<p>å®ƒæé«˜äº†å‡†ç¡®æ€§(å› ä¸ºçœ¼ç›æ€»æ˜¯åœ¨é¢éƒ¨ä¸Š:D )å’Œæ€§èƒ½(å› ä¸ºæˆ‘ä»¬æœç´¢çš„åŒºåŸŸå¾ˆå°)ã€‚</p>
<p>ä½¿ç”¨Numpyç´¢å¼•å†æ¬¡è·å¾—ROIã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ball = img[<span class="number">180</span>:<span class="number">240</span>, <span class="number">230</span>:<span class="number">290</span>]</span><br><span class="line">img[<span class="number">273</span>:<span class="number">333</span>, <span class="number">100</span>:<span class="number">160</span>] = ball </span><br><span class="line">cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="æ‹†åˆ†å’Œåˆå¹¶å›¾åƒé€šé“"><a href="#æ‹†åˆ†å’Œåˆå¹¶å›¾åƒé€šé“" class="headerlink" title="æ‹†åˆ†å’Œåˆå¹¶å›¾åƒé€šé“"></a>æ‹†åˆ†å’Œåˆå¹¶å›¾åƒé€šé“</h2><p>æœ‰æ—¶ä½ éœ€è¦åˆ†åˆ«å¤„ç†å›¾åƒçš„Bï¼ŒGï¼ŒRé€šé“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å°†BGRå›¾åƒæ‹†åˆ†ä¸ºå•ä¸ªé€šé“ã€‚</p>
<p>åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦å°†è¿™äº›å•ç‹¬çš„é¢‘é“åŠ å…¥BGRå›¾ç‰‡ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç®€å•åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b,g,r = cv.split(img)</span><br><span class="line">img = cv.merge((b,g,r))</span><br></pre></td></tr></table></figure>

<p>å‡è®¾ä½ è¦å°†æ‰€æœ‰çº¢è‰²åƒç´ éƒ½è®¾ç½®ä¸ºé›¶ï¼Œåˆ™æ— éœ€å…ˆæ‹†åˆ†é€šé“ã€‚numpyç´¢å¼•æ›´å¿«</p>
<p>è­¦å‘Š</p>
<p>cv.split()æ˜¯ä¸€é¡¹è€—æ—¶çš„æ“ä½œï¼ˆå°±æ—¶é—´è€Œè¨€ï¼‰ã€‚å› æ­¤ï¼Œä»…åœ¨å¿…è¦æ—¶æ‰è¿™æ ·åšã€‚å¦åˆ™è¯·è¿›è¡ŒNumpyç´¢å¼•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img [:, :, <span class="number">2</span>] = <span class="number">0</span></span><br><span class="line">cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ºå›¾åƒè®¾ç½®è¾¹æ¡†ï¼ˆå¡«å……ï¼‰"><a href="#ä¸ºå›¾åƒè®¾ç½®è¾¹æ¡†ï¼ˆå¡«å……ï¼‰" class="headerlink" title="ä¸ºå›¾åƒè®¾ç½®è¾¹æ¡†ï¼ˆå¡«å……ï¼‰"></a>ä¸ºå›¾åƒè®¾ç½®è¾¹æ¡†ï¼ˆå¡«å……ï¼‰</h2><p>å¦‚æœè¦åœ¨å›¾åƒå‘¨å›´åˆ›å»ºè¾¹æ¡†ï¼ˆå¦‚ç›¸æ¡†ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨cv.copyMakeBorder()ã€‚ä½†æ˜¯å®ƒåœ¨å·ç§¯è¿ç®—ï¼Œé›¶å¡«å……ç­‰æ–¹é¢æœ‰æ›´å¤šåº”ç”¨ã€‚æ­¤å‡½æ•°é‡‡ç”¨ä»¥ä¸‹å‚æ•°ï¼š</p>
<p>src - è¾“å…¥å›¾åƒ</p>
<p>topï¼Œbottomï¼Œleftï¼Œright è¾¹ç•Œå®½åº¦ï¼ˆä»¥ç›¸åº”æ–¹å‘ä¸Šçš„åƒç´ æ•°ä¸ºå•ä½ï¼‰</p>
<p>borderType - å®šä¹‰è¦æ·»åŠ å“ªç§è¾¹æ¡†çš„æ ‡å¿—ã€‚å®ƒå¯ä»¥æ˜¯ä»¥ä¸‹ç±»å‹ï¼š</p>
<ul>
<li>cv.BORDER_CONSTANT - æ·»åŠ æ’å®šçš„å½©è‰²è¾¹æ¡†ã€‚è¯¥å€¼åº”ä½œä¸ºä¸‹ä¸€ä¸ªå‚æ•°ç»™å‡ºã€‚</li>
<li>cv.BORDER_REFLECT - è¾¹æ¡†å°†æ˜¯è¾¹æ¡†å…ƒç´ çš„é•œåƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š fedcba | abcdefgh | hgfedcb</li>
<li>cv.BORDER_REFLECT_101æˆ– cv.BORDER_DEFAULTä¸ä¸Šè¿°ç›¸åŒï¼Œä½†ç•¥æœ‰å˜åŒ–ï¼Œä¾‹å¦‚ï¼š gfedcb | abcdefgh | gfedcba</li>
<li>cv.BORDER_REPLICATEæœ€åä¸€ä¸ªå…ƒç´ è¢«å¤åˆ¶ï¼Œåƒè¿™æ ·ï¼š aaaaaa | abcdefgh | hhhhhhh</li>
<li>cv.BORDER_WRAPéš¾ä»¥è§£é‡Šï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š cdefgh | abcdefgh | abcdefg</li>
</ul>
<p>value -è¾¹æ¡†çš„é¢œè‰²ï¼Œå¦‚æœè¾¹æ¡†ç±»å‹ä¸º<strong>cv.BORDER_CONSTANT</strong></p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†æ‰€æœ‰è¿™äº›è¾¹æ¡†ç±»å‹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ï¼š<br>(å›¾åƒä¸matplotlibä¸€èµ·æ˜¾ç¤ºã€‚å› æ­¤çº¢è‰²å’Œè“è‰²é€šé“å°†äº’æ¢)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">BLUE = [<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">img1 = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line">replicate = cv.copyMakeBorder(img1,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,cv.BORDER_REPLICATE)</span><br><span class="line">reflect = cv.copyMakeBorder(img1,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,cv.BORDER_REFLECT)</span><br><span class="line">reflect101 = cv.copyMakeBorder(img1,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,cv.BORDER_REFLECT_101)</span><br><span class="line">wrap = cv.copyMakeBorder(img1,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,cv.BORDER_WRAP)</span><br><span class="line">constant= cv.copyMakeBorder(img1,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,cv.BORDER_CONSTANT,value=BLUE)</span><br><span class="line">plt.subplot(<span class="number">231</span>),plt.imshow(img1,<span class="string">'gray'</span>),plt.title(<span class="string">'ORIGINAL'</span>)</span><br><span class="line">plt.subplot(<span class="number">232</span>),plt.imshow(replicate,<span class="string">'gray'</span>),plt.title(<span class="string">'REPLICATE'</span>)</span><br><span class="line">plt.subplot(<span class="number">233</span>),plt.imshow(reflect,<span class="string">'gray'</span>),plt.title(<span class="string">'REFLECT'</span>)</span><br><span class="line">plt.subplot(<span class="number">234</span>),plt.imshow(reflect101,<span class="string">'gray'</span>),plt.title(<span class="string">'REFLECT_101'</span>)</span><br><span class="line">plt.subplot(<span class="number">235</span>),plt.imshow(wrap,<span class="string">'gray'</span>),plt.title(<span class="string">'WRAP'</span>)</span><br><span class="line">plt.subplot(<span class="number">236</span>),plt.imshow(constant,<span class="string">'gray'</span>),plt.title(<span class="string">'CONSTANT'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv%E5%9B%BE%E5%83%8F%E6%A0%B8%E5%BF%83%E6%93%8D%E4%BD%9C/output_21_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="å›¾åƒä¸Šçš„ç®—æœ¯è¿ç®—"><a href="#å›¾åƒä¸Šçš„ç®—æœ¯è¿ç®—" class="headerlink" title="å›¾åƒä¸Šçš„ç®—æœ¯è¿ç®—"></a><span id="header2">å›¾åƒä¸Šçš„ç®—æœ¯è¿ç®—</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>å­¦ä¹ å›¾åƒçš„å‡ ç§ç®—æœ¯è¿ç®—ï¼Œä¾‹å¦‚åŠ æ³•ï¼Œå‡æ³•ï¼ŒæŒ‰ä½è¿ç®—ç­‰ã€‚</p>
<p>æ‚¨å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.addï¼Œ<strong>cv.addWeighted</strong>ç­‰ã€‚</p>
<h2 id="å›¾åƒåŠ æ³•"><a href="#å›¾åƒåŠ æ³•" class="headerlink" title="å›¾åƒåŠ æ³•"></a>å›¾åƒåŠ æ³•</h2><p>æ‚¨å¯ä»¥é€šè¿‡OpenCVå‡½æ•°cv.add()æˆ–ä»…é€šè¿‡numpyæ“ä½œres = img1 + img2æ·»åŠ ä¸¤ä¸ªå›¾åƒã€‚</p>
<p>ä¸¤ä¸ªå›¾åƒåº”å…·æœ‰ç›¸åŒçš„æ·±åº¦å’Œç±»å‹ï¼Œæˆ–è€…ç¬¬äºŒä¸ªå›¾åƒå¯ä»¥åªæ˜¯ä¸€ä¸ªæ ‡é‡å€¼ã€‚</p>
<p>æ³¨æ„ OpenCVåŠ æ³•å’ŒNumpyåŠ æ³•ä¹‹é—´æœ‰åŒºåˆ«ã€‚OpenCVåŠ æ³•æ˜¯é¥±å’Œè¿ç®—ï¼Œè€ŒNumpyåŠ æ³•æ˜¯æ¨¡è¿ç®—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.uint8([<span class="number">250</span>])</span><br><span class="line">y = np.uint8([<span class="number">10</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x+y  <span class="comment"># 250+10 = 260 % 256 = 4</span></span><br></pre></td></tr></table></figure>




<pre><code>array([4], dtype=uint8)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv.add(x,y) <span class="comment"># 250+10 = 260 =&gt; 255</span></span><br></pre></td></tr></table></figure>




<pre><code>array([[255]], dtype=uint8)</code></pre><h2 id="å›¾åƒèåˆ"><a href="#å›¾åƒèåˆ" class="headerlink" title="å›¾åƒèåˆ"></a>å›¾åƒèåˆ</h2><p>è¿™ä¹Ÿæ˜¯å›¾åƒåŠ æ³•ï¼Œä½†æ˜¯å¯¹å›¾åƒèµ‹äºˆä¸åŒçš„æƒé‡ï¼Œä»¥ä½¿å…¶å…·æœ‰èåˆæˆ–é€æ˜çš„æ„Ÿè§‰ã€‚æ ¹æ®ä»¥ä¸‹ç­‰å¼æ·»åŠ å›¾åƒï¼š</p>
<p>G(x)=(1âˆ’Î±)f0(x)+Î±f1(x)<br>é€šè¿‡ä» Î± ä» 0â†’1 æ›´æ”¹ï¼Œæ‚¨å¯ä»¥åœ¨ä¸€ä¸ªå›¾åƒåˆ°å¦ä¸€ä¸ªå›¾åƒä¹‹é—´æ‰§è¡Œå¾ˆé…·çš„è¿‡æ¸¡ã€‚</p>
<p>å°†ä¸¤å¹…å›¾åƒåˆåœ¨ä¸€èµ·ã€‚ç¬¬ä¸€å¹…å›¾åƒçš„æƒé‡ä¸º0.7ï¼Œç¬¬äºŒå¹…å›¾åƒçš„æƒé‡ä¸º0.3ã€‚</p>
<p>cv.addWeighted()åœ¨å›¾åƒä¸Šåº”ç”¨ä»¥ä¸‹å…¬å¼ã€‚</p>
<p>dst=Î±â‹…img1+Î²â‹…img2+Î³<br>åœ¨è¿™é‡Œï¼ŒÎ³ è¢«è§†ä¸ºé›¶ã€‚</p>
<p>å…ˆä¿å­˜ä¸€ä¸ªå’Œavatar1å¤§å°ä¸€æ ·ä¸Šä¸‹ç›¸åçš„å›¾åƒavatar2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img = cv.imread(<span class="string">'avatar1.jpg'</span>)</span><br><span class="line">newImg = img.copy() <span class="comment"># æ·±æ‹·è´</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(img.shape[<span class="number">0</span>]):</span><br><span class="line">    newImg[img.shape[<span class="number">0</span>]<span class="number">-1</span>-i] = img[i]</span><br><span class="line">cv.imshow(<span class="string">'x'</span>,newImg)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">cv.imwrite(<span class="string">'avatar2.jpg'</span>,newImg)</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img1 = cv.imread(<span class="string">'avatar1.jpg'</span>)</span><br><span class="line">img2 = cv.imread(<span class="string">'avatar2.jpg'</span>)</span><br><span class="line">dst = cv.addWeighted(img1,<span class="number">0.7</span>,img2,<span class="number">0.3</span>,<span class="number">0</span>)</span><br><span class="line">cv.imshow(<span class="string">'dst'</span>,dst)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="æŒ‰ä½è¿ç®—"><a href="#æŒ‰ä½è¿ç®—" class="headerlink" title="æŒ‰ä½è¿ç®—"></a>æŒ‰ä½è¿ç®—</h2><p>è¿™åŒ…æ‹¬æŒ‰ä½ ANDã€ ORã€NOT å’Œ XOR æ“ä½œã€‚å®ƒä»¬åœ¨æå–å›¾åƒçš„ä»»ä½•éƒ¨åˆ†(æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä¸­çœ‹åˆ°)ã€å®šä¹‰å’Œå¤„ç†éçŸ©å½¢ ROI ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ </p>
<p>ä¸‹é¢æˆ‘ä»¬å°†çœ‹åˆ°ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä½•æ”¹å˜ä¸€ä¸ªå›¾åƒçš„ç‰¹å®šåŒºåŸŸã€‚ </p>
<p>æˆ‘æƒ³æŠŠ OpenCV çš„æ ‡å¿—æ”¾åœ¨ä¸€ä¸ªå›¾åƒä¸Šé¢ã€‚å¦‚æœæˆ‘æ·»åŠ ä¸¤ä¸ªå›¾åƒï¼Œå®ƒä¼šæ”¹å˜é¢œè‰²ã€‚å¦‚æœæˆ‘æ··åˆå®ƒï¼Œæˆ‘å¾—åˆ°ä¸€ä¸ªé€æ˜çš„æ•ˆæœã€‚</p>
<p>ä½†æˆ‘å¸Œæœ›å®ƒæ˜¯ä¸é€æ˜çš„ã€‚å¦‚æœæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œ</p>
<p>æˆ‘å¯ä»¥ä½¿ç”¨ ROIï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¸Šä¸€ç« ä¸­æ‰€åšçš„é‚£æ ·ã€‚</p>
<p>ä½†æ˜¯ OpenCV çš„ logo ä¸æ˜¯é•¿æ–¹å½¢çš„ã€‚æ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æŒ‰ä½æ“ä½œæ¥å®ç°:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½ä¸¤å¼ å›¾ç‰‡</span></span><br><span class="line">img1 = cv.imread(<span class="string">'avatar1.jpg'</span>)</span><br><span class="line">img2 = cv.imread(<span class="string">'opencv-logo.png'</span>)</span><br><span class="line"><span class="comment"># æˆ‘æƒ³æŠŠlogoæ”¾åœ¨å·¦ä¸Šè§’ï¼Œæ‰€ä»¥æˆ‘åˆ›å»ºäº†ROI</span></span><br><span class="line">rows,cols,channels = img2.shape</span><br><span class="line">roi = img1[<span class="number">0</span>:rows, <span class="number">0</span>:cols ]</span><br><span class="line"><span class="comment"># ç°åœ¨åˆ›å»ºlogoçš„æ©ç ï¼Œå¹¶åŒæ—¶åˆ›å»ºå…¶ç›¸åæ©ç </span></span><br><span class="line">img2gray = cv.cvtColor(img2,cv.COLOR_BGR2GRAY)</span><br><span class="line">ret, mask = cv.threshold(img2gray, <span class="number">10</span>, <span class="number">255</span>, cv.THRESH_BINARY)</span><br><span class="line">mask_inv = cv.bitwise_not(mask)</span><br><span class="line">cv.imshow(<span class="string">'img2gray'</span>,img2gray)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">cv.imshow(<span class="string">'mask'</span>,mask)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">cv.imshow(<span class="string">'mask_inv'</span>,mask_inv)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line"><span class="comment"># ç°åœ¨å°†ROIä¸­logoçš„åŒºåŸŸæ¶‚é»‘</span></span><br><span class="line">img1_bg = cv.bitwise_and(roi,roi,mask = mask_inv)</span><br><span class="line"><span class="comment"># ä»…ä»logoå›¾åƒä¸­æå–logoåŒºåŸŸ</span></span><br><span class="line">img2_fg = cv.bitwise_and(img2,img2,mask = mask)</span><br><span class="line"><span class="comment"># å°†logoæ”¾å…¥ROIå¹¶ä¿®æ”¹ä¸»å›¾åƒ</span></span><br><span class="line">cv.imshow(<span class="string">'img1_bg'</span>,img1_bg)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">cv.imshow(<span class="string">'img2_bg'</span>,img2_fg)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br><span class="line">dst = cv.add(img1_bg,img2_fg)</span><br><span class="line">img1[<span class="number">0</span>:rows, <span class="number">0</span>:cols ] = dst</span><br><span class="line">cv.imshow(<span class="string">'res'</span>,img1)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<h1 id="æ€§èƒ½è¡¡é‡å’Œæå‡æŠ€æœ¯"><a href="#æ€§èƒ½è¡¡é‡å’Œæå‡æŠ€æœ¯" class="headerlink" title="æ€§èƒ½è¡¡é‡å’Œæå‡æŠ€æœ¯"></a><span id="header3">æ€§èƒ½è¡¡é‡å’Œæå‡æŠ€æœ¯</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œç”±äºæ¯ç§’è¦å¤„ç†å¤§é‡æ“ä½œï¼Œå› æ­¤å¿…é¡»ä½¿ä»£ç ä¸ä»…æä¾›æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”è¿˜å¿…é¡»ä»¥æœ€å¿«çš„æ–¹å¼æä¾›ã€‚</p>
<p>å°†å­¦ä¹ è¡¡é‡ä»£ç çš„æ€§èƒ½,ä¸€äº›æé«˜ä»£ç æ€§èƒ½çš„æŠ€å·§ã€‚</p>
<p>ä½ å°†çœ‹åˆ°ä»¥ä¸‹åŠŸèƒ½ï¼šcv.getTickCountï¼Œ<strong>cv.getTickFrequency</strong>ç­‰ã€‚</p>
<p>é™¤äº†OpenCVï¼ŒPythonè¿˜æä¾›äº†ä¸€ä¸ªæ¨¡å—<strong>time</strong>ï¼Œè¿™æœ‰åŠ©äºè¡¡é‡æ‰§è¡Œæ—¶é—´ã€‚</p>
<p>å¦ä¸€ä¸ªæ¨¡å—<strong>profile</strong>æœ‰åŠ©äºè·å–æœ‰å…³ä»£ç çš„è¯¦ç»†æŠ¥å‘Šï¼Œä¾‹å¦‚ä»£ç ä¸­æ¯ä¸ªå‡½æ•°èŠ±è´¹äº†å¤šå°‘æ—¶é—´ï¼Œè°ƒç”¨äº†å‡½æ•°çš„æ¬¡æ•°ç­‰ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯IPythonï¼Œåˆ™æ‰€æœ‰è¿™äº›åŠŸèƒ½éƒ½é›†æˆåœ¨ç”¨æˆ·å‹å¥½çš„ç•Œé¢ä¸­æ–¹å¼ã€‚</p>
<h2 id="ä½¿ç”¨OpenCVè¡¡é‡æ€§èƒ½"><a href="#ä½¿ç”¨OpenCVè¡¡é‡æ€§èƒ½" class="headerlink" title="ä½¿ç”¨OpenCVè¡¡é‡æ€§èƒ½"></a>ä½¿ç”¨OpenCVè¡¡é‡æ€§èƒ½</h2><p><strong>cv.getTickCount</strong>å‡½æ•°è¿”å›ä»å‚è€ƒäº‹ä»¶ï¼ˆå¦‚æ‰“å¼€æœºå™¨çš„é‚£ä¸€åˆ»ï¼‰åˆ°è°ƒç”¨æ­¤å‡½æ•°é‚£ä¸€åˆ»ä¹‹é—´çš„æ—¶é’Ÿå‘¨æœŸæ•°ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰å’Œä¹‹åè°ƒç”¨å®ƒï¼Œåˆ™ä¼šè·å¾—ç”¨äºæ‰§è¡Œå‡½æ•°çš„æ—¶é’Ÿå‘¨æœŸæ•°ã€‚</p>
<p><strong>cv.getTickFrequency</strong>å‡½æ•°è¿”å›æ—¶é’Ÿå‘¨æœŸçš„é¢‘ç‡æˆ–æ¯ç§’çš„æ—¶é’Ÿå‘¨æœŸæ•°ã€‚å› æ­¤ï¼Œè¦æ‰¾åˆ°æ‰§è¡Œæ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼Œä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img1 = cv.imread(<span class="string">'avatar2gray.jpg.jpg'</span>)</span><br><span class="line">e1 = cv.getTickCount()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">49</span>,<span class="number">2</span>):</span><br><span class="line">    img1 = cv.medianBlur(img1,i)</span><br><span class="line">e2 = cv.getTickCount()</span><br><span class="line">t = (e2 - e1)/cv.getTickFrequency()</span><br><span class="line">t</span><br></pre></td></tr></table></figure>




<pre><code>0.0002413</code></pre><h2 id="OpenCVä¸­çš„é»˜è®¤ä¼˜åŒ–"><a href="#OpenCVä¸­çš„é»˜è®¤ä¼˜åŒ–" class="headerlink" title="OpenCVä¸­çš„é»˜è®¤ä¼˜åŒ–"></a>OpenCVä¸­çš„é»˜è®¤ä¼˜åŒ–</h2><p>è®¸å¤š OpenCV å‡½æ•°éƒ½æ˜¯ä½¿ç”¨ SSE2ã€ AVX ç­‰è¿›è¡Œä¼˜åŒ–çš„ã€‚ å®ƒè¿˜åŒ…å«æœªä¼˜åŒ–çš„ä»£ç ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬çš„ç³»ç»Ÿæ”¯æŒè¿™äº›ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±åº”è¯¥åˆ©ç”¨å®ƒä»¬(å‡ ä¹æ‰€æœ‰ç°ä»£çš„å¤„ç†å™¨éƒ½æ”¯æŒå®ƒä»¬)ã€‚</p>
<p>åœ¨ç¼–è¯‘æ—¶é»˜è®¤å¯ç”¨å®ƒã€‚å› æ­¤ï¼Œå¦‚æœå¯ç”¨äº† OpenCVï¼Œå®ƒå°†è¿è¡Œä¼˜åŒ–çš„ä»£ç ï¼Œå¦åˆ™å®ƒå°†è¿è¡Œæœªä¼˜åŒ–çš„ä»£ç ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ cvUseoptimized æ£€æŸ¥æ˜¯å¦å¯ç”¨ / ç¦ç”¨å’Œ cvSetuseoptimized ä»¥å¯ç”¨ / ç¦ç”¨å®ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv.useOptimized() <span class="comment"># æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†ä¼˜åŒ–</span></span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit res = cv.medianBlur(img1,<span class="number">49</span>)</span><br></pre></td></tr></table></figure>

<pre><code>748 ns Â± 45.3 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv.setUseOptimized(<span class="literal">False</span>)</span><br><span class="line">print(cv.useOptimized())</span><br></pre></td></tr></table></figure>

<pre><code>False</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit res = cv.medianBlur(img1,<span class="number">49</span>)</span><br></pre></td></tr></table></figure>

<pre><code>752 ns Â± 34.2 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv.setUseOptimized(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="åœ¨IPythonä¸­è¡¡é‡æ€§èƒ½"><a href="#åœ¨IPythonä¸­è¡¡é‡æ€§èƒ½" class="headerlink" title="åœ¨IPythonä¸­è¡¡é‡æ€§èƒ½"></a>åœ¨IPythonä¸­è¡¡é‡æ€§èƒ½</h2><p>æœ‰æ—¶ä½ å¯èƒ½éœ€è¦æ¯”è¾ƒä¸¤ä¸ªç±»ä¼¼æ“ä½œçš„æ€§èƒ½ã€‚</p>
<p>IPythonä¸ºä½ æä¾›äº†ä¸€ä¸ªç¥å¥‡çš„å‘½ä»¤è®¡æ—¶å™¨æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚å®ƒ</p>
<p>ä¼šå¤šæ¬¡è¿è¡Œä»£ç ä»¥è·å¾—æ›´å‡†ç¡®çš„ç»“æœã€‚åŒæ ·ï¼Œå®ƒä»¬é€‚ç”¨äºæµ‹é‡å•è¡Œä»£ç ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½ çŸ¥é“ä»¥ä¸‹å“ªä¸ªåŠ æ³•è¿ç®—æ›´å¥½ï¼Œ</p>
<p>x = 5 y = x**2, </p>
<p>x = 5  y = x*x, </p>
<p>x = np.uint8([5]) y = x*xæˆ–y = np.square(x)?æˆ‘ä»¬å°†åœ¨IPython shellä¸­ä½¿ç”¨timeit</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="number">5</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit y=x**<span class="number">2</span></span><br></pre></td></tr></table></figure>

<pre><code>515 ns Â± 17 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit y=x*x</span><br></pre></td></tr></table></figure>

<pre><code>121 ns Â± 5.63 ns per loop (mean Â± std. dev. of 7 runs, 10000000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">z = np.uint8([<span class="number">5</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit y=z*z</span><br></pre></td></tr></table></figure>

<pre><code>1.04 Âµs Â± 61.6 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit y=np.square(z)</span><br></pre></td></tr></table></figure>

<pre><code>1.04 Âµs Â± 57.5 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><p>å¯ä»¥çœ‹åˆ°x = 5; y = x * xæœ€å¿«ï¼Œæ¯”Numpyå¿«20å€å·¦å³ã€‚å¦‚æœä½ è¿˜è€ƒè™‘é˜µåˆ—çš„åˆ›å»ºï¼Œå®ƒå¯èƒ½ä¼šå¿«100å€ã€‚</p>
<p>æ³¨æ„ Pythonæ ‡é‡æ“ä½œæ¯”Numpyæ ‡é‡æ“ä½œå¿«ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºåŒ…å«ä¸€ä¸¤ä¸ªå…ƒç´ çš„è¿ç®—ï¼ŒPythonæ ‡é‡æ¯”Numpyæ•°ç»„å¥½ã€‚</p>
<p>å½“æ•°ç»„å¤§å°ç¨å¤§æ—¶ï¼ŒNumpyä¼šå ä¼˜åŠ¿ã€‚</p>
<p>æˆ‘ä»¬å°†æ¯”è¾ƒ<strong>cv.countNonZero</strong>å’Œ<strong>np.count_nonzero</strong>å¯¹äºåŒä¸€å¼ å›¾ç‰‡çš„æ€§èƒ½ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit z = np.count_nonzero(img1)</span><br></pre></td></tr></table></figure>

<pre><code>2.58 Âµs Â± 321 ns per loop (mean Â± std. dev. of 7 runs, 100000 loops each)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%timeit z = cv.countNonZero(img1)</span><br></pre></td></tr></table></figure>

<pre><code>722 ns Â± 25.6 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)</code></pre><p>OpenCV å‡½æ•°æ¯” Numpy å‡½æ•°å¿«è¿‘25å€ã€‚</p>
<p>æ³¨æ„ </p>
<p>é€šå¸¸ï¼ŒOpenCVå‡½æ•°æ¯”Numpyå‡½æ•°è¦å¿«ã€‚å› æ­¤ï¼Œå¯¹äºç›¸åŒçš„æ“ä½œï¼Œé¦–é€‰OpenCVåŠŸèƒ½ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¯èƒ½ä¼šæœ‰ä¾‹å¤–ï¼Œå°¤å…¶æ˜¯å½“Numpyå¤„ç†è§†å›¾è€Œä¸æ˜¯å‰¯æœ¬æ—¶ã€‚</p>
<h2 id="æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯"><a href="#æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯"></a>æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯</h2><p>æœ‰å‡ ç§æŠ€æœ¯å’Œç¼–ç æ–¹æ³•å¯ä»¥å……åˆ†åˆ©ç”¨ Python å’Œ Numpy çš„æœ€å¤§æ€§èƒ½ã€‚</p>
<p>è¿™é‡Œè¦æ³¨æ„çš„ä¸»è¦äº‹æƒ…æ˜¯ï¼Œé¦–å…ˆå°è¯•ä»¥ä¸€ç§ç®€å•çš„æ–¹å¼å®ç°ç®—æ³•ã€‚</p>
<p>ä¸€æ—¦å®ƒè¿è¡Œèµ·æ¥ï¼Œåˆ†æå®ƒï¼Œæ‰¾åˆ°ç“¶é¢ˆå¹¶ä¼˜åŒ–å®ƒä»¬ã€‚</p>
<ul>
<li>å°½é‡é¿å…åœ¨Pythonä¸­ä½¿ç”¨å¾ªç¯ï¼Œå°¤å…¶æ˜¯åŒ/ä¸‰é‡å¾ªç¯ç­‰ã€‚å®ƒä»¬æœ¬æ¥å°±å¾ˆæ…¢ã€‚</li>
<li>ç”±äºNumpyå’ŒOpenCVå·²é’ˆå¯¹å‘é‡è¿ç®—è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå› æ­¤å°†ç®—æ³•/ä»£ç å‘é‡åŒ–åˆ°æœ€å¤§ç¨‹åº¦ã€‚</li>
<li>åˆ©ç”¨ç¼“å­˜ä¸€è‡´æ€§ã€‚</li>
<li>é™¤ééœ€è¦ï¼Œå¦åˆ™åˆ‡å‹¿åˆ›å»ºæ•°ç»„çš„å‰¯æœ¬ã€‚å°è¯•æ”¹ç”¨è§†å›¾ã€‚æ•°ç»„å¤åˆ¶æ˜¯ä¸€é¡¹æ˜‚è´µçš„æ“ä½œã€‚</li>
<li>å³ä½¿æ‰§è¡Œäº†æ‰€æœ‰è¿™äº›æ“ä½œåï¼Œå¦‚æœä½ çš„ä»£ç ä»ç„¶å¾ˆæ…¢ï¼Œæˆ–è€…ä¸å¯é¿å…åœ°éœ€è¦ä½¿ç”¨å¤§å¾ªç¯ï¼Œè¯·ä½¿ç”¨Cythonç­‰å…¶ä»–åº“æ¥ä½¿å…¶æ›´å¿«ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>å•å±‚æ„ŸçŸ¥å™¨</title>
    <url>/2020/07/09/%E5%8D%95%E5%B1%82%E6%84%9F%E7%9F%A5%E5%99%A8/</url>
    <content><![CDATA[<p>å•å±‚æ„ŸçŸ¥å™¨ä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = np.array([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line">Y = np.array([[<span class="number">-1</span>],[<span class="number">1</span>],[<span class="number">1</span>],[<span class="number">-1</span>]])</span><br><span class="line">W = (np.random.random([<span class="number">3</span>,<span class="number">1</span>])<span class="number">-0.5</span>)*<span class="number">2</span></span><br><span class="line">print(W)</span><br><span class="line">lr = <span class="number">0.11</span></span><br><span class="line">O = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> X,Y,W,lr</span><br><span class="line">    O = np.sign(np.dot(X,W))</span><br><span class="line">    W_C = lr*(X.T.dot(Y-O))/int(X.shape[<span class="number">0</span>])</span><br><span class="line">    W = W + W_C</span><br></pre></td></tr></table></figure>

<pre><code>[[ 0.23015384]
 [-0.72847367]
 [ 0.52092108]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    update()</span><br><span class="line">    O = np.sign(np.dot(X,W))</span><br><span class="line">    <span class="keyword">if</span>(O==Y).all():</span><br><span class="line">        print(<span class="string">'Finished'</span>)</span><br><span class="line">        print(<span class="string">'epoch:'</span>,i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">x1 = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">y1 = [<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">x2 = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">y2 = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">k = -W[<span class="number">1</span>]/W[<span class="number">2</span>]</span><br><span class="line">d = -W[<span class="number">0</span>]/W[<span class="number">2</span>]</span><br><span class="line">print(<span class="string">'k='</span>,k)</span><br><span class="line">print(<span class="string">'d='</span>,d)</span><br><span class="line">xdata = (<span class="number">-2</span>,<span class="number">3</span>)</span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(xdata,xdata*k+d,<span class="string">'r'</span>)</span><br><span class="line">plt.scatter(x1,y1,c=<span class="string">'b'</span>)</span><br><span class="line">plt.scatter(x2,y2,c=<span class="string">'y'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>k= [0.16650386]
d= [-0.80515292]</code></pre><p><img src="/2020/07/09/%E5%8D%95%E5%B1%82%E6%84%9F%E7%9F%A5%E5%99%A8/output_2_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>opencv-GUIç‰¹æ€§</title>
    <url>/2020/07/12/opencv-GUI%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<ul>
<li>1.<a href="#header1">å›¾åƒå…¥é—¨</a></li>
<li>2.<a href="#header2">è§†é¢‘å…¥é—¨</a></li>
<li>3.<a href="#header3">ç»˜å›¾</a></li>
<li>4.<a href="#header4">é¼ æ ‡ä½œä¸ºç”»ç¬”</a></li>
<li>5.<a href="#header5">è½¨è¿¹æ ä½œä¸ºè°ƒè‰²æ¿</a></li>
</ul>
<h1 id="å›¾åƒå…¥é—¨"><a href="#å›¾åƒå…¥é—¨" class="headerlink" title="å›¾åƒå…¥é—¨"></a><span id="header1">å›¾åƒå…¥é—¨</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>åœ¨è¿™é‡Œï¼Œä½ å°†å­¦ä¹ å¦‚ä½•è¯»å–å›¾åƒï¼Œå¦‚ä½•æ˜¾ç¤ºå›¾åƒä»¥åŠå¦‚ä½•å°†å…¶ä¿å­˜å›å»</li>
<li>ä½ å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.imread()ï¼Œcv.imshow()ï¼Œcv.imwrite()</li>
<li>(å¯é€‰)ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨Matplotlibæ˜¾ç¤ºå›¾åƒ<a id="more"></a>


</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<h2 id="è¯»å–å›¾åƒ"><a href="#è¯»å–å›¾åƒ" class="headerlink" title="è¯»å–å›¾åƒ"></a>è¯»å–å›¾åƒ</h2><ul>
<li>ä½¿ç”¨<strong>cv.imread</strong>()å‡½æ•°è¯»å–å›¾åƒã€‚</li>
<li>å›¾åƒåº”è¯¥åœ¨å·¥ä½œç›®å½•æˆ–å›¾åƒçš„å®Œæ•´è·¯å¾„åº”ç»™å‡ºã€‚<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œå®ƒæŒ‡å®šäº†è¯»å–å›¾åƒçš„æ–¹å¼ã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cv.IMREAD_COLORï¼š åŠ è½½å½©è‰²å›¾åƒã€‚ä»»ä½•å›¾åƒçš„é€æ˜åº¦éƒ½ä¼šè¢«å¿½è§†ã€‚å®ƒæ˜¯é»˜è®¤æ ‡å¿—ã€‚</span><br><span class="line">cv.IMREAD_GRAYSCALEï¼šä»¥ç°åº¦æ¨¡å¼åŠ è½½å›¾åƒ</span><br><span class="line">cv.IMREAD_UNCHANGEDï¼šåŠ è½½å›¾åƒï¼ŒåŒ…æ‹¬alphaé€šé“</span><br></pre></td></tr></table></figure>
æ³¨æ„ é™¤äº†è¿™ä¸‰ä¸ªæ ‡å¿—ï¼Œä½ å¯ä»¥åˆ†åˆ«ç®€å•åœ°ä¼ é€’æ•´æ•°1ã€0æˆ–-1ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img=cv.imread(<span class="string">'1.jpg'</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img</span><br></pre></td></tr></table></figure>




<pre><code>array([[181, 247, 251, ..., 203, 177, 170],
       [217, 255, 250, ..., 211, 178, 167],
       [247, 255, 245, ..., 218, 180, 164],
       ...,
       [ 13,  13,  12, ...,   0,  16,   0],
       [ 11,  10,  10, ...,   0,   0,   0],
       [ 17,  17,  16, ...,   0,   4,   0]], dtype=uint8)</code></pre><h2 id="æ˜¾ç¤ºå›¾åƒ"><a href="#æ˜¾ç¤ºå›¾åƒ" class="headerlink" title="æ˜¾ç¤ºå›¾åƒ"></a>æ˜¾ç¤ºå›¾åƒ</h2><ul>
<li>ä½¿ç”¨å‡½æ•°<strong>cv.imshow()</strong>åœ¨çª—å£ä¸­æ˜¾ç¤ºå›¾åƒã€‚çª—å£è‡ªåŠ¨é€‚åˆå›¾åƒå°ºå¯¸ã€‚</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çª—å£åç§°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„å¯¹è±¡ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºä»»æ„å¤šä¸ªçª—å£ï¼Œä½†å¯ä»¥ä½¿ç”¨ä¸åŒçš„çª—å£åç§°ã€‚</li>
</ul>
<p>cv.waitKey()æ˜¯ä¸€ä¸ªé”®ç›˜ç»‘å®šå‡½æ•°ã€‚å…¶å‚æ•°æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´ã€‚</p>
<p>è¯¥å‡½æ•°ç­‰å¾…ä»»ä½•é”®ç›˜äº‹ä»¶æŒ‡å®šçš„æ¯«ç§’ã€‚å¦‚æœæ‚¨åœ¨è¿™æ®µæ—¶é—´å†…æŒ‰ä¸‹ä»»ä½•é”®ï¼Œç¨‹åºå°†ç»§ç»­è¿è¡Œã€‚</p>
<p>å¦‚æœ<strong>0</strong>è¢«ä¼ é€’ï¼Œå®ƒå°†æ— é™æœŸåœ°ç­‰å¾…ä¸€æ¬¡æ•²å‡»é”®ã€‚</p>
<p>å®ƒä¹Ÿå¯ä»¥è®¾ç½®ä¸ºæ£€æµ‹ç‰¹å®šçš„æŒ‰é”®ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæŒ‰ä¸‹é”® a ç­‰</p>
<p>cv.destroyAllWindows()åªä¼šç ´åæˆ‘ä»¬åˆ›å»ºçš„æ‰€æœ‰çª—å£ã€‚</p>
<p>å¦‚æœè¦é”€æ¯ä»»ä½•ç‰¹å®šçš„çª—å£ï¼Œè¯·ä½¿ç”¨å‡½æ•° cv.destroyWindow()åœ¨å…¶ä¸­ä¼ é€’ç¡®åˆ‡çš„çª—å£åç§°ä½œä¸ºå‚æ•°ã€‚</p>
<p>åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºçª—å£ï¼Œç„¶åå†å°†å›¾åƒåŠ è½½åˆ°è¯¥çª—å£ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æŒ‡å®šçª—å£æ˜¯å¦å¯è°ƒæ•´å¤§å°ã€‚</p>
<p>è¿™æ˜¯é€šè¿‡åŠŸèƒ½<strong>cv.namedWindow</strong>()å®Œæˆçš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ ‡å¿—ä¸º<strong>cv.WINDOW_AUTOSIZE</strong>ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœå°†æ ‡å¿—æŒ‡å®šä¸º<strong>cv.WINDOW_NORMAL</strong>ï¼Œåˆ™å¯ä»¥è°ƒæ•´çª—å£å¤§å°ã€‚å½“å›¾åƒå°ºå¯¸è¿‡å¤§ä»¥åŠå‘çª—å£æ·»åŠ è·Ÿè¸ªæ æ—¶ï¼Œè¿™å°†å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv.namedWindow(<span class="string">'image'</span>,cv.WINDOW_NORMAL)</span><br><span class="line">cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="å†™å…¥å›¾åƒ"><a href="#å†™å…¥å›¾åƒ" class="headerlink" title="å†™å…¥å›¾åƒ"></a>å†™å…¥å›¾åƒ</h2><p>ä½¿ç”¨å‡½æ•°<strong>cv.imwrite</strong>()ä¿å­˜å›¾åƒã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ä¿å­˜çš„å›¾åƒã€‚</p>
<p>cv.imwrite(â€˜messigray.pngâ€™ï¼Œimg)è¿™ä¼šå°†å›¾åƒä»¥PNGæ ¼å¼ä¿å­˜åœ¨å·¥ä½œç›®å½•ä¸­ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¨‹åºä¸­ï¼Œä»¥ç°åº¦åŠ è½½å›¾åƒï¼Œæ˜¾ç¤ºå›¾åƒï¼ŒæŒ‰sä¿å­˜å›¾åƒå¹¶é€€å‡ºï¼Œæˆ–è€…æŒ‰ESCé”®ç›´æ¥é€€å‡ºè€Œä¸ä¿å­˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">k =cv.waitKey(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> k == <span class="number">27</span>: <span class="comment"># æŒ‰ä¸‹escæ—¶</span></span><br><span class="line">    cv.destroyAllWindows()</span><br><span class="line"><span class="keyword">elif</span> k == ord(<span class="string">'s'</span>): <span class="comment"># æŒ‰ä¸‹sæ—¶</span></span><br><span class="line">    cv.imwrite(<span class="string">'copy1.jpg'</span>,img)</span><br><span class="line">    cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">img = cv.imread(<span class="string">'1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">plt.imshow(img, interpolation = <span class="string">'bicubic'</span>)</span><br><span class="line"><span class="comment"># plt.imshow(img)</span></span><br><span class="line">plt.xticks([])</span><br><span class="line">plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/12/opencv-GUI%E7%89%B9%E6%80%A7/output_13_0.png" alt="png"></p>
<h1 id="è§†é¢‘å…¥é—¨"><a href="#è§†é¢‘å…¥é—¨" class="headerlink" title="è§†é¢‘å…¥é—¨"></a><span id="header2">è§†é¢‘å…¥é—¨</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>å­¦ä¹ è¯»å–è§†é¢‘ï¼Œæ˜¾ç¤ºè§†é¢‘å’Œä¿å­˜è§†é¢‘ã€‚</li>
<li>å­¦ä¹ ä»ç›¸æœºæ•æ‰å¹¶æ˜¾ç¤ºå®ƒã€‚</li>
<li>ä½ å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.VideoCapture()ï¼Œcv.VideoWriter()<!--more-->

</li>
</ul>
<p>è¦æ•è·è§†é¢‘ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª VideoCapture å¯¹è±¡ã€‚</p>
<p>å®ƒçš„å‚æ•°å¯ä»¥æ˜¯è®¾å¤‡ç´¢å¼•æˆ–è§†é¢‘æ–‡ä»¶çš„åç§°ã€‚è®¾å¤‡ç´¢å¼•å°±æ˜¯æŒ‡å®šå“ªä¸ªæ‘„åƒå¤´çš„æ•°å­—ã€‚</p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ‘„åƒå¤´ä¼šè¢«è¿æ¥(å°±åƒæˆ‘çš„æƒ…å†µä¸€æ ·)ã€‚æ‰€ä»¥æˆ‘ç®€å•åœ°ä¼ 0(æˆ–-1)ã€‚ä½ å¯ä»¥é€šè¿‡ä¼ é€’1æ¥é€‰æ‹©ç¬¬äºŒä¸ªç›¸æœºï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>åœ¨æ­¤ä¹‹åï¼Œä½ å¯ä»¥é€å¸§æ•è·ã€‚ä½†æ˜¯åœ¨æœ€åï¼Œä¸è¦å¿˜è®°é‡Šæ”¾ä¿˜è™ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">cap = cv.VideoCapture(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> cap.isOpened():</span><br><span class="line">    print(<span class="string">"Cannot open camera"</span>)</span><br><span class="line">    exit()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># é€å¸§æ•è·</span></span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="comment"># å¦‚æœæ­£ç¡®è¯»å–å¸§ï¼Œretä¸ºTrue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        print(<span class="string">"Can't receive frame (stream end?). Exiting ..."</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># æˆ‘ä»¬åœ¨æ¡†æ¶ä¸Šçš„æ“ä½œåˆ°è¿™é‡Œ</span></span><br><span class="line">    gray = cv.cvtColor(frame, cv.COLOR_BGR2GRAY)</span><br><span class="line">    <span class="comment"># æ˜¾ç¤ºç»“æœå¸§e</span></span><br><span class="line">    cv.imshow(<span class="string">'frame'</span>, gray)</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">1</span>) == ord(<span class="string">'q'</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># å®Œæˆæ‰€æœ‰æ“ä½œåï¼Œé‡Šæ”¾æ•è·å™¨</span></span><br><span class="line">cap.release()</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<pre><code>Cannot open camera
Can&apos;t receive frame (stream end?). Exiting ...</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">cap = cv.VideoCapture(<span class="string">'video1.flv'</span>)</span><br><span class="line"><span class="keyword">while</span> cap.isOpened():</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="comment"># å¦‚æœæ­£ç¡®è¯»å–å¸§ï¼Œretä¸ºTrue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        print(<span class="string">"Can't receive frame (stream end?). Exiting ..."</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    gray = cv.cvtColor(frame, cv.COLOR_BGR2GRAY)</span><br><span class="line">    cv.imshow(<span class="string">'frame'</span>, gray)</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">1</span>) == ord(<span class="string">'q'</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">cap.release()</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">cap = cv.VideoCapture(<span class="string">'video1.flv'</span>)</span><br><span class="line"><span class="comment"># å®šä¹‰ç¼–è§£ç å™¨å¹¶åˆ›å»ºVideoWriterå¯¹è±¡</span></span><br><span class="line">fourcc = cv.VideoWriter_fourcc(*<span class="string">'DIVX'</span>)</span><br><span class="line">out = cv.VideoWriter(<span class="string">'output.flv'</span>, fourcc, <span class="number">20.0</span>, (<span class="number">640</span>,  <span class="number">480</span>))</span><br><span class="line"><span class="keyword">while</span> cap.isOpened():</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        print(<span class="string">"Can't receive frame (stream end?). Exiting ..."</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    frame = cv.flip(frame, <span class="number">0</span>)</span><br><span class="line">    <span class="comment"># å†™ç¿»è½¬çš„æ¡†æ¶</span></span><br><span class="line">    out.write(frame)</span><br><span class="line">    cv.imshow(<span class="string">'frame'</span>, frame)</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">1</span>) == ord(<span class="string">'q'</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># å®Œæˆå·¥ä½œåé‡Šæ”¾æ‰€æœ‰å†…å®¹</span></span><br><span class="line">cap.release()</span><br><span class="line">out.release()</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<pre><code>Can&apos;t receive frame (stream end?). Exiting ...</code></pre><h1 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a><span id="header3">ç»˜å›¾</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>å­¦ä¹ ä½¿ç”¨OpenCVç»˜åˆ¶ä¸åŒçš„å‡ ä½•å½¢çŠ¶</li>
<li>æ‚¨å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.line()ï¼Œcv.circle()ï¼Œcv.rectangle()ï¼Œcv.ellipse()ï¼Œcv.putText()ç­‰ã€‚</li>
<li>åœ¨ä¸Šè¿°æ‰€æœ‰åŠŸèƒ½ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€äº›å¸¸è§çš„å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">imgï¼šæ‚¨è¦ç»˜åˆ¶å½¢çŠ¶çš„å›¾åƒ</span><br><span class="line">colorï¼šå½¢çŠ¶çš„é¢œè‰²ã€‚å¯¹äºBGRï¼Œå°†å…¶ä½œä¸ºå…ƒç»„ä¼ é€’ï¼Œä¾‹å¦‚ï¼š(255,0,0)å¯¹äºè“è‰²ã€‚å¯¹äºç°åº¦ï¼Œåªéœ€ä¼ é€’æ ‡é‡å€¼å³å¯ã€‚</span><br><span class="line">åšåº¦ï¼šçº¿æˆ–åœ†ç­‰çš„ç²—ç»†ã€‚å¦‚æœå¯¹é—­åˆå›¾å½¢ï¼ˆå¦‚åœ†ï¼‰ä¼ é€’-1 ï¼Œå®ƒå°†å¡«å……å½¢çŠ¶ã€‚é»˜è®¤åšåº¦&#x3D; 1</span><br><span class="line">lineTypeï¼šçº¿çš„ç±»å‹ï¼Œæ˜¯å¦ä¸º8è¿æ¥çº¿ï¼ŒæŠ—é”¯é½¿çº¿ç­‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸º8è¿æ¥çº¿ã€‚**cv.LINE_AA**ç»™å‡ºäº†æŠ—é”¯é½¿çš„çº¿æ¡ï¼Œçœ‹èµ·æ¥éå¸¸é€‚åˆæ›²çº¿ã€‚</span><br></pre></td></tr></table></figure>


</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦ç»˜åˆ¶ä¸€æ¡çº¿ï¼Œæ‚¨éœ€è¦ä¼ é€’çº¿çš„å¼€å§‹å’Œç»“æŸåæ ‡ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªé»‘è‰²å›¾åƒï¼Œå¹¶ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’åœ¨å…¶ä¸Šç»˜åˆ¶ä¸€æ¡è“çº¿ã€‚</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line"><span class="comment"># ç»˜åˆ¶ä¸€æ¡åšåº¦ä¸º5çš„è“è‰²å¯¹è§’çº¿</span></span><br><span class="line">cv.line(img,(<span class="number">0</span>,<span class="number">0</span>),(<span class="number">511</span>,<span class="number">511</span>),(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="number">5</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦ç»˜åˆ¶çŸ©å½¢ï¼Œæ‚¨éœ€è¦çŸ©å½¢çš„å·¦ä¸Šè§’å’Œå³ä¸‹è§’ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å°†åœ¨å›¾åƒçš„å³ä¸Šè§’ç»˜åˆ¶ä¸€ä¸ªç»¿è‰²çŸ©å½¢ã€‚</span></span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.rectangle(img,(<span class="number">384</span>,<span class="number">0</span>),(<span class="number">510</span>,<span class="number">128</span>),(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>),<span class="number">3</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦ç»˜åˆ¶ä¸€ä¸ªåœ†ï¼Œéœ€è¦å…¶ä¸­å¿ƒåæ ‡å’ŒåŠå¾„ã€‚æˆ‘ä»¬å°†åœ¨ä¸Šé¢ç»˜åˆ¶çš„çŸ©å½¢å†…ç»˜åˆ¶ä¸€ä¸ªåœ†ã€‚</span></span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.circle(img,(<span class="number">447</span>,<span class="number">63</span>), <span class="number">63</span>, (<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>), <span class="number">-1</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦ç»˜åˆ¶æ¤­åœ†ï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’å‡ ä¸ªå‚æ•°ã€‚ä¸€ä¸ªå‚æ•°æ˜¯ä¸­å¿ƒä½ç½®ï¼ˆxï¼Œyï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># ä¸‹ä¸€ä¸ªå‚æ•°æ˜¯è½´é•¿åº¦ï¼ˆé•¿è½´é•¿åº¦ï¼ŒçŸ­è½´é•¿åº¦ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># angleæ˜¯æ¤­åœ†æ²¿é€†æ—¶é’ˆæ–¹å‘æ—‹è½¬çš„è§’åº¦ã€‚</span></span><br><span class="line"><span class="comment"># startAngleå’ŒendAngleè¡¨ç¤ºä»ä¸»è½´æ²¿é¡ºæ—¶é’ˆæ–¹å‘æµ‹é‡çš„æ¤­åœ†å¼§çš„å¼€å§‹å’Œç»“æŸã€‚å³ç»™å‡º0å’Œ360ç»™å‡ºå®Œæ•´çš„æ¤­åœ†</span></span><br><span class="line"><span class="comment"># ä¸‹é¢çš„ç¤ºä¾‹åœ¨å›¾åƒçš„ä¸­å¿ƒç»˜åˆ¶ä¸€ä¸ªæ¤­åœ†å½¢ã€‚</span></span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.ellipse(img,(<span class="number">256</span>,<span class="number">256</span>),(<span class="number">100</span>,<span class="number">50</span>),<span class="number">0</span>,<span class="number">0</span>,<span class="number">180</span>,<span class="number">255</span>,<span class="number">-1</span>)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦ç»˜åˆ¶å¤šè¾¹å½¢ï¼Œé¦–å…ˆéœ€è¦é¡¶ç‚¹çš„åæ ‡ã€‚å°†è¿™äº›ç‚¹ç»„æˆå½¢çŠ¶ä¸ºROWSx1x2çš„æ•°ç»„ï¼Œå…¶ä¸­ROWSæ˜¯é¡¶ç‚¹æ•°ï¼Œå¹¶ä¸”å…¶ç±»å‹åº”ä¸ºint32ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»˜åˆ¶äº†ä¸€ä¸ªå¸¦æœ‰å››ä¸ªé¡¶ç‚¹çš„é»„è‰²å°å¤šè¾¹å½¢ã€‚</span></span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">pts = np.array([[<span class="number">10</span>,<span class="number">5</span>],[<span class="number">20</span>,<span class="number">30</span>],[<span class="number">270</span>,<span class="number">20</span>],[<span class="number">150</span>,<span class="number">5</span>]], np.int32)</span><br><span class="line">pts = pts.reshape((<span class="number">-1</span>,<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">cv.polylines(img,[pts],<span class="literal">True</span>,(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºFalseï¼Œæ‚¨å°†è·å¾—ä¸€æ¡è¿æ¥æ‰€æœ‰ç‚¹çš„æŠ˜çº¿ï¼Œè€Œä¸æ˜¯é—­åˆå½¢çŠ¶ã€‚ </span></span><br><span class="line"><span class="comment"># cv.polylines()å¯ç”¨äºç»˜åˆ¶å¤šæ¡çº¿ã€‚åªéœ€åˆ›å»ºè¦ç»˜åˆ¶çš„æ‰€æœ‰çº¿æ¡çš„åˆ—è¡¨ï¼Œç„¶åå°†å…¶ä¼ é€’ç»™å‡½æ•°å³å¯ã€‚</span></span><br><span class="line"><span class="comment"># æ‰€æœ‰çº¿æ¡å°†å•ç‹¬ç»˜åˆ¶ã€‚ä¸ä¸ºæ¯æ¡çº¿è°ƒç”¨**cv.line**ç›¸æ¯”ï¼Œç»˜åˆ¶ä¸€ç»„çº¿æ˜¯ä¸€ç§æ›´å¥½ï¼Œæ›´å¿«çš„æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"># åˆ›å»ºé»‘è‰²çš„å›¾åƒ</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">pts = np.array([[<span class="number">10</span>,<span class="number">5</span>],[<span class="number">20</span>,<span class="number">30</span>],[<span class="number">270</span>,<span class="number">20</span>],[<span class="number">150</span>,<span class="number">5</span>]], np.int32)</span><br><span class="line">pts = pts.reshape((<span class="number">-1</span>,<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">cv.polylines(img,[pts],<span class="literal">False</span>,(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦å°†æ–‡æœ¬æ”¾å…¥å›¾åƒä¸­ï¼Œéœ€è¦æŒ‡å®šä»¥ä¸‹å†…å®¹ã€‚ </span></span><br><span class="line"><span class="comment"># - æ‚¨è¦å†™å…¥çš„æ–‡å­—æ•°æ® </span></span><br><span class="line"><span class="comment"># - æ‚¨è¦æ”¾ç½®å®ƒçš„ä½ç½®åæ ‡ï¼ˆå³æ•°æ®å¼€å§‹çš„å·¦ä¸‹è§’ï¼‰ã€‚ </span></span><br><span class="line"><span class="comment"># - å­—ä½“ç±»å‹ï¼ˆæ£€æŸ¥**cv.putText**æ–‡æ¡£ä»¥è·å–å—æ”¯æŒçš„å­—ä½“ï¼‰</span></span><br><span class="line"><span class="comment"># - å­—ä½“æ¯”ä¾‹ï¼ˆæŒ‡å®šå­—ä½“å¤§å°ï¼‰ </span></span><br><span class="line"><span class="comment"># - å¸¸è§„çš„å†…å®¹ï¼Œä¾‹å¦‚é¢œè‰²ï¼Œåšåº¦ï¼Œçº¿æ¡ç±»å‹ç­‰ã€‚ä¸ºäº†è·å¾—æ›´å¥½çš„å¤–è§‚ï¼Œå»ºè®®ä½¿ç”¨lineType = cv.LINE_AAã€‚</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">font = cv.FONT_HERSHEY_SIMPLEX</span><br><span class="line">cv.putText(img,<span class="string">'OpenCV'</span>,(<span class="number">10</span>,<span class="number">500</span>), font, <span class="number">4</span>,(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>),<span class="number">2</span>,cv.LINE_AA)</span><br><span class="line">cv.imshow(<span class="string">'img'</span>,img)</span><br><span class="line">cv.waitKey(<span class="number">0</span>)</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<h1 id="é¼ æ ‡ä½œä¸ºç”»ç¬”"><a href="#é¼ æ ‡ä½œä¸ºç”»ç¬”" class="headerlink" title="é¼ æ ‡ä½œä¸ºç”»ç¬”"></a><span id="header4">é¼ æ ‡ä½œä¸ºç”»ç¬”</span></h1><h2 id="ç›®æ ‡-3"><a href="#ç›®æ ‡-3" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>äº†è§£å¦‚ä½•åœ¨OpenCVä¸­å¤„ç†é¼ æ ‡äº‹ä»¶</li>
<li>æ‚¨å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.setMouseCallback()</li>
</ul>
<p>ç®€å•æ¼”ç¤º<br>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œæ— è®ºæˆ‘ä»¬åœ¨å“ªé‡ŒåŒå‡»å®ƒï¼Œéƒ½å¯ä»¥åœ¨å›¾åƒä¸Šç»˜åˆ¶ä¸€ä¸ªåœ†ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé¼ æ ‡å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨å‘ç”Ÿé¼ æ ‡äº‹ä»¶æ—¶æ‰§è¡Œã€‚</p>
<p>é¼ æ ‡äº‹ä»¶å¯ä»¥æ˜¯ä¸é¼ æ ‡ç›¸å…³çš„ä»»ä½•äº‹ç‰©ï¼Œä¾‹å¦‚å·¦é”®æŒ‰ä¸‹ï¼Œå·¦é”®æŒ‰ä¸‹ï¼Œå·¦é”®åŒå‡»ç­‰ã€‚</p>
<p>å®ƒä¸ºæˆ‘ä»¬æä¾›äº†æ¯ä¸ªé¼ æ ‡äº‹ä»¶çš„åæ ‡(xï¼Œy)ã€‚é€šè¿‡æ­¤æ´»åŠ¨å’Œåœ°ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åšä»»ä½•æˆ‘ä»¬å–œæ¬¢çš„äº‹æƒ…ã€‚</p>
<p>è¦åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å¯ç”¨äº‹ä»¶ï¼Œè¯·åœ¨Pythonç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">events = [i <span class="keyword">for</span> i <span class="keyword">in</span> dir(cv) <span class="keyword">if</span> <span class="string">'EVENT'</span> <span class="keyword">in</span> i]</span><br><span class="line">print( events )</span><br></pre></td></tr></table></figure>

<pre><code>[&apos;EVENT_FLAG_ALTKEY&apos;, &apos;EVENT_FLAG_CTRLKEY&apos;, &apos;EVENT_FLAG_LBUTTON&apos;, &apos;EVENT_FLAG_MBUTTON&apos;, &apos;EVENT_FLAG_RBUTTON&apos;, &apos;EVENT_FLAG_SHIFTKEY&apos;, &apos;EVENT_LBUTTONDBLCLK&apos;, &apos;EVENT_LBUTTONDOWN&apos;, &apos;EVENT_LBUTTONUP&apos;, &apos;EVENT_MBUTTONDBLCLK&apos;, &apos;EVENT_MBUTTONDOWN&apos;, &apos;EVENT_MBUTTONUP&apos;, &apos;EVENT_MOUSEHWHEEL&apos;, &apos;EVENT_MOUSEMOVE&apos;, &apos;EVENT_MOUSEWHEEL&apos;, &apos;EVENT_RBUTTONDBLCLK&apos;, &apos;EVENT_RBUTTONDOWN&apos;, &apos;EVENT_RBUTTONUP&apos;]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨æˆ‘ä»¬åŒå‡»çš„åœ°æ–¹ç»˜åˆ¶ä¸€ä¸ªåœ†åœˆ</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="comment"># é¼ æ ‡å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw_circle</span><span class="params">(event,x,y,flags,param)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> event == cv.EVENT_LBUTTONDBLCLK:</span><br><span class="line">        cv.circle(img,(x,y),<span class="number">100</span>,(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="number">-1</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªé»‘è‰²çš„å›¾åƒï¼Œä¸€ä¸ªçª—å£ï¼Œå¹¶ç»‘å®šåˆ°çª—å£çš„åŠŸèƒ½</span></span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.namedWindow(<span class="string">'image'</span>)</span><br><span class="line">cv.setMouseCallback(<span class="string">'image'</span>,draw_circle)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">20</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‰mä¹‹å‰æ‹–æ‹½ç”»é’è‰²çŸ©å½¢</span></span><br><span class="line"><span class="comment"># æŒ‰mä¹‹åæ‹–æ‹½ç”»çº¢è‰²ç›´çº¿</span></span><br><span class="line"><span class="comment"># æŒ‰escé€€å‡º</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line">drawing = <span class="literal">False</span> <span class="comment"># å¦‚æœæŒ‰ä¸‹é¼ æ ‡ï¼Œåˆ™ä¸ºçœŸ</span></span><br><span class="line">mode = <span class="literal">True</span> <span class="comment"># å¦‚æœä¸ºçœŸï¼Œç»˜åˆ¶çŸ©å½¢ã€‚æŒ‰ m é”®å¯ä»¥åˆ‡æ¢åˆ°æ›²çº¿</span></span><br><span class="line">ix,iy = <span class="number">-1</span>,<span class="number">-1</span></span><br><span class="line"><span class="comment"># é¼ æ ‡å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw_circle</span><span class="params">(event,x,y,flags,param)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> ix,iy,drawing,mode</span><br><span class="line">    <span class="keyword">if</span> event == cv.EVENT_LBUTTONDOWN:</span><br><span class="line">        drawing = <span class="literal">True</span></span><br><span class="line">        ix,iy = x,y</span><br><span class="line">    <span class="keyword">elif</span> event == cv.EVENT_MOUSEMOVE:</span><br><span class="line">        <span class="keyword">if</span> drawing == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> mode == <span class="literal">True</span>:</span><br><span class="line">                cv.rectangle(img,(ix,iy),(x,y),(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>),<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cv.circle(img,(x,y),<span class="number">25</span>,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> event == cv.EVENT_LBUTTONUP:</span><br><span class="line">        drawing = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> mode == <span class="literal">True</span>:</span><br><span class="line">            cv.rectangle(img,(ix,iy),(x,y),(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>),<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cv.circle(img,(x,y),<span class="number">25</span>,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">-1</span>)</span><br><span class="line">            </span><br><span class="line">img = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.namedWindow(<span class="string">'image'</span>)</span><br><span class="line">cv.setMouseCallback(<span class="string">'image'</span>,draw_circle)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">20</span>) &amp; cv.waitKey(<span class="number">20</span>) == ord(<span class="string">'m'</span>):</span><br><span class="line">        mode = ~mode</span><br><span class="line">    <span class="keyword">if</span> cv.waitKey(<span class="number">20</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h1 id="è½¨è¿¹æ ä½œä¸ºè°ƒè‰²æ¿"><a href="#è½¨è¿¹æ ä½œä¸ºè°ƒè‰²æ¿" class="headerlink" title="è½¨è¿¹æ ä½œä¸ºè°ƒè‰²æ¿"></a><span id="header5">è½¨è¿¹æ ä½œä¸ºè°ƒè‰²æ¿</span></h1><h2 id="ç›®æ ‡-4"><a href="#ç›®æ ‡-4" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>äº†è§£å°†è½¨è¿¹æ å›ºå®šåˆ°OpenCVçª—å£</li>
<li>æ‚¨å°†å­¦ä¹ ä»¥ä¸‹åŠŸèƒ½ï¼šcv.getTrackbarPosï¼Œ<strong>cv.createTrackbar</strong>ç­‰ã€‚</li>
</ul>
<p>å¯¹äºcv.getTrackbarPos()å‡½æ•°ï¼Œ</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è½¨è¿¹æ åç§°ï¼Œ</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯å®ƒé™„åŠ åˆ°çš„çª—å£åç§°ï¼Œ</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é»˜è®¤å€¼ï¼Œ</p>
<p>ç¬¬å››ä¸ªå‚æ•°æ˜¯æœ€å¤§å€¼ï¼Œ</p>
<p>ç¬¬äº”ä¸ªæ˜¯æ‰§è¡Œçš„å›è°ƒå‡½æ•°æ¯æ¬¡è·Ÿè¸ªæ å€¼æ›´æ”¹ã€‚</p>
<p>å›è°ƒå‡½æ•°å§‹ç»ˆå…·æœ‰é»˜è®¤å‚æ•°ï¼Œå³è½¨è¿¹æ ä½ç½®ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå‡½æ•°ä»€ä¹ˆéƒ½ä¸åšï¼Œæ‰€ä»¥æˆ‘ä»¬ç®€å•åœ°é€šè¿‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä»¥æ˜¾ç¤ºæ‚¨æŒ‡å®šçš„é¢œè‰²ã€‚</span></span><br><span class="line"><span class="comment"># æ‚¨æœ‰ä¸€ä¸ªæ˜¾ç¤ºé¢œè‰²çš„çª—å£ï¼Œä»¥åŠä¸‰ä¸ªç”¨äºæŒ‡å®šBã€Gã€Ré¢œè‰²çš„è·Ÿè¸ªæ ã€‚æ»‘åŠ¨è½¨è¿¹æ ï¼Œå¹¶ç›¸åº”åœ°æ›´æ”¹çª—å£é¢œè‰²ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆå§‹é¢œè‰²å°†è®¾ç½®ä¸ºé»‘è‰²ã€‚åªæœ‰åœ¨è¯¥å¼€å…³ä¸ºONçš„æƒ…å†µä¸‹ï¼Œè¯¥åº”ç”¨ç¨‹åºæ‰èƒ½åœ¨å…¶ä¸­è¿è¡Œï¼Œå¦åˆ™å±å¹•å§‹ç»ˆä¸ºé»‘è‰²ã€‚</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nothing</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªé»‘è‰²çš„å›¾åƒï¼Œä¸€ä¸ªçª—å£</span></span><br><span class="line">img = np.zeros((<span class="number">300</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv.namedWindow(<span class="string">'image'</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºé¢œè‰²å˜åŒ–çš„è½¨è¿¹æ </span></span><br><span class="line">cv.createTrackbar(<span class="string">'R'</span>,<span class="string">'image'</span>,<span class="number">0</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv.createTrackbar(<span class="string">'G'</span>,<span class="string">'image'</span>,<span class="number">0</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv.createTrackbar(<span class="string">'B'</span>,<span class="string">'image'</span>,<span class="number">0</span>,<span class="number">255</span>,nothing)</span><br><span class="line"><span class="comment"># ä¸º ON/OFF åŠŸèƒ½åˆ›å»ºå¼€å…³</span></span><br><span class="line">switch = <span class="string">'0 : OFF \n1 : ON'</span></span><br><span class="line">cv.createTrackbar(switch, <span class="string">'image'</span>,<span class="number">0</span>,<span class="number">1</span>,nothing)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    cv.imshow(<span class="string">'image'</span>,img)</span><br><span class="line">    k = cv.waitKey(<span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># å¾—åˆ°å››æ¡è½¨è¿¹çš„å½“å‰ä½ç½®</span></span><br><span class="line">    r = cv.getTrackbarPos(<span class="string">'R'</span>,<span class="string">'image'</span>)</span><br><span class="line">    g = cv.getTrackbarPos(<span class="string">'G'</span>,<span class="string">'image'</span>)</span><br><span class="line">    b = cv.getTrackbarPos(<span class="string">'B'</span>,<span class="string">'image'</span>)</span><br><span class="line">    s = cv.getTrackbarPos(switch,<span class="string">'image'</span>)</span><br><span class="line">    <span class="keyword">if</span> s == <span class="number">0</span>:</span><br><span class="line">        img[:] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        img[:] = [b,g,r]</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>å²­å›å½’</title>
    <url>/2020/07/11/%E5%B2%AD%E5%9B%9E%E5%BD%92/</url>
    <content><![CDATA[<p><a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/longley.csv" target="_blank" rel="noopener">longley.csv</a></p>
<a id="more"></a>
<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%991.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%992.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%993.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%994.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%995.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%996.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%997.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%998.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%999.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%9910.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%9911.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%9912.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%9913.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%AD%A3%E5%88%9914.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = genfromtxt(<span class="string">'./data/longley.csv'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>

<pre><code>[[     nan      nan      nan      nan      nan      nan      nan      nan]
 [     nan   83.     234.289  235.6    159.     107.608 1947.      60.323]
 [     nan   88.5    259.426  232.5    145.6    108.632 1948.      61.122]
 [     nan   88.2    258.054  368.2    161.6    109.773 1949.      60.171]
 [     nan   89.5    284.599  335.1    165.     110.929 1950.      61.187]
 [     nan   96.2    328.975  209.9    309.9    112.075 1951.      63.221]
 [     nan   98.1    346.999  193.2    359.4    113.27  1952.      63.639]
 [     nan   99.     365.385  187.     354.7    115.094 1953.      64.989]
 [     nan  100.     363.112  357.8    335.     116.219 1954.      63.761]
 [     nan  101.2    397.469  290.4    304.8    117.388 1955.      66.019]
 [     nan  104.6    419.18   282.2    285.7    118.734 1956.      67.857]
 [     nan  108.4    442.769  293.6    279.8    120.445 1957.      68.169]
 [     nan  110.8    444.546  468.1    263.7    121.95  1958.      66.513]
 [     nan  112.6    482.704  381.3    255.2    123.366 1959.      68.655]
 [     nan  114.2    502.601  393.1    251.4    125.368 1960.      69.564]
 [     nan  115.7    518.173  480.6    257.2    127.852 1961.      69.331]
 [     nan  116.9    554.894  400.7    282.7    130.081 1962.      70.551]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_data = data[<span class="number">1</span>:,<span class="number">2</span>:]</span><br><span class="line">y_data = data[<span class="number">1</span>:,<span class="number">1</span>,np.newaxis]</span><br><span class="line">print(x_data)</span><br><span class="line">print(y_data)</span><br></pre></td></tr></table></figure>

<pre><code>[[ 234.289  235.6    159.     107.608 1947.      60.323]
 [ 259.426  232.5    145.6    108.632 1948.      61.122]
 [ 258.054  368.2    161.6    109.773 1949.      60.171]
 [ 284.599  335.1    165.     110.929 1950.      61.187]
 [ 328.975  209.9    309.9    112.075 1951.      63.221]
 [ 346.999  193.2    359.4    113.27  1952.      63.639]
 [ 365.385  187.     354.7    115.094 1953.      64.989]
 [ 363.112  357.8    335.     116.219 1954.      63.761]
 [ 397.469  290.4    304.8    117.388 1955.      66.019]
 [ 419.18   282.2    285.7    118.734 1956.      67.857]
 [ 442.769  293.6    279.8    120.445 1957.      68.169]
 [ 444.546  468.1    263.7    121.95  1958.      66.513]
 [ 482.704  381.3    255.2    123.366 1959.      68.655]
 [ 502.601  393.1    251.4    125.368 1960.      69.564]
 [ 518.173  480.6    257.2    127.852 1961.      69.331]
 [ 554.894  400.7    282.7    130.081 1962.      70.551]]
[[ 83. ]
 [ 88.5]
 [ 88.2]
 [ 89.5]
 [ 96.2]
 [ 98.1]
 [ 99. ]
 [100. ]
 [101.2]
 [104.6]
 [108.4]
 [110.8]
 [112.6]
 [114.2]
 [115.7]
 [116.9]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(np.mat(x_data).shape)</span><br><span class="line">print(np.mat(y_data).shape)</span><br><span class="line">X_data = np.concatenate((np.ones((<span class="number">16</span>,<span class="number">1</span>)),x_data),axis=<span class="number">1</span>)</span><br><span class="line">print(X_data.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(16, 6)
(16, 1)
(16, 7)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(X_data[:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[[1.00000e+00 2.34289e+02 2.35600e+02 1.59000e+02 1.07608e+02 1.94700e+03
  6.03230e+01]
 [1.00000e+00 2.59426e+02 2.32500e+02 1.45600e+02 1.08632e+02 1.94800e+03
  6.11220e+01]
 [1.00000e+00 2.58054e+02 3.68200e+02 1.61600e+02 1.09773e+02 1.94900e+03
  6.01710e+01]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">weights</span><span class="params">(xArr,yArr,lam=<span class="number">0.2</span>)</span>:</span></span><br><span class="line">    xMat = np.mat(xArr)</span><br><span class="line">    yMat = np.mat(yArr)</span><br><span class="line">    xTx = xMat.T*xMat</span><br><span class="line">    rxTx = xTx +np.eye(xMat.shape[<span class="number">1</span>])*lam</span><br><span class="line">    <span class="keyword">if</span> np.linalg.det(rxTx) == <span class="number">0.0</span>:</span><br><span class="line">        print(<span class="string">'This martix cannot do inverse'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    ws = rxTx.I*xMat.T*yMat</span><br><span class="line">    <span class="keyword">return</span> ws</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws = weights(X_data,y_data)</span><br><span class="line">print(ws)</span><br></pre></td></tr></table></figure>

<pre><code>[[ 7.38107363e-04]
 [ 2.07703836e-01]
 [ 2.10076376e-02]
 [ 5.05385441e-03]
 [-1.59173066e+00]
 [ 1.10442920e-01]
 [-2.42280461e-01]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.mat(X_data)* np.mat(ws)</span><br></pre></td></tr></table></figure>




<pre><code>matrix([[ 83.55075226],
        [ 86.92588689],
        [ 88.09720227],
        [ 90.95677622],
        [ 96.06951002],
        [ 97.81955375],
        [ 98.36444357],
        [ 99.99814266],
        [103.26832266],
        [105.03165135],
        [107.45224671],
        [109.52190685],
        [112.91863666],
        [113.98357055],
        [115.29845063],
        [117.64279933]])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>çº¿æ€§å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¢¯åº¦ä¸‹é™æ³•</title>
    <url>/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/</url>
    <content><![CDATA[<p>çº¿æ€§å›å½’æ¢¯åº¦ä¸‹é™ä»£ç ç®€å•æ¼”ç¤º</p>
<p>æ•°æ®é›†ä¸‹è½½:<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/data.csv" target="_blank" rel="noopener">data.csv</a></p>
<a id="more"></a>
<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%951.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%952.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%953.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%954.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%955.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%956.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%957.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%958.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%959.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9510.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9511.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9512.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9513.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9514.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9515.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9516.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%9517.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = np.genfromtxt(<span class="string">'./data/data.csv'</span>,delimiter=<span class="string">","</span>)</span><br><span class="line">x_data = data[:,<span class="number">0</span>]</span><br><span class="line">y_data = data[:,<span class="number">1</span>]</span><br><span class="line">plt.scatter(x_data,y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_2_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lr = <span class="number">0.0001</span></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">epochs = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_error</span><span class="params">(b,k,x_data,y_data)</span>:</span></span><br><span class="line">    totalError = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x_data)):</span><br><span class="line">        totalError += (y_data[i]-(k*x_data[i]+b))**<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> totalError/float(len(x_data))/<span class="number">2.0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent_runner</span><span class="params">(x_data,y_data,b,k,lr,epochs)</span>:</span></span><br><span class="line">    m = float(len(x_data))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(epochs):</span><br><span class="line">        b_grad = <span class="number">0</span></span><br><span class="line">        k_grad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(x_data)):</span><br><span class="line">            b_grad += (<span class="number">1</span>/m)*(((k*x_data[j])+b)-y_data[j])</span><br><span class="line">            k_grad += (<span class="number">1</span>/m)*x_data[j]*(((k*x_data[j])+b)-y_data[j])</span><br><span class="line">        b = b-(lr*b_grad)</span><br><span class="line">        k = k-(lr*k_grad)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">10</span>==<span class="number">0</span>:</span><br><span class="line">            print(<span class="string">"epochs:"</span>,i)</span><br><span class="line">            plt.plot(x_data,y_data,<span class="string">'b.'</span>)</span><br><span class="line">            plt.plot(x_data, k*x_data+b, <span class="string">'r'</span>)</span><br><span class="line">            plt.show()</span><br><span class="line">    <span class="keyword">return</span> b,k</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(<span class="string">"Starting b = &#123;0&#125;, k = &#123;1&#125;, error = &#123;2&#125;"</span>.format(b, k, compute_error(b, k, x_data, y_data)))</span><br><span class="line">print(<span class="string">"Running..."</span>)</span><br><span class="line">b, k = gradient_descent_runner(x_data, y_data, b, k, lr, epochs)</span><br><span class="line">print(<span class="string">"After &#123;0&#125; iterations b = &#123;1&#125;, k = &#123;2&#125;, error = &#123;3&#125;"</span>.format(epochs, b, k, compute_error(b, k, x_data, y_data)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»å›¾</span></span><br><span class="line">plt.plot(x_data, y_data, <span class="string">'b.'</span>)</span><br><span class="line">plt.plot(x_data, k*x_data + b, <span class="string">'r'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>Starting b = 0, k = 0, error = 2782.5539172416056
Running...
epochs: 0</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_1.png" alt="png"></p>
<pre><code>epochs: 10</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_3.png" alt="png"></p>
<pre><code>epochs: 20</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_5.png" alt="png"></p>
<pre><code>epochs: 30</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_7.png" alt="png"></p>
<pre><code>epochs: 40</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_9.png" alt="png"></p>
<pre><code>After 50 iterations b = 0.030569950649287983, k = 1.4788903781318357, error = 56.32488184238028</code></pre><p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/output_4_11.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x0,x1 = np.meshgrid([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">4</span>,<span class="number">5</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x0</span><br></pre></td></tr></table></figure>




<pre><code>array([[1, 2, 3, 4],
       [1, 2, 3, 4]])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x1</span><br></pre></td></tr></table></figure>




<pre><code>array([[4, 4, 4, 4],
       [5, 5, 5, 5]])</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>æ ‡å‡†æ–¹ç¨‹æ³•</title>
    <url>/2020/07/11/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%95/</url>
    <content><![CDATA[<p>æ ‡å‡†æ–¹ç¨‹æ³•æ±‚çº¿æ€§å›å½’ä»£ç å±•ç¤º:<br>æ•°æ®é›†ä¸‹è½½<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/data.csv" target="_blank" rel="noopener">data</a></p>
<a id="more"></a>

<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%951.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%952.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%953.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%954.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%955.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%956.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%957.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%958.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data =np.genfromtxt(<span class="string">'./data/data.csv'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line">x_data = data[:,<span class="number">0</span>,np.newaxis]</span><br><span class="line">y_data = data[:,<span class="number">1</span>,np.newaxis]</span><br><span class="line">plt.scatter(x_data,y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/11/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%95/output_2_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(np.mat(x_data).shape)</span><br><span class="line">print(np.mat(y_data).shape)</span><br><span class="line">X_data = np.concatenate((np.ones((<span class="number">100</span>,<span class="number">1</span>)),x_data),axis=<span class="number">1</span>)</span><br><span class="line">print(X_data.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(100, 1)
(100, 1)
(100, 2)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(X_data[:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[[ 1.         32.50234527]
 [ 1.         53.42680403]
 [ 1.         61.53035803]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">weights</span><span class="params">(xArr,yArr)</span>:</span></span><br><span class="line">    xMat = np.mat(xArr)</span><br><span class="line">    yMat = np.mat(yArr)</span><br><span class="line">    xTx = xMat.T*xMat</span><br><span class="line">    <span class="keyword">if</span> np.linalg.det(xTx) ==<span class="number">0.0</span>:</span><br><span class="line">        print(<span class="string">'This martix cannot do inverse'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    ws = xTx.I*xMat.T*yMat</span><br><span class="line">    <span class="keyword">return</span> ws</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws = weights(X_data,y_data)</span><br><span class="line">print(ws)</span><br></pre></td></tr></table></figure>

<pre><code>[[7.99102098]
 [1.32243102]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_test = np.array([[<span class="number">20</span>],[<span class="number">80</span>]])</span><br><span class="line">y_test = ws[<span class="number">0</span>]+x_test*ws[<span class="number">1</span>]</span><br><span class="line">plt.plot(x_data,y_data,<span class="string">'b.'</span>)</span><br><span class="line">plt.plot(x_test,y_test,<span class="string">'r'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/11/%E6%A0%87%E5%87%86%E6%96%B9%E7%A8%8B%E6%B3%95/output_7_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>çº¿æ€§å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¢¯åº¦ä¸‹é™æ³•â€”â€”â€”å¤šå…ƒ</title>
    <url>/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95%E2%80%94%E2%80%94%E2%80%94%E5%A4%9A%E5%85%83/</url>
    <content><![CDATA[<p>çº¿æ€§å›å½’å¤šå…ƒæ¢¯åº¦ä¸‹é™ä»£ç ç®€å•æ¼”ç¤º</p>
<p>æ•°æ®é›†ä¸‹è½½:<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/Delivery.csv" target="_blank" rel="noopener">Delivery.csv</a></p>
<a id="more"></a>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = genfromtxt(<span class="string">'./data/Delivery.csv'</span>, delimiter=<span class="string">","</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>

<pre><code>[[100.    4.    9.3]
 [ 50.    3.    4.8]
 [100.    4.    8.9]
 [100.    2.    6.5]
 [ 50.    2.    4.2]
 [ 80.    2.    6.2]
 [ 75.    3.    7.4]
 [ 65.    4.    6. ]
 [ 90.    3.    7.6]
 [ 90.    2.    6.1]]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_data = data[:,:<span class="number">-1</span>]</span><br><span class="line">y_data = data[:,<span class="number">-1</span>]</span><br><span class="line">print(x_data)</span><br><span class="line">print(y_data)</span><br></pre></td></tr></table></figure>

<pre><code>[[100.   4.]
 [ 50.   3.]
 [100.   4.]
 [100.   2.]
 [ 50.   2.]
 [ 80.   2.]
 [ 75.   3.]
 [ 65.   4.]
 [ 90.   3.]
 [ 90.   2.]]
[9.3 4.8 8.9 6.5 4.2 6.2 7.4 6.  7.6 6.1]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lr = <span class="number">0.0001</span></span><br><span class="line">theta0 = <span class="number">0</span></span><br><span class="line">theta1 = <span class="number">0</span></span><br><span class="line">theta2 = <span class="number">0</span></span><br><span class="line">epochs = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_error</span><span class="params">(theta0,theta1,theta2,x_data,y_data)</span>:</span></span><br><span class="line">    totalError = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x_data)):</span><br><span class="line">        totalError += (y_data[i]-(theta1*x_data[i,<span class="number">0</span>]+theta2*x_data[i,<span class="number">1</span>]+theta0))**<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> totalError/float(len(x_data))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent_runner</span><span class="params">(x_data,y_data,theta0,theta1,theta2,lr,epochs)</span>:</span></span><br><span class="line">    m = float(len(x_data))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(epochs):</span><br><span class="line">        theta0_grad = <span class="number">0</span></span><br><span class="line">        theta1_grad = <span class="number">0</span></span><br><span class="line">        theta2_grad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(x_data)):</span><br><span class="line">            theta0_grad+=(<span class="number">1</span>/m)*((theta1*x_data[j,<span class="number">0</span>]+theta2*x_data[j,<span class="number">1</span>]))</span><br><span class="line">            theta1_grad+=(<span class="number">1</span>/m)*x_data[j,<span class="number">0</span>]*((theta1*x_data[j,<span class="number">0</span>]+theta2*x_data[j,<span class="number">1</span>]+theta0)-y_data[j])</span><br><span class="line">            theta2_grad+=(<span class="number">1</span>/m)*x_data[j,<span class="number">1</span>]*((theta1*x_data[j,<span class="number">0</span>]+theta2*x_data[j,<span class="number">1</span>]+theta0)-y_data[j])</span><br><span class="line">            theta0 = theta0-(lr*theta0_grad)</span><br><span class="line">            theta1 = theta1-(lr*theta1_grad)</span><br><span class="line">            theta2 = theta2-(lr*theta2_grad)</span><br><span class="line">    <span class="keyword">return</span> theta0,theta1,theta2</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax = plt.figure().add_subplot(<span class="number">111</span>,projection=<span class="string">'3d'</span>)</span><br><span class="line">ax.scatter(x_data[:,<span class="number">0</span>],x_data[:,<span class="number">1</span>],y_data,c=<span class="string">'r'</span>,marker=<span class="string">'o'</span>,s=<span class="number">100</span>)</span><br><span class="line">x0=x_data[:,<span class="number">0</span>]</span><br><span class="line">x1=x_data[:,<span class="number">1</span>]</span><br><span class="line">x0,x1 = np.meshgrid(x0,x1)</span><br><span class="line">z = theta0+x0*theta1+x1*theta2</span><br><span class="line"></span><br><span class="line">ax.plot_surface(x0,x1,z)</span><br><span class="line">ax.set_xlabel(<span class="string">'Miles'</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">'Num of Deliveries'</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">'Time'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/10/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95%E2%80%94%E2%80%94%E2%80%94%E5%A4%9A%E5%85%83/output_4_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>è´å¶æ–¯å•è¯æ‹¼å†™å™¨</title>
    <url>/2020/07/11/%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%8D%95%E8%AF%8D%E6%8B%BC%E5%86%99%E5%99%A8/</url>
    <content><![CDATA[<p>è´å¶æ–¯å•è¯æ‹¼å†™å™¨ä»£ç :<br>æ•°æ®é›†ä¸‹è½½:<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/big.txt" target="_blank" rel="noopener">big.txt</a></p>
<a id="more"></a>
<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF3.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF4.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF5.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF6.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF7.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF8.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF9.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF10.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF11.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF12.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF13.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF14.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF15.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF16.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF17.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF18.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF19.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = open(<span class="string">'./data/big.txt'</span>).read()</span><br><span class="line">text = re.findall(<span class="string">'[a-z]+'</span>, text.lower())</span><br><span class="line">dic_words = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> text:</span><br><span class="line">    dic_words[t]=dic_words.get(t,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">dic_words</span><br></pre></td></tr></table></figure>




<pre><code>{&apos;the&apos;: 80030,
 &apos;project&apos;: 288,
 &apos;gutenberg&apos;: 263,
 &apos;ebook&apos;: 87,
 &apos;of&apos;: 40025,
 &apos;adventures&apos;: 17,
 &apos;sherlock&apos;: 101,
 &apos;holmes&apos;: 467,
 &apos;by&apos;: 6738,
 &apos;sir&apos;: 177,
 &apos;arthur&apos;: 34,
 &apos;conan&apos;: 4,
 &apos;doyle&apos;: 5,
 &apos;in&apos;: 22047,
 &apos;our&apos;: 1066,
 &apos;series&apos;: 128,
 &apos;copyright&apos;: 69,
 &apos;laws&apos;: 233,
 &apos;are&apos;: 3630,
 &apos;changing&apos;: 44,
 &apos;all&apos;: 4144,
 &apos;over&apos;: 1282,
 &apos;world&apos;: 362,
 &apos;be&apos;: 6155,
 &apos;sure&apos;: 123,
 &apos;to&apos;: 28766,
 &apos;check&apos;: 38,
 &apos;for&apos;: 6939,
 &apos;your&apos;: 1279,
 &apos;country&apos;: 423,
 &apos;before&apos;: 1363,
 &apos;downloading&apos;: 5,
 &apos;or&apos;: 5352,
 &apos;redistributing&apos;: 7,
 &apos;this&apos;: 4063,
 &apos;any&apos;: 1204,
 &apos;other&apos;: 1502,
 &apos;header&apos;: 7,
 &apos;should&apos;: 1297,
 &apos;first&apos;: 1177,
 &apos;thing&apos;: 303,
 &apos;seen&apos;: 444,
 &apos;when&apos;: 2923,
 &apos;viewing&apos;: 7,
 &apos;file&apos;: 21,
 &apos;please&apos;: 172,
 &apos;do&apos;: 1503,
 &apos;not&apos;: 6625,
 &apos;remove&apos;: 53,
 &apos;it&apos;: 10681,
 &apos;change&apos;: 150,
 &apos;edit&apos;: 4,
 &apos;without&apos;: 1015,
 &apos;written&apos;: 117,
 &apos;permission&apos;: 52,
 &apos;read&apos;: 218,
 &apos;legal&apos;: 52,
 &apos;small&apos;: 527,
 &apos;print&apos;: 47,
 &apos;and&apos;: 38312,
 &apos;information&apos;: 73,
 &apos;about&apos;: 1497,
 &apos;at&apos;: 6791,
 &apos;bottom&apos;: 42,
 &apos;included&apos;: 43,
 &apos;is&apos;: 9774,
 &apos;important&apos;: 285,
 &apos;specific&apos;: 37,
 &apos;rights&apos;: 168,
 &apos;restrictions&apos;: 23,
 &apos;how&apos;: 1315,
 &apos;may&apos;: 2551,
 &apos;used&apos;: 276,
 &apos;you&apos;: 5622,
 &apos;can&apos;: 1095,
 &apos;also&apos;: 778,
 &apos;find&apos;: 294,
 &apos;out&apos;: 1987,
 &apos;make&apos;: 504,
 &apos;a&apos;: 21155,
 &apos;donation&apos;: 10,
 &apos;get&apos;: 468,
 &apos;involved&apos;: 107,
 &apos;welcome&apos;: 18,
 &apos;free&apos;: 421,
 &apos;plain&apos;: 108,
 &apos;vanilla&apos;: 6,
 &apos;electronic&apos;: 58,
 &apos;texts&apos;: 7,
 &apos;ebooks&apos;: 54,
 &apos;readable&apos;: 13,
 &apos;both&apos;: 529,
 &apos;humans&apos;: 2,
 &apos;computers&apos;: 7,
 &apos;since&apos;: 260,
 &apos;these&apos;: 1231,
 &apos;were&apos;: 4289,
 &apos;prepared&apos;: 138,
 &apos;thousands&apos;: 93,
 &apos;volunteers&apos;: 22,
 &apos;title&apos;: 39,
 &apos;author&apos;: 29,
 &apos;release&apos;: 28,
 &apos;date&apos;: 48,
 &apos;march&apos;: 135,
 &apos;most&apos;: 908,
 &apos;recently&apos;: 30,
 &apos;updated&apos;: 4,
 &apos;november&apos;: 41,
 &apos;edition&apos;: 21,
 &apos;language&apos;: 61,
 &apos;english&apos;: 211,
 &apos;character&apos;: 174,
 &apos;set&apos;: 324,
 &apos;encoding&apos;: 5,
 &apos;ascii&apos;: 11,
 &apos;start&apos;: 67,
 &apos;additional&apos;: 30,
 &apos;editing&apos;: 6,
 &apos;jose&apos;: 1,
 &apos;menendez&apos;: 1,
 &apos;contents&apos;: 50,
 &apos;i&apos;: 7682,
 &apos;scandal&apos;: 19,
 &apos;bohemia&apos;: 15,
 &apos;ii&apos;: 77,
 &apos;red&apos;: 288,
 &apos;headed&apos;: 37,
 &apos;league&apos;: 53,
 &apos;iii&apos;: 91,
 &apos;case&apos;: 438,
 &apos;identity&apos;: 11,
 &apos;iv&apos;: 55,
 &apos;boscombe&apos;: 16,
 &apos;valley&apos;: 78,
 &apos;mystery&apos;: 39,
 &apos;v&apos;: 51,
 &apos;five&apos;: 279,
 &apos;orange&apos;: 23,
 &apos;pips&apos;: 12,
 &apos;vi&apos;: 37,
 &apos;man&apos;: 1652,
 &apos;with&apos;: 9740,
 &apos;twisted&apos;: 21,
 &apos;lip&apos;: 56,
 &apos;vii&apos;: 34,
 &apos;adventure&apos;: 34,
 &apos;blue&apos;: 143,
 &apos;carbuncle&apos;: 17,
 &apos;viii&apos;: 39,
 &apos;speckled&apos;: 5,
 &apos;band&apos;: 54,
 &apos;ix&apos;: 28,
 &apos;engineer&apos;: 12,
 &apos;s&apos;: 5631,
 &apos;thumb&apos;: 51,
 &apos;x&apos;: 136,
 &apos;noble&apos;: 48,
 &apos;bachelor&apos;: 18,
 &apos;xi&apos;: 28,
 &apos;beryl&apos;: 4,
 &apos;coronet&apos;: 29,
 &apos;xii&apos;: 28,
 &apos;copper&apos;: 26,
 &apos;beeches&apos;: 12,
 &apos;she&apos;: 3946,
 &apos;always&apos;: 608,
 &apos;woman&apos;: 325,
 &apos;have&apos;: 3493,
 &apos;seldom&apos;: 76,
 &apos;heard&apos;: 636,
 &apos;him&apos;: 5230,
 &apos;mention&apos;: 46,
 &apos;her&apos;: 5284,
 &apos;under&apos;: 963,
 &apos;name&apos;: 262,
 &apos;his&apos;: 10034,
 &apos;eyes&apos;: 939,
 &apos;eclipses&apos;: 2,
 &apos;predominates&apos;: 3,
 &apos;whole&apos;: 744,
 &apos;sex&apos;: 11,
 &apos;was&apos;: 11410,
 &apos;that&apos;: 12512,
 &apos;he&apos;: 12401,
 &apos;felt&apos;: 697,
 &apos;emotion&apos;: 36,
 &apos;akin&apos;: 14,
 &apos;love&apos;: 484,
 &apos;irene&apos;: 18,
 &apos;adler&apos;: 16,
 &apos;emotions&apos;: 10,
 &apos;one&apos;: 3371,
 &apos;particularly&apos;: 174,
 &apos;abhorrent&apos;: 1,
 &apos;cold&apos;: 257,
 &apos;precise&apos;: 13,
 &apos;but&apos;: 5653,
 &apos;admirably&apos;: 7,
 &apos;balanced&apos;: 6,
 &apos;mind&apos;: 341,
 &apos;take&apos;: 616,
 &apos;perfect&apos;: 39,
 &apos;reasoning&apos;: 41,
 &apos;observing&apos;: 21,
 &apos;machine&apos;: 39,
 &apos;has&apos;: 1603,
 &apos;as&apos;: 8064,
 &apos;lover&apos;: 26,
 &apos;would&apos;: 1953,
 &apos;placed&apos;: 182,
 &apos;himself&apos;: 1158,
 &apos;false&apos;: 64,
 &apos;position&apos;: 432,
 &apos;never&apos;: 593,
 &apos;spoke&apos;: 218,
 &apos;softer&apos;: 10,
 &apos;passions&apos;: 29,
 &apos;save&apos;: 110,
 &apos;gibe&apos;: 2,
 &apos;sneer&apos;: 6,
 &apos;they&apos;: 3938,
 &apos;admirable&apos;: 14,
 &apos;things&apos;: 321,
 &apos;observer&apos;: 13,
 &apos;excellent&apos;: 62,
 &apos;drawing&apos;: 240,
 &apos;veil&apos;: 16,
 &apos;from&apos;: 5709,
 &apos;men&apos;: 1145,
 &apos;motives&apos;: 14,
 &apos;actions&apos;: 77,
 &apos;trained&apos;: 23,
 &apos;reasoner&apos;: 6,
 &apos;admit&apos;: 65,
 &apos;such&apos;: 1436,
 &apos;intrusions&apos;: 1,
 &apos;into&apos;: 2124,
 &apos;own&apos;: 785,
 &apos;delicate&apos;: 54,
 &apos;finely&apos;: 11,
 &apos;adjusted&apos;: 16,
 &apos;temperament&apos;: 5,
 &apos;introduce&apos;: 23,
 &apos;distracting&apos;: 1,
 &apos;factor&apos;: 41,
 &apos;which&apos;: 4842,
 &apos;might&apos;: 536,
 &apos;throw&apos;: 48,
 &apos;doubt&apos;: 152,
 &apos;upon&apos;: 1111,
 &apos;mental&apos;: 37,
 &apos;results&apos;: 229,
 &apos;grit&apos;: 1,
 &apos;sensitive&apos;: 35,
 &apos;instrument&apos;: 35,
 &apos;crack&apos;: 20,
 &apos;high&apos;: 290,
 &apos;power&apos;: 548,
 &apos;lenses&apos;: 1,
 &apos;more&apos;: 1997,
 &apos;disturbing&apos;: 9,
 &apos;than&apos;: 1206,
 &apos;strong&apos;: 168,
 &apos;nature&apos;: 170,
 &apos;yet&apos;: 488,
 &apos;there&apos;: 2972,
 &apos;late&apos;: 165,
 &apos;dubious&apos;: 1,
 &apos;questionable&apos;: 3,
 &apos;memory&apos;: 55,
 &apos;had&apos;: 7383,
 &apos;little&apos;: 1001,
 &apos;lately&apos;: 22,
 &apos;my&apos;: 2249,
 &apos;marriage&apos;: 96,
 &apos;drifted&apos;: 5,
 &apos;us&apos;: 684,
 &apos;away&apos;: 838,
 &apos;each&apos;: 411,
 &apos;complete&apos;: 145,
 &apos;happiness&apos;: 143,
 &apos;home&apos;: 295,
 &apos;centred&apos;: 2,
 &apos;interests&apos;: 118,
 &apos;rise&apos;: 240,
 &apos;up&apos;: 2284,
 &apos;around&apos;: 271,
 &apos;who&apos;: 3050,
 &apos;finds&apos;: 23,
 &apos;master&apos;: 141,
 &apos;establishment&apos;: 40,
 &apos;sufficient&apos;: 75,
 &apos;absorb&apos;: 4,
 &apos;attention&apos;: 191,
 &apos;while&apos;: 768,
 &apos;loathed&apos;: 1,
 &apos;every&apos;: 650,
 &apos;form&apos;: 507,
 &apos;society&apos;: 169,
 &apos;bohemian&apos;: 8,
 &apos;soul&apos;: 168,
 &apos;remained&apos;: 231,
 &apos;lodgings&apos;: 11,
 &apos;baker&apos;: 49,
 &apos;street&apos;: 180,
 &apos;buried&apos;: 21,
 &apos;among&apos;: 451,
 &apos;old&apos;: 1180,
 &apos;books&apos;: 59,
 &apos;alternating&apos;: 2,
 &apos;week&apos;: 95,
 &apos;between&apos;: 654,
 &apos;cocaine&apos;: 4,
 &apos;ambition&apos;: 13,
 &apos;drowsiness&apos;: 4,
 &apos;drug&apos;: 21,
 &apos;fierce&apos;: 12,
 &apos;energy&apos;: 45,
 &apos;keen&apos;: 32,
 &apos;still&apos;: 922,
 &apos;ever&apos;: 274,
 &apos;deeply&apos;: 77,
 &apos;attracted&apos;: 36,
 &apos;study&apos;: 144,
 &apos;crime&apos;: 61,
 &apos;occupied&apos;: 116,
 &apos;immense&apos;: 77,
 &apos;faculties&apos;: 8,
 &apos;extraordinary&apos;: 74,
 &apos;powers&apos;: 149,
 &apos;observation&apos;: 39,
 &apos;following&apos;: 208,
 &apos;those&apos;: 1201,
 &apos;clues&apos;: 3,
 &apos;clearing&apos;: 29,
 &apos;mysteries&apos;: 9,
 &apos;been&apos;: 2599,
 &apos;abandoned&apos;: 72,
 &apos;hopeless&apos;: 17,
 &apos;official&apos;: 91,
 &apos;police&apos;: 94,
 &apos;time&apos;: 1529,
 &apos;some&apos;: 1536,
 &apos;vague&apos;: 39,
 &apos;account&apos;: 177,
 &apos;doings&apos;: 11,
 &apos;summons&apos;: 11,
 &apos;odessa&apos;: 3,
 &apos;trepoff&apos;: 1,
 &apos;murder&apos;: 30,
 &apos;singular&apos;: 36,
 &apos;tragedy&apos;: 9,
 &apos;atkinson&apos;: 1,
 &apos;brothers&apos;: 50,
 &apos;trincomalee&apos;: 1,
 &apos;finally&apos;: 156,
 &apos;mission&apos;: 34,
 &apos;accomplished&apos;: 39,
 &apos;so&apos;: 3017,
 &apos;delicately&apos;: 3,
 &apos;successfully&apos;: 25,
 &apos;reigning&apos;: 3,
 &apos;family&apos;: 210,
 &apos;holland&apos;: 12,
 &apos;beyond&apos;: 225,
 &apos;signs&apos;: 98,
 &apos;activity&apos;: 131,
 &apos;however&apos;: 430,
 &apos;merely&apos;: 189,
 &apos;shared&apos;: 25,
 &apos;readers&apos;: 11,
 &apos;daily&apos;: 44,
 &apos;press&apos;: 81,
 &apos;knew&apos;: 496,
 &apos;former&apos;: 177,
 &apos;friend&apos;: 283,
 &apos;companion&apos;: 81,
 &apos;night&apos;: 385,
 &apos;on&apos;: 6643,
 &apos;twentieth&apos;: 19,
 &apos;returning&apos;: 68,
 &apos;journey&apos;: 69,
 &apos;patient&apos;: 383,
 &apos;now&apos;: 1697,
 &apos;returned&apos;: 194,
 &apos;civil&apos;: 177,
 &apos;practice&apos;: 95,
 &apos;way&apos;: 859,
 &apos;led&apos;: 196,
 &apos;me&apos;: 1920,
 &apos;through&apos;: 815,
 &apos;passed&apos;: 367,
 &apos;well&apos;: 1198,
 &apos;remembered&apos;: 120,
 &apos;door&apos;: 498,
 &apos;must&apos;: 955,
 &apos;associated&apos;: 196,
 &apos;wooing&apos;: 2,
 &apos;dark&apos;: 181,
 &apos;incidents&apos;: 14,
 &apos;scarlet&apos;: 22,
 &apos;seized&apos;: 114,
 &apos;desire&apos;: 96,
 &apos;see&apos;: 1101,
 &apos;again&apos;: 866,
 &apos;know&apos;: 1048,
 &apos;employing&apos;: 7,
 &apos;rooms&apos;: 86,
 &apos;brilliantly&apos;: 5,
 &apos;lit&apos;: 74,
 &apos;even&apos;: 946,
 &apos;looked&apos;: 760,
 &apos;saw&apos;: 599,
 &apos;tall&apos;: 74,
 &apos;spare&apos;: 27,
 &apos;figure&apos;: 103,
 &apos;pass&apos;: 154,
 &apos;twice&apos;: 84,
 &apos;silhouette&apos;: 1,
 &apos;against&apos;: 660,
 &apos;blind&apos;: 23,
 &apos;pacing&apos;: 26,
 &apos;room&apos;: 960,
 &apos;swiftly&apos;: 38,
 &apos;eagerly&apos;: 39,
 &apos;head&apos;: 725,
 &apos;sunk&apos;: 27,
 &apos;chest&apos;: 81,
 &apos;hands&apos;: 455,
 &apos;clasped&apos;: 11,
 &apos;behind&apos;: 401,
 &apos;mood&apos;: 51,
 &apos;habit&apos;: 55,
 &apos;attitude&apos;: 72,
 &apos;manner&apos;: 135,
 &apos;told&apos;: 490,
 &apos;their&apos;: 2955,
 &apos;story&apos;: 133,
 &apos;work&apos;: 382,
 &apos;risen&apos;: 30,
 &apos;created&apos;: 62,
 &apos;dreams&apos;: 16,
 &apos;hot&apos;: 119,
 &apos;scent&apos;: 17,
 &apos;new&apos;: 1211,
 &apos;problem&apos;: 76,
 &apos;rang&apos;: 29,
 &apos;bell&apos;: 65,
 &apos;shown&apos;: 113,
 &apos;chamber&apos;: 35,
 &apos;formerly&apos;: 77,
 &apos;part&apos;: 704,
 &apos;effusive&apos;: 2,
 &apos;glad&apos;: 150,
 &apos;think&apos;: 557,
 &apos;hardly&apos;: 173,
 &apos;word&apos;: 298,
 &apos;spoken&apos;: 92,
 &apos;kindly&apos;: 86,
 &apos;eye&apos;: 110,
 &apos;waved&apos;: 29,
 &apos;an&apos;: 3423,
 &apos;armchair&apos;: 49,
 &apos;threw&apos;: 96,
 &apos;across&apos;: 222,
 &apos;cigars&apos;: 7,
 &apos;indicated&apos;: 88,
 &apos;spirit&apos;: 167,
 &apos;gasogene&apos;: 1,
 &apos;corner&apos;: 128,
 &apos;then&apos;: 1558,
 &apos;stood&apos;: 383,
 &apos;fire&apos;: 274,
 &apos;introspective&apos;: 3,
 &apos;fashion&apos;: 49,
 &apos;wedlock&apos;: 1,
 &apos;suits&apos;: 8,
 &apos;remarked&apos;: 169,
 &apos;watson&apos;: 83,
 &apos;put&apos;: 435,
 &apos;seven&apos;: 132,
 &apos;half&apos;: 318,
 &apos;pounds&apos;: 26,
 &apos;answered&apos;: 226,
 &apos;indeed&apos;: 139,
 &apos;thought&apos;: 902,
 &apos;just&apos;: 767,
 &apos;trifle&apos;: 11,
 &apos;fancy&apos;: 50,
 &apos;observe&apos;: 37,
 &apos;did&apos;: 1875,
 &apos;tell&apos;: 492,
 &apos;intended&apos;: 58,
 &apos;go&apos;: 905,
 &apos;harness&apos;: 27,
 &apos;deduce&apos;: 14,
 &apos;getting&apos;: 92,
 &apos;yourself&apos;: 162,
 &apos;very&apos;: 1340,
 &apos;wet&apos;: 60,
 &apos;clumsy&apos;: 8,
 &apos;careless&apos;: 14,
 &apos;servant&apos;: 46,
 &apos;girl&apos;: 166,
 &apos;dear&apos;: 449,
 &apos;said&apos;: 3464,
 &apos;too&apos;: 548,
 &apos;much&apos;: 671,
 &apos;certainly&apos;: 119,
 &apos;burned&apos;: 77,
 &apos;lived&apos;: 113,
 &apos;few&apos;: 458,
 &apos;centuries&apos;: 12,
 &apos;ago&apos;: 108,
 &apos;true&apos;: 205,
 &apos;walk&apos;: 75,
 &apos;thursday&apos;: 7,
 &apos;came&apos;: 979,
 &apos;dreadful&apos;: 68,
 &apos;mess&apos;: 10,
 &apos;changed&apos;: 134,
 &apos;clothes&apos;: 62,
 &apos;t&apos;: 1318,
 &apos;imagine&apos;: 96,
 &apos;mary&apos;: 705,
 &apos;jane&apos;: 2,
 &apos;incorrigible&apos;: 2,
 &apos;wife&apos;: 367,
 &apos;given&apos;: 364,
 &apos;notice&apos;: 98,
 &apos;fail&apos;: 40,
 &apos;chuckled&apos;: 7,
 &apos;rubbed&apos;: 32,
 &apos;long&apos;: 991,
 &apos;nervous&apos;: 54,
 &apos;together&apos;: 260,
 &apos;simplicity&apos;: 30,
 &apos;itself&apos;: 273,
 &apos;inside&apos;: 43,
 &apos;left&apos;: 834,
 &apos;shoe&apos;: 11,
 &apos;where&apos;: 977,
 &apos;firelight&apos;: 2,
 &apos;strikes&apos;: 19,
 &apos;leather&apos;: 35,
 &apos;scored&apos;: 4,
 &apos;six&apos;: 176,
 &apos;almost&apos;: 325,
 &apos;parallel&apos;: 17,
 &apos;cuts&apos;: 5,
 &apos;obviously&apos;: 38,
 &apos;caused&apos;: 102,
 &apos;someone&apos;: 160,
 &apos;carelessly&apos;: 14,
 &apos;scraped&apos;: 21,
 &apos;round&apos;: 556,
 &apos;edges&apos;: 70,
 &apos;sole&apos;: 70,
 &apos;order&apos;: 404,
 &apos;crusted&apos;: 2,
 &apos;mud&apos;: 36,
 &apos;hence&apos;: 32,
 &apos;double&apos;: 49,
 &apos;deduction&apos;: 12,
 &apos;vile&apos;: 16,
 &apos;weather&apos;: 42,
 &apos;malignant&apos;: 88,
 &apos;boot&apos;: 22,
 &apos;slitting&apos;: 2,
 &apos;specimen&apos;: 14,
 &apos;london&apos;: 76,
 &apos;slavey&apos;: 1,
 &apos;if&apos;: 2372,
 &apos;gentleman&apos;: 99,
 &apos;walks&apos;: 10,
 &apos;smelling&apos;: 5,
 &apos;iodoform&apos;: 43,
 &apos;black&apos;: 235,
 &apos;mark&apos;: 38,
 &apos;nitrate&apos;: 7,
 &apos;silver&apos;: 128,
 &apos;right&apos;: 710,
 &apos;forefinger&apos;: 7,
 &apos;bulge&apos;: 2,
 &apos;side&apos;: 511,
 &apos;top&apos;: 42,
 &apos;hat&apos;: 105,
 &apos;show&apos;: 213,
 &apos;secreted&apos;: 2,
 &apos;stethoscope&apos;: 2,
 &apos;dull&apos;: 74,
 &apos;pronounce&apos;: 9,
 &apos;active&apos;: 96,
 &apos;member&apos;: 50,
 &apos;medical&apos;: 22,
 &apos;profession&apos;: 22,
 &apos;could&apos;: 1700,
 &apos;help&apos;: 230,
 &apos;laughing&apos;: 115,
 &apos;ease&apos;: 44,
 &apos;explained&apos;: 60,
 &apos;process&apos;: 219,
 &apos;hear&apos;: 183,
 &apos;give&apos;: 523,
 &apos;reasons&apos;: 64,
 &apos;appears&apos;: 108,
 &apos;ridiculously&apos;: 1,
 &apos;simple&apos;: 139,
 &apos;easily&apos;: 114,
 &apos;myself&apos;: 227,
 &apos;though&apos;: 650,
 &apos;successive&apos;: 17,
 &apos;instance&apos;: 50,
 &apos;am&apos;: 746,
 &apos;baffled&apos;: 8,
 &apos;until&apos;: 325,
 &apos;explain&apos;: 123,
 &apos;believe&apos;: 183,
 &apos;good&apos;: 744,
 &apos;yours&apos;: 46,
 &apos;quite&apos;: 502,
 &apos;lighting&apos;: 16,
 &apos;cigarette&apos;: 6,
 &apos;throwing&apos;: 46,
 &apos;down&apos;: 1128,
 &apos;distinction&apos;: 19,
 &apos;clear&apos;: 233,
 &apos;example&apos;: 286,
 &apos;frequently&apos;: 218,
 &apos;steps&apos;: 188,
 &apos;lead&apos;: 137,
 &apos;hall&apos;: 83,
 &apos;often&apos;: 443,
 &apos;hundreds&apos;: 48,
 &apos;times&apos;: 236,
 &apos;many&apos;: 609,
 &apos;don&apos;: 581,
 &apos;observed&apos;: 131,
 &apos;point&apos;: 223,
 &apos;seventeen&apos;: 10,
 &apos;because&apos;: 630,
 &apos;interested&apos;: 65,
 &apos;problems&apos;: 78,
 &apos;enough&apos;: 175,
 &apos;chronicle&apos;: 7,
 &apos;two&apos;: 1138,
 &apos;trifling&apos;: 12,
 &apos;experiences&apos;: 11,
 &apos;sheet&apos;: 29,
 &apos;thick&apos;: 77,
 &apos;pink&apos;: 27,
 &apos;tinted&apos;: 9,
 &apos;notepaper&apos;: 2,
 &apos;lying&apos;: 118,
 &apos;open&apos;: 325,
 &apos;table&apos;: 296,
 &apos;last&apos;: 565,
 &apos;post&apos;: 117,
 &apos;aloud&apos;: 28,
 &apos;note&apos;: 115,
 &apos;undated&apos;: 1,
 &apos;either&apos;: 293,
 &apos;signature&apos;: 9,
 &apos;address&apos;: 76,
 &apos;will&apos;: 1577,
 &apos;call&apos;: 197,
 &apos;quarter&apos;: 46,
 &apos;eight&apos;: 128,
 &apos;o&apos;: 257,
 &apos;clock&apos;: 120,
 &apos;desires&apos;: 22,
 &apos;consult&apos;: 19,
 &apos;matter&apos;: 365,
 &apos;deepest&apos;: 15,
 &apos;moment&apos;: 487,
 &apos;recent&apos;: 54,
 &apos;services&apos;: 38,
 &apos;royal&apos;: 111,
 &apos;houses&apos;: 117,
 &apos;europe&apos;: 153,
 &apos;safely&apos;: 11,
 &apos;trusted&apos;: 16,
 &apos;matters&apos;: 136,
 &apos;importance&apos;: 117,
 &apos;exaggerated&apos;: 28,
 &apos;we&apos;: 1906,
 &apos;quarters&apos;: 72,
 &apos;received&apos;: 280,
 &apos;hour&apos;: 157,
 &apos;amiss&apos;: 6,
 &apos;visitor&apos;: 74,
 &apos;wear&apos;: 30,
 &apos;mask&apos;: 12,
 &apos;what&apos;: 3011,
 &apos;means&apos;: 253,
 &apos;no&apos;: 2348,
 &apos;data&apos;: 17,
 &apos;capital&apos;: 144,
 &apos;mistake&apos;: 39,
 &apos;theorise&apos;: 1,
 &apos;insensibly&apos;: 2,
 &apos;begins&apos;: 47,
 &apos;twist&apos;: 14,
 &apos;facts&apos;: 72,
 &apos;suit&apos;: 25,
 &apos;theories&apos;: 21,
 &apos;instead&apos;: 137,
 &apos;carefully&apos;: 72,
 &apos;examined&apos;: 49,
 &apos;writing&apos;: 69,
 &apos;paper&apos;: 177,
 &apos;wrote&apos;: 149,
 &apos;presumably&apos;: 8,
 &apos;endeavouring&apos;: 8,
 &apos;imitate&apos;: 7,
 &apos;processes&apos;: 35,
 &apos;bought&apos;: 55,
 &apos;crown&apos;: 61,
 &apos;packet&apos;: 11,
 &apos;peculiarly&apos;: 14,
 &apos;stiff&apos;: 20,
 &apos;peculiar&apos;: 84,
 &apos;hold&apos;: 114,
 &apos;light&apos;: 278,
 &apos;large&apos;: 483,
 &apos;e&apos;: 136,
 &apos;g&apos;: 55,
 &apos;p&apos;: 66,
 &apos;woven&apos;: 5,
 &apos;texture&apos;: 6,
 &apos;asked&apos;: 777,
 &apos;maker&apos;: 4,
 &apos;monogram&apos;: 4,
 &apos;rather&apos;: 219,
 &apos;stands&apos;: 19,
 &apos;gesellschaft&apos;: 1,
 &apos;german&apos;: 196,
 &apos;company&apos;: 192,
 &apos;customary&apos;: 19,
 &apos;contraction&apos;: 61,
 &apos;like&apos;: 1080,
 &apos;co&apos;: 30,
 &apos;course&apos;: 389,
 &apos;papier&apos;: 1,
 &apos;eg&apos;: 1,
 &apos;let&apos;: 506,
 &apos;glance&apos;: 91,
 &apos;continental&apos;: 46,
 &apos;gazetteer&apos;: 1,
 &apos;took&apos;: 573,
 &apos;heavy&apos;: 139,
 &apos;brown&apos;: 71,
 &apos;volume&apos;: 30,
 &apos;shelves&apos;: 3,
 &apos;eglow&apos;: 1,
 &apos;eglonitz&apos;: 1,
 &apos;here&apos;: 691,
 &apos;egria&apos;: 1,
 &apos;speaking&apos;: 185,
 &apos;far&apos;: 408,
 &apos;carlsbad&apos;: 1,
 &apos;remarkable&apos;: 77,
 &apos;being&apos;: 918,
 &apos;scene&apos;: 49,
 &apos;death&apos;: 330,
 &apos;wallenstein&apos;: 1,
 &apos;its&apos;: 1635,
 &apos;numerous&apos;: 50,
 &apos;glass&apos;: 116,
 &apos;factories&apos;: 29,
 &apos;mills&apos;: 39,
 &apos;ha&apos;: 75,
 &apos;boy&apos;: 169,
 &apos;sparkled&apos;: 5,
 &apos;sent&apos;: 319,
 &apos;great&apos;: 792,
 &apos;triumphant&apos;: 16,
 &apos;cloud&apos;: 30,
 &apos;made&apos;: 1007,
 &apos;precisely&apos;: 24,
 &apos;construction&apos;: 25,
 &apos;sentence&apos;: 26,
 &apos;frenchman&apos;: 102,
 &apos;russian&apos;: 461,
 &apos;uncourteous&apos;: 1,
 &apos;verbs&apos;: 1,
 &apos;only&apos;: 1873,
 &apos;remains&apos;: 73,
 &apos;therefore&apos;: 186,
 &apos;discover&apos;: 28,
 &apos;wanted&apos;: 213,
 &apos;writes&apos;: 20,
 &apos;prefers&apos;: 2,
 &apos;wearing&apos;: 87,
 &apos;showing&apos;: 104,
 &apos;face&apos;: 1125,
 &apos;comes&apos;: 91,
 &apos;mistaken&apos;: 59,
 &apos;resolve&apos;: 14,
 &apos;doubts&apos;: 39,
 &apos;sharp&apos;: 83,
 &apos;sound&apos;: 219,
 &apos;horses&apos;: 262,
 &apos;hoofs&apos;: 24,
 &apos;grating&apos;: 10,
 &apos;wheels&apos;: 47,
 &apos;curb&apos;: 4,
 &apos;followed&apos;: 329,
 &apos;pull&apos;: 23,
 &apos;whistled&apos;: 13,
 &apos;pair&apos;: 40,
 &apos;yes&apos;: 688,
 &apos;continued&apos;: 291,
 &apos;glancing&apos;: 98,
 &apos;window&apos;: 186,
 &apos;nice&apos;: 53,
 &apos;brougham&apos;: 4,
 &apos;beauties&apos;: 2,
 &apos;hundred&apos;: 229,
 &apos;fifty&apos;: 94,
 &apos;guineas&apos;: 3,
 &apos;apiece&apos;: 7,
 &apos;money&apos;: 326,
 &apos;nothing&apos;: 646,
 &apos;else&apos;: 201,
 &apos;better&apos;: 266,
 &apos;bit&apos;: 63,
 &apos;doctor&apos;: 183,
 &apos;stay&apos;: 74,
 &apos;lost&apos;: 224,
 &apos;boswell&apos;: 1,
 &apos;promises&apos;: 15,
 &apos;interesting&apos;: 71,
 &apos;pity&apos;: 75,
 &apos;miss&apos;: 112,
 &apos;client&apos;: 33,
 &apos;want&apos;: 323,
 &apos;sit&apos;: 89,
 &apos;best&apos;: 268,
 &apos;slow&apos;: 65,
 &apos;step&apos;: 139,
 &apos;stairs&apos;: 31,
 &apos;passage&apos;: 110,
 &apos;paused&apos;: 79,
 &apos;immediately&apos;: 182,
 &apos;outside&apos;: 110,
 &apos;loud&apos;: 64,
 &apos;authoritative&apos;: 2,
 &apos;tap&apos;: 10,
 &apos;come&apos;: 934,
 &apos;entered&apos;: 282,
 &apos;less&apos;: 367,
 &apos;feet&apos;: 179,
 &apos;inches&apos;: 16,
 &apos;height&apos;: 36,
 &apos;limbs&apos;: 67,
 &apos;hercules&apos;: 4,
 &apos;dress&apos;: 138,
 &apos;rich&apos;: 92,
 &apos;richness&apos;: 2,
 &apos;england&apos;: 311,
 &apos;bad&apos;: 155,
 &apos;taste&apos;: 23,
 &apos;bands&apos;: 27,
 &apos;astrakhan&apos;: 1,
 &apos;slashed&apos;: 3,
 &apos;sleeves&apos;: 30,
 &apos;fronts&apos;: 1,
 &apos;breasted&apos;: 1,
 &apos;coat&apos;: 172,
 &apos;deep&apos;: 215,
 &apos;cloak&apos;: 62,
 &apos;thrown&apos;: 92,
 &apos;shoulders&apos;: 125,
 &apos;lined&apos;: 32,
 &apos;flame&apos;: 15,
 &apos;coloured&apos;: 21,
 &apos;silk&apos;: 50,
 &apos;secured&apos;: 48,
 &apos;neck&apos;: 203,
 &apos;brooch&apos;: 1,
 &apos;consisted&apos;: 38,
 &apos;single&apos;: 173,
 &apos;flaming&apos;: 8,
 &apos;boots&apos;: 91,
 &apos;extended&apos;: 75,
 &apos;halfway&apos;: 19,
 &apos;calves&apos;: 3,
 &apos;trimmed&apos;: 8,
 &apos;tops&apos;: 3,
 &apos;fur&apos;: 38,
 &apos;completed&apos;: 25,
 &apos;impression&apos;: 67,
 &apos;barbaric&apos;: 2,
 &apos;opulence&apos;: 3,
 &apos;suggested&apos;: 69,
 &apos;appearance&apos;: 135,
 &apos;carried&apos;: 282,
 &apos;broad&apos;: 92,
 &apos;brimmed&apos;: 4,
 &apos;hand&apos;: 834,
 &apos;wore&apos;: 58,
 &apos;upper&apos;: 130,
 &apos;extending&apos;: 35,
 &apos;past&apos;: 223,
 &apos;cheekbones&apos;: 4,
 &apos;vizard&apos;: 1,
 &apos;apparently&apos;: 68,
 &apos;raised&apos;: 212,
 &apos;lower&apos;: 196,
 &apos;appeared&apos;: 197,
 &apos;hanging&apos;: 42,
 &apos;straight&apos;: 124,
 &apos;chin&apos;: 30,
 &apos;suggestive&apos;: 11,
 &apos;resolution&apos;: 57,
 &apos;pushed&apos;: 81,
 &apos;length&apos;: 63,
 &apos;obstinacy&apos;: 7,
 &apos;harsh&apos;: 22,
 &apos;voice&apos;: 462,
 &apos;strongly&apos;: 41,
 &apos;marked&apos;: 138,
 &apos;accent&apos;: 18,
 &apos;uncertain&apos;: 30,
 &apos;pray&apos;: 79,
 &apos;seat&apos;: 170,
 &apos;colleague&apos;: 7,
 &apos;dr&apos;: 48,
 &apos;occasionally&apos;: 89,
 &apos;cases&apos;: 453,
 &apos;whom&apos;: 489,
 &apos;honour&apos;: 16,
 &apos;count&apos;: 748,
 &apos;von&apos;: 11,
 &apos;kramm&apos;: 2,
 &apos;nobleman&apos;: 11,
 &apos;understand&apos;: 412,
 &apos;discretion&apos;: 13,
 &apos;trust&apos;: 68,
 &apos;extreme&apos;: 72,
 &apos;prefer&apos;: 21,
 &apos;communicate&apos;: 15,
 &apos;alone&apos;: 337,
 &apos;rose&apos;: 243,
 &apos;caught&apos;: 90,
 &apos;wrist&apos;: 68,
 &apos;back&apos;: 746,
 &apos;chair&apos;: 135,
 &apos;none&apos;: 110,
 &apos;say&apos;: 755,
 &apos;anything&apos;: 379,
 &apos;shrugged&apos;: 35,
 &apos;begin&apos;: 97,
 &apos;binding&apos;: 18,
 &apos;absolute&apos;: 56,
 &apos;secrecy&apos;: 18,
 &apos;years&apos;: 571,
 &apos;end&apos;: 465,
 &apos;present&apos;: 329,
 &apos;weight&apos;: 70,
 &apos;influence&apos;: 138,
 &apos;european&apos;: 99,
 &apos;history&apos;: 439,
 &apos;promise&apos;: 67,
 &apos;excuse&apos;: 53,
 &apos;strange&apos;: 220,
 &apos;august&apos;: 70,
 &apos;person&apos;: 185,
 &apos;employs&apos;: 2,
 &apos;wishes&apos;: 42,
 &apos;agent&apos;: 25,
 &apos;unknown&apos;: 87,
 &apos;confess&apos;: 36,
 &apos;once&apos;: 569,
 &apos;called&apos;: 450,
 &apos;exactly&apos;: 47,
 &apos;aware&apos;: 52,
 &apos;dryly&apos;: 5,
 &apos;circumstances&apos;: 107,
 &apos;delicacy&apos;: 11,
 &apos;precaution&apos;: 9,
 &apos;taken&apos;: 438,
 &apos;quench&apos;: 3,
 &apos;grow&apos;: 74,
 &apos;seriously&apos;: 63,
 &apos;compromise&apos;: 71,
 &apos;families&apos;: 45,
 &apos;speak&apos;: 255,
 &apos;plainly&apos;: 39,
 &apos;implicates&apos;: 5,
 &apos;house&apos;: 661,
 &apos;ormstein&apos;: 2,
 &apos;hereditary&apos;: 14,
 &apos;kings&apos;: 27,
 &apos;murmured&apos;: 18,
 &apos;settling&apos;: 16,
 &apos;closing&apos;: 35,
 &apos;glanced&apos;: 176,
 ...}</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alphabet = <span class="string">'abcdefghigklmnopqrstuvwxyz'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edits1</span><span class="params">(word)</span>:</span></span><br><span class="line">    n = len(word)</span><br><span class="line">    <span class="keyword">return</span> set([word[<span class="number">0</span>:i]+word[i+<span class="number">1</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]+</span><br><span class="line">              [word[<span class="number">0</span>:i]+word[i+<span class="number">1</span>]+word[i]+word[i+<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>)]+</span><br><span class="line">              [word[<span class="number">0</span>:i]+c+word[i+<span class="number">1</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> range(n) <span class="keyword">for</span> c <span class="keyword">in</span> alphabet] +</span><br><span class="line">              [word[<span class="number">0</span>:i]+c+word[i:] <span class="keyword">for</span> i <span class="keyword">in</span> range(n+<span class="number">1</span>) <span class="keyword">for</span> c <span class="keyword">in</span> alphabet])</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edits2</span><span class="params">(word)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> set(e2 <span class="keyword">for</span> e1 <span class="keyword">in</span> edits1(word) <span class="keyword">for</span> e2 <span class="keyword">in</span> edits1(e1))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e1 = edits1(<span class="string">'hello'</span>)</span><br><span class="line">e2 = edits2(<span class="string">'hello'</span>)</span><br><span class="line">len(e1)+len(e2)</span><br></pre></td></tr></table></figure>




<pre><code>33328</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">known</span><span class="params">(words)</span>:</span></span><br><span class="line">    w = set()</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">in</span> dic_words:</span><br><span class="line">            w.add(word)</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">correct</span><span class="params">(word)</span>:</span></span><br><span class="line">    candidates = known([word]) <span class="keyword">or</span> known(edits1(word)) <span class="keyword">or</span> known(edits2(word)) <span class="keyword">or</span> word</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> word == candidates:</span><br><span class="line">        <span class="keyword">return</span> word</span><br><span class="line">    max_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> candidates:</span><br><span class="line">        <span class="keyword">if</span> dic_words[c]&gt;=max_num:</span><br><span class="line">            max_num=dic_words[c]</span><br><span class="line">            candidate = c</span><br><span class="line">    <span class="keyword">return</span> candidate</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct(<span class="string">'ehell'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&apos;shell&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct(<span class="string">'hel'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&apos;he&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct(<span class="string">'heade'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&apos;head&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct(<span class="string">'haved'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&apos;have&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct(<span class="string">'adevnues'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&apos;avenues&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>è´å¶æ–¯ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>é›†æˆå­¦ä¹ bagging</title>
    <url>/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0bagging/</url>
    <content><![CDATA[<p>baggingä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>


<p>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œè£…è¢‹ï¼ˆbaggingï¼‰<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/bagging1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/bagging2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/bagging3.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> neighbors</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> BaggingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">iris = datasets.load_iris()</span><br><span class="line">x_data=iris.data[:,:<span class="number">2</span>]</span><br><span class="line">y_data=iris.target</span><br><span class="line">x_train,x_test,y_train,y_test = train_test_split(x_data,y_data)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">knn = neighbors.KNeighborsClassifier()</span><br><span class="line">knn.fit(x_train,y_train)</span><br></pre></td></tr></table></figure>




<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,
                     metric_params=None, n_jobs=None, n_neighbors=5, p=2,
                     weights=&apos;uniform&apos;)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot</span><span class="params">(model)</span>:</span></span><br><span class="line">    <span class="comment"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class="line">    x_min, x_max = x_data[:, <span class="number">0</span>].min() - <span class="number">1</span>, x_data[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">    y_min, y_max = x_data[:, <span class="number">1</span>].min() - <span class="number">1</span>, x_data[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">0.02</span>),</span><br><span class="line">                         np.arange(y_min, y_max, <span class="number">0.02</span>))</span><br><span class="line">    </span><br><span class="line">    z=model.predict(np.c_[xx.ravel(),yy.ravel()])</span><br><span class="line">    z = z.reshape(xx.shape)</span><br><span class="line">    cs = plt.contourf(xx,yy,z)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(knn)</span><br><span class="line">plt.scatter(x_data[:,<span class="number">0</span>],x_data[:,<span class="number">1</span>],c=y_data)</span><br><span class="line">plt.show()</span><br><span class="line">knn.score(x_test,y_test)</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0bagging/output_5_0.png" alt="png"></p>
<pre><code>0.631578947368421</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dtree = tree.DecisionTreeClassifier()</span><br><span class="line">dtree.fit(x_train,y_train)</span><br></pre></td></tr></table></figure>




<pre><code>DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion=&apos;gini&apos;,
                       max_depth=None, max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=&apos;deprecated&apos;,
                       random_state=None, splitter=&apos;best&apos;)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(dtree)</span><br><span class="line">plt.scatter(x_data[:,<span class="number">0</span>],x_data[:,<span class="number">1</span>],c=y_data)</span><br><span class="line">plt.show()</span><br><span class="line">dtree.score(x_test,y_test)</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0bagging/output_7_0.png" alt="png"></p>
<pre><code>0.6052631578947368</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bagging_knn = BaggingClassifier(knn,n_estimators=<span class="number">100</span>)</span><br><span class="line">bagging_knn.fit(x_train,y_train)</span><br><span class="line">plot(bagging_knn)</span><br><span class="line">plt.scatter(x_data[:,<span class="number">0</span>],x_data[:,<span class="number">1</span>],c=y_data)</span><br><span class="line">plt.show()</span><br><span class="line">bagging_knn.score(x_test,y_test)</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0bagging/output_8_0.png" alt="png"></p>
<pre><code>0.631578947368421</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bagging_tree = BaggingClassifier(dtree,n_estimators=<span class="number">100</span>)</span><br><span class="line">bagging_tree.fit(x_train,y_train)</span><br><span class="line">plot(bagging_tree)</span><br><span class="line">plt.scatter(x_data[:,<span class="number">-0</span>],x_data[:,<span class="number">1</span>],c=y_data)</span><br><span class="line">plt.show()</span><br><span class="line">bagging_tree.score(x_test,y_test)</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0bagging/output_9_0.png" alt="png"></p>
<pre><code>0.6578947368421053</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é›†æˆå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>é›†æˆå­¦ä¹ stacking</title>
    <url>/2020/07/11/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0stacking/</url>
    <content><![CDATA[<p>stackingä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>

<p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/stack1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/stack2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/stack3.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> mlxtend.classifier <span class="keyword">import</span> StackingClassifier</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">iris = datasets.load_iris()</span><br><span class="line">x_data,y_data=iris.data[:,<span class="number">1</span>:<span class="number">3</span>],iris.target</span><br><span class="line">clf1 = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br><span class="line">clf2 = DecisionTreeClassifier()</span><br><span class="line">clf3 = LogisticRegression()</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">sclf = StackingClassifier(classifiers=[clf1,clf2,clf3],meta_classifier=lr)</span><br><span class="line"><span class="keyword">for</span> clf,label <span class="keyword">in</span> zip([clf1,clf2,clf3,sclf],</span><br><span class="line">                    [<span class="string">'KNN'</span>,<span class="string">'Decision Tree'</span>,<span class="string">'LogisticRegression'</span>,<span class="string">'StackingClassifier'</span>]):</span><br><span class="line">    scores = model_selection.cross_val_score(clf,x_data,y_data,cv=<span class="number">3</span>,scoring=<span class="string">'accuracy'</span>)</span><br><span class="line">    print(<span class="string">'Accuracy:%0.2f [%s]'</span> %(scores.mean(),label))</span><br></pre></td></tr></table></figure>

<pre><code>Accuracy:0.91 [KNN]
Accuracy:0.93 [Decision Tree]
Accuracy:0.95 [LogisticRegression]
Accuracy:0.93 [StackingClassifier]</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é›†æˆå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>é›†æˆå­¦ä¹ boosting</title>
    <url>/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0boosting/</url>
    <content><![CDATA[<p>boostingä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>


<p>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œæå‡ï¼ˆboostingï¼‰<br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting1.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting2.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting3.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting4.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting5.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting6.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/boosting7.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_gaussian_quantiles</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x1,y1 = make_gaussian_quantiles(n_samples=<span class="number">500</span>,n_features=<span class="number">2</span>,n_classes=<span class="number">2</span>)</span><br><span class="line">x2,y2 = make_gaussian_quantiles(mean=(<span class="number">3</span>,<span class="number">3</span>),n_samples=<span class="number">500</span>,n_features=<span class="number">2</span>,n_classes=<span class="number">2</span>)</span><br><span class="line">x_data = np.concatenate((x1,x2))</span><br><span class="line">y_data = np.concatenate((y1,<span class="number">1</span>-y2))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.scatter(x_data[:,<span class="number">-0</span>],x_data[:,<span class="number">1</span>],c=y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0boosting/output_3_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = tree.DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">model.fit(x_data,y_data)</span><br><span class="line">x_min,x_max = x_data[:,<span class="number">0</span>].min()<span class="number">-1</span>,x_data[:,<span class="number">0</span>].max()+<span class="number">1</span></span><br><span class="line">y_min,y_max = x_data[:,<span class="number">1</span>].min()<span class="number">-1</span>,x_data[:,<span class="number">1</span>].max()+<span class="number">1</span></span><br><span class="line"><span class="comment"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">0.02</span>),</span><br><span class="line">                     np.arange(y_min, y_max, <span class="number">0.02</span>))</span><br><span class="line"></span><br><span class="line">z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class="comment"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class="line">z = z.reshape(xx.shape)</span><br><span class="line"><span class="comment"># ç­‰é«˜çº¿å›¾</span></span><br><span class="line">cs = plt.contourf(xx, yy, z)</span><br><span class="line"><span class="comment"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class="line">plt.scatter(x_data[:, <span class="number">0</span>], x_data[:, <span class="number">1</span>], c=y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0boosting/output_4_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model.score(x_data,y_data)</span><br></pre></td></tr></table></figure>




<pre><code>0.705</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = AdaBoostClassifier(DecisionTreeClassifier(max_depth=<span class="number">3</span>),n_estimators=<span class="number">10</span>)</span><br><span class="line">model.fit(x_data,y_data)</span><br><span class="line"><span class="comment"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class="line">x_min, x_max = x_data[:, <span class="number">0</span>].min() - <span class="number">1</span>, x_data[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">y_min, y_max = x_data[:, <span class="number">1</span>].min() - <span class="number">1</span>, x_data[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">0.02</span>),</span><br><span class="line">                     np.arange(y_min, y_max, <span class="number">0.02</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–é¢„æµ‹å€¼</span></span><br><span class="line">z = model.predict(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">z = z.reshape(xx.shape)</span><br><span class="line"><span class="comment"># ç­‰é«˜çº¿å›¾</span></span><br><span class="line">cs = plt.contourf(xx, yy, z)</span><br><span class="line"><span class="comment"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class="line">plt.scatter(x_data[:, <span class="number">0</span>], x_data[:, <span class="number">1</span>], c=y_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0boosting/output_6_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model.score(x_data,y_data)</span><br></pre></td></tr></table></figure>




<pre><code>0.988</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é›†æˆå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>é›†æˆå­¦ä¹ voting</title>
    <url>/2020/07/11/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0voting/</url>
    <content><![CDATA[<p>votingä»£ç ç®€å•æ¼”ç¤º</p>
<a id="more"></a>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> VotingClassifier</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">iris = datasets.load_iris()</span><br><span class="line">x_data,y_data = iris.data[:,<span class="number">1</span>:<span class="number">3</span>],iris.target</span><br><span class="line">clf1 = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br><span class="line">clf2 = DecisionTreeClassifier()</span><br><span class="line">clf3 = LogisticRegression()</span><br><span class="line"></span><br><span class="line">sclf = VotingClassifier([(<span class="string">'knn'</span>,clf1),(<span class="string">'dtree'</span>,clf2),(<span class="string">'lr'</span>,clf3)])</span><br><span class="line"><span class="keyword">for</span> clf,label <span class="keyword">in</span> zip([clf1,clf2,clf3,sclf],</span><br><span class="line">                    [<span class="string">'KNN'</span>,<span class="string">'Decistion Tree'</span>,<span class="string">'LogisticRegression'</span>,<span class="string">'VotingClassifier'</span>]):</span><br><span class="line">    scores = model_selection.cross_val_score(clf,x_data,y_data,cv=<span class="number">3</span>,scoring=<span class="string">'accuracy'</span>)</span><br><span class="line">    print(<span class="string">'Accuracy: %0.2f[%s]'</span> %(scores.mean(),label))</span><br></pre></td></tr></table></figure>

<pre><code>Accuracy: 0.91[KNN]
Accuracy: 0.90[Decistion Tree]
Accuracy: 0.91[LogisticRegression]
Accuracy: 0.92[VotingClassifier]


C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:433: FutureWarning: Default solver will be changed to &apos;lbfgs&apos; in 0.22. Specify a solver to silence this warning.
  FutureWarning)
C:\Users\å¼ å¸…\AppData\Roaming\Python\Python36\site-packages\sklearn\linear_model\logistic.py:460: FutureWarning: Default multi_class will be changed to &apos;auto&apos; in 0.22. Specify the multi_class option to silence this warning.
  &quot;this warning.&quot;, FutureWarning)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é›†æˆå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>éçº¿æ€§é€»è¾‘å›å½’</title>
    <url>/2020/07/09/%E9%9D%9E%E7%BA%BF%E6%80%A7%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/</url>
    <content><![CDATA[<p>éçº¿æ€§é€»è¾‘å›å½’ä»£ç æ¼”ç¤º<br>æ•°æ®ä¸‹è½½<a href="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/data/LR-testSet2.txt" target="_blank" rel="noopener">LR-testSet2.txt</a></p>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line">scale = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<ul>
<li>np.newaxisçš„åŠŸèƒ½â€”â€”æ’å…¥æ–°ç»´åº¦</li>
</ul>
<hr>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ä»‹ç»ä¸€ä¸‹å§ã€‚</p>
<ul>
<li><p>æ —å­1ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#x3D;np.array([1,2,3,4,5])</span><br><span class="line">print(a.shape)</span><br><span class="line">print (a)</span><br></pre></td></tr></table></figure></li>
<li><p>è¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(5,)</span><br><span class="line">[1 2 3 4 5]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ —å­2ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">a&#x3D;np.array([1,2,3,4,5])</span><br><span class="line">aa&#x3D;a[:,np.newaxis]</span><br><span class="line">print(aa.shape)</span><br><span class="line">print (aa)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(5, 1)</span><br><span class="line">[[1]</span><br><span class="line">[2]</span><br><span class="line">[3]</span><br><span class="line">[4]</span><br><span class="line">[5]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ —å­3ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">a&#x3D;np.array([1,2,3,4,5])</span><br><span class="line">aa&#x3D;a[np.newaxis,:]</span><br><span class="line">print(aa.shape)</span><br><span class="line">print (aa)</span><br></pre></td></tr></table></figure></li>
<li><p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(1, 5)</span><br><span class="line">[[1 2 3 4 5]]</span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<p>çœ‹æ˜ç™½äº†å§ï¼ŒåŸæ¥np.newaxisçš„ä½œç”¨æ˜¯å¢åŠ ä¸€ä¸ªç»´åº¦ã€‚</p>
<p>å¯¹äº[: , np.newaxis] å’Œ [np.newaxisï¼Œï¼š]<br>æ˜¯åœ¨np.newaxisè¿™é‡Œå¢åŠ 1ç»´ã€‚</p>
<p>è¿™æ ·æ”¹å˜ç»´åº¦çš„ä½œç”¨å¾€å¾€æ˜¯å°†ä¸€ç»´çš„æ•°æ®è½¬å˜æˆä¸€ä¸ªçŸ©é˜µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = np.genfromtxt(<span class="string">'./data/LR-testSet2.txt'</span>,delimiter=<span class="string">','</span>)</span><br><span class="line">x_data = data[:,:<span class="number">-1</span>] <span class="comment">#shape(118, 2)</span></span><br><span class="line">y_data = data[:,<span class="number">-1</span>,np.newaxis] <span class="comment">#shape(118, 1)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot</span><span class="params">()</span>:</span></span><br><span class="line">    x0 = []</span><br><span class="line">    x1 = []</span><br><span class="line">    y0 = []</span><br><span class="line">    y1 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x_data)):</span><br><span class="line">        <span class="keyword">if</span> y_data[i]==<span class="number">0</span>:</span><br><span class="line">            x0.append(x_data[i,<span class="number">0</span>])</span><br><span class="line">            y0.append(x_data[i,<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x1.append(x_data[i,<span class="number">0</span>])</span><br><span class="line">            y1.append(x_data[i,<span class="number">1</span>])</span><br><span class="line">    scatter0 = plt.scatter(x0,y0,c=<span class="string">'b'</span>,marker=<span class="string">'o'</span>)</span><br><span class="line">    scatter1 = plt.scatter(x1,y1,c=<span class="string">'r'</span>,marker=<span class="string">'x'</span>)</span><br><span class="line">    plt.legend(handles=[scatter0,scatter1],labels=[<span class="string">'labell0'</span>,<span class="string">'label1'</span>],loc=<span class="string">'best'</span>)</span><br><span class="line"></span><br><span class="line">plot()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9D%9E%E7%BA%BF%E6%80%A7%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/output_2_0.png" alt="png"></p>
<p>ä½¿ç”¨sklearn.preprocessing.PolynomialFeaturesæ¥è¿›è¡Œç‰¹å¾çš„æ„é€ ã€‚</p>
<p>å®ƒæ˜¯ä½¿ç”¨å¤šé¡¹å¼çš„æ–¹æ³•æ¥è¿›è¡Œçš„ï¼Œå¦‚æœæœ‰aï¼Œbä¸¤ä¸ªç‰¹å¾ï¼Œé‚£ä¹ˆå®ƒçš„2æ¬¡å¤šé¡¹å¼ä¸ºï¼ˆ1,a,b,a^2,ab, b^2ï¼‰ï¼Œè¿™ä¸ªå¤šé¡¹å¼çš„å½¢å¼æ˜¯ä½¿ç”¨polyçš„æ•ˆæœã€‚</p>
<p>PolynomialFeaturesæœ‰ä¸‰ä¸ªå‚æ•°</p>
<ul>
<li>degreeï¼šæ§åˆ¶å¤šé¡¹å¼çš„åº¦</li>
<li>interaction_onlyï¼š é»˜è®¤ä¸ºFalseï¼Œå¦‚æœæŒ‡å®šä¸ºTrueï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰ç‰¹å¾è‡ªå·±å’Œè‡ªå·±ç»“åˆçš„é¡¹ï¼Œä¸Šé¢çš„äºŒæ¬¡é¡¹ä¸­æ²¡æœ‰a^2å’Œb^2ã€‚</li>
<li>include_biasï¼šé»˜è®¤ä¸ºTrueã€‚å¦‚æœä¸ºTrueçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸Šé¢çš„ 1é‚£ä¸€é¡¹ã€‚</li>
</ul>
<p>ä¾‹å­1ï¼Œinteraction_onlyä¸ºé»˜è®¤çš„Falseæ—¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;[[5,10]] Â Â  #c&#x3D;[[a,b]],è¿™é‡Œè¦æ³¨æ„açš„shapeï¼Œå¦‚æœæ˜¯listå½¢å¼ï¼Œåˆ™å°†a.shape&#x3D;-1,1</span><br><span class="line">pl&#x3D;PolynomialFeatures()</span><br><span class="line">b&#x3D;pl.fit_transform(c)</span><br><span class="line">b</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[Â  1.,Â Â  5.,Â  10.,Â  25.,Â  50., 100.]])Â </span><br><span class="line">#ç¬¦åˆï¼ˆ1,a,b,a^2,ab, b^2ï¼‰</span><br></pre></td></tr></table></figure>

<p>ä¾‹å­2ï¼Œinteraction_only=Trueæ—¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;[[5,10]]</span><br><span class="line">pl&#x3D;PolynomialFeatures(interaction_only&#x3D;True)</span><br><span class="line">b&#x3D;pl.fit_transform(c)</span><br><span class="line">b</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[ 1.,Â  5., 10., 50.]]) Â Â </span><br><span class="line">#è¾“å‡ºä¸­ä¸åŒ…å«a^2å’Œb^2é¡¹</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">poly_reg = PolynomialFeatures(degree=<span class="number">3</span>)</span><br><span class="line">x_poly = poly_reg.fit_transform(x_data)</span><br><span class="line">x_poly</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 1.00000000e+00,  5.12670000e-02,  6.99560000e-01, ...,
         1.83865725e-03,  2.50892595e-02,  3.42353606e-01],
       [ 1.00000000e+00, -9.27420000e-02,  6.84940000e-01, ...,
         5.89122275e-03, -4.35092419e-02,  3.21334672e-01],
       [ 1.00000000e+00, -2.13710000e-01,  6.92250000e-01, ...,
         3.16164171e-02, -1.02411982e-01,  3.31733166e-01],
       ...,
       [ 1.00000000e+00, -4.84450000e-01,  9.99270000e-01, ...,
         2.34520477e-01, -4.83742961e-01,  9.97811598e-01],
       [ 1.00000000e+00, -6.33640000e-03,  9.99270000e-01, ...,
         4.01206555e-05, -6.32715223e-03,  9.97811598e-01],
       [ 1.00000000e+00,  6.32650000e-01, -3.06120000e-02, ...,
        -1.22523312e-02,  5.92852863e-04, -2.86863382e-05]])</code></pre><p><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%921.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%922.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%923.png" alt><br><img src="http://zs-hexo-blog.oss-cn-beijing.aliyuncs.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%924.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span>/(<span class="number">1</span>+np.exp(-x))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cost</span><span class="params">(xMat,yMat,ws)</span>:</span></span><br><span class="line">    left = np.multiply(yMat,np.log(sigmoid(xMat*ws)))</span><br><span class="line">    right = np.multiply(<span class="number">1</span>-yMat,np.log(<span class="number">1</span>-sigmoid(xMat*ws)))</span><br><span class="line">    <span class="keyword">return</span> np.sum(left+right)/-(len(xMat))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradAscent</span><span class="params">(xArr,yArr)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> scale == <span class="literal">True</span>:</span><br><span class="line">        xArr = preprocessing.scale(xArr)</span><br><span class="line">    xMat = np.mat(xArr)</span><br><span class="line">    yMat = np.mat(yArr)</span><br><span class="line">    lr = <span class="number">0.03</span></span><br><span class="line">    epochs = <span class="number">50000</span></span><br><span class="line">    costList = []</span><br><span class="line">    m,n = np.shape(xMat)</span><br><span class="line">    ws = np.mat(np.ones((n,<span class="number">1</span>)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(epochs+<span class="number">1</span>):</span><br><span class="line">        h = sigmoid(xMat*ws)</span><br><span class="line">        ws_grad = xMat.T*(h-yMat)/m</span><br><span class="line">        ws = ws - lr*ws_grad</span><br><span class="line">        <span class="keyword">if</span> i %<span class="number">50</span> == <span class="number">0</span>:</span><br><span class="line">            costList.append(cost(xMat,yMat,ws))</span><br><span class="line">    <span class="keyword">return</span> ws,costList</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws, costList = gradAscent(x_poly,y_data)</span><br><span class="line">print(ws)</span><br></pre></td></tr></table></figure>

<pre><code>[[ 4.16787292]
 [ 2.72213524]
 [ 4.55120018]
 [-9.76109006]
 [-5.34880198]
 [-8.51458023]
 [-0.55950401]
 [-1.55418165]
 [-0.75929829]
 [-2.88573877]]</code></pre><p>np.c_æ˜¯æŒ‰è¡Œè¿æ¥ä¸¤ä¸ªçŸ©é˜µï¼Œå°±æ˜¯æŠŠä¸¤çŸ©é˜µå·¦å³ç›¸åŠ ï¼Œè¦æ±‚è¡Œæ•°ç›¸ç­‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a &#x3D; np.array([[1, 2, 3],[7,8,9]])</span><br><span class="line"> </span><br><span class="line">b&#x3D;np.array([[4,5,6],[1,2,3]])</span><br><span class="line"> </span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<p>Out[4]: </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[1, 2, 3],</span><br><span class="line">       [7, 8, 9]])</span><br></pre></td></tr></table></figure>

<p>b<br>Out[5]: </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[4, 5, 6],</span><br><span class="line">       [1, 2, 3]])</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;np.c_[a,b]</span><br><span class="line"> </span><br><span class="line">c</span><br></pre></td></tr></table></figure>
<p>Out[7]: </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[1, 2, 3, 4, 5, 6],</span><br><span class="line">       [7, 8, 9, 1, 2, 3]])</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">d&#x3D; np.array([7,8,9])</span><br><span class="line"> </span><br><span class="line">e&#x3D;np.array([1, 2, 3])</span><br><span class="line"> </span><br><span class="line">f&#x3D;np.c_[d,e]</span><br><span class="line"> </span><br><span class="line">f</span><br></pre></td></tr></table></figure>
<p>Out[12]: </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array([[7, 1],</span><br><span class="line">       [8, 2],</span><br><span class="line">       [9, 3]])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_min,x_max = x_data[:,<span class="number">0</span>].min()<span class="number">-1</span>,x_data[:,<span class="number">0</span>].max()+<span class="number">1</span></span><br><span class="line">y_min,y_max = x_data[:,<span class="number">1</span>].min()<span class="number">-1</span>,x_data[:,<span class="number">1</span>].max()+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">xx,yy = np.meshgrid(np.arange(x_min,y_max,<span class="number">0.02</span>),</span><br><span class="line">                   np.arange(y_min,y_max,<span class="number">0.02</span>))</span><br><span class="line"><span class="comment"># ravalå¤šç»´è½¬ä¸€ç»´</span></span><br><span class="line"><span class="comment"># dotçŸ©é˜µä¹˜ç§¯</span></span><br><span class="line"><span class="comment"># np.c_å·¦å³æ‹¼æ¥ä¸¤ä¸ªçŸ©é˜µ</span></span><br><span class="line">z = sigmoid(poly_reg.fit_transform(np.c_[xx.ravel(),yy.ravel()]).dot(np.array(ws)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(z)):</span><br><span class="line">    <span class="keyword">if</span> z[i]&gt;<span class="number">0.5</span>:</span><br><span class="line">        z[i]=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        z[i]=<span class="number">0</span></span><br><span class="line">z=z.reshape(xx.shape)</span><br><span class="line"></span><br><span class="line">cs = plt.contourf(xx,yy,z)</span><br><span class="line">plot()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2020/07/09/%E9%9D%9E%E7%BA%BF%E6%80%A7%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/output_9_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(x_data,ws)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> scale == <span class="literal">True</span>:</span><br><span class="line">        x_data = preprocessing.scale(x_data)</span><br><span class="line">    xMat = np.mat(x_data)</span><br><span class="line">    ws = np.mat(ws)</span><br><span class="line">    <span class="keyword">return</span> [<span class="number">1</span> <span class="keyword">if</span> x&gt;=<span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> sigmoid(xMat*ws)] </span><br><span class="line"></span><br><span class="line">predictions = predict(x_poly,ws)</span><br><span class="line">print(classification_report(y_data,predictions))</span><br></pre></td></tr></table></figure>

<pre><code>              precision    recall  f1-score   support

         0.0       0.86      0.83      0.85        60
         1.0       0.83      0.86      0.85        58

    accuracy                           0.85       118
   macro avg       0.85      0.85      0.85       118
weighted avg       0.85      0.85      0.85       118</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é€»è¾‘å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>opencvä¸­çš„å›¾åƒå¤„ç†4-ç›´æ–¹å›¾</title>
    <url>/2020/07/14/opencv%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%864-%E7%9B%B4%E6%96%B9%E5%9B%BE/</url>
    <content><![CDATA[<ul>
<li>10.1.<a href="#header1">ç›´æ–¹å›¾-1ï¼šæŸ¥æ‰¾ã€ç»˜åˆ¶å’Œåˆ†æ</a></li>
<li>10.2.<a href="#header2">ç›´æ–¹å›¾-2ï¼šç›´æ–¹å›¾å‡è¡¡</a></li>
<li>10.3.<a href="#header3">ç›´æ–¹å›¾-3ï¼šäºŒç»´ç›´æ–¹å›¾</a></li>
<li>10.4.<a href="#header4">ç›´æ–¹å›¾4ï¼šç›´æ–¹å›¾åæŠ•å½±</a><a id="more"></a>

</li>
</ul>
<h1 id="ç›´æ–¹å›¾-1ï¼šæŸ¥æ‰¾ã€ç»˜åˆ¶å’Œåˆ†æ"><a href="#ç›´æ–¹å›¾-1ï¼šæŸ¥æ‰¾ã€ç»˜åˆ¶å’Œåˆ†æ" class="headerlink" title="ç›´æ–¹å›¾-1ï¼šæŸ¥æ‰¾ã€ç»˜åˆ¶å’Œåˆ†æ"></a><span id="header1">ç›´æ–¹å›¾-1ï¼šæŸ¥æ‰¾ã€ç»˜åˆ¶å’Œåˆ†æ</span></h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>å­¦ä¼š </p>
<ul>
<li>ä½¿ç”¨OpenCVå’ŒNumpyå‡½æ•°æŸ¥æ‰¾ç›´æ–¹å›¾ </li>
<li>ä½¿ç”¨OpenCVå’ŒMatplotlibå‡½æ•°ç»˜åˆ¶ç›´æ–¹å›¾ </li>
<li>ä½ å°†çœ‹åˆ°ä»¥ä¸‹å‡½æ•°ï¼šcv.calcHist()ï¼Œnp.histogram()ç­‰ã€‚</li>
</ul>
<h2 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>é‚£ä¹ˆç›´æ–¹å›¾æ˜¯ä»€ä¹ˆï¼Ÿæ‚¨å¯ä»¥å°†ç›´æ–¹å›¾è§†ä¸ºå›¾å½¢æˆ–ç»˜å›¾ï¼Œä»è€Œå¯ä»¥æ€»ä½“äº†è§£å›¾åƒçš„å¼ºåº¦åˆ†å¸ƒã€‚</p>
<p>å®ƒæ˜¯åœ¨Xè½´ä¸Šå…·æœ‰åƒç´ å€¼ï¼ˆä¸æ€»æ˜¯ä»0åˆ°255çš„èŒƒå›´ï¼‰ï¼Œåœ¨Yè½´ä¸Šå…·æœ‰å›¾åƒä¸­ç›¸åº”åƒç´ æ•°çš„å›¾ã€‚</p>
<p>è¿™åªæ˜¯ç†è§£å›¾åƒçš„å¦ä¸€ç§æ–¹å¼ã€‚é€šè¿‡æŸ¥çœ‹å›¾åƒçš„ç›´æ–¹å›¾ï¼Œæ‚¨å¯ä»¥ç›´è§‚åœ°äº†è§£è¯¥å›¾åƒçš„å¯¹æ¯”åº¦ï¼Œäº®åº¦ï¼Œå¼ºåº¦åˆ†å¸ƒç­‰ã€‚</p>
<p>å½“ä»Šå‡ ä¹æ‰€æœ‰å›¾åƒå¤„ç†å·¥å…·éƒ½æä¾›ç›´æ–¹å›¾åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯å‰‘æ¡¥å½©è‰²ç½‘ç«™çš„å›¾ç‰‡ï¼Œæˆ‘å»ºè®®æ‚¨è®¿é—®è¯¥ç½‘ç«™ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p>
<p><img src="http://qiniu.aihubs.net/histogram_sample.jpg" alt></p>
<p>æ‚¨å¯ä»¥çœ‹åˆ°å›¾åƒåŠå…¶ç›´æ–¹å›¾ã€‚ï¼ˆè¯·è®°ä½ï¼Œæ­¤ç›´æ–¹å›¾æ˜¯é’ˆå¯¹ç°åº¦å›¾åƒè€Œéå½©è‰²å›¾åƒç»˜åˆ¶çš„ï¼‰ã€‚</p>
<p>ç›´æ–¹å›¾çš„å·¦ä¾§åŒºåŸŸæ˜¾ç¤ºå›¾åƒä¸­è¾ƒæš—åƒç´ çš„æ•°é‡ï¼Œè€Œå³ä¾§åŒºåŸŸåˆ™æ˜¾ç¤ºæ˜äº®åƒç´ çš„æ•°é‡ã€‚</p>
<p>ä»ç›´æ–¹å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æš—åŒºåŸŸå¤šäºäº®åŒºåŸŸï¼Œè€Œä¸­é—´è°ƒçš„æ•°é‡ï¼ˆä¸­é—´å€¼çš„åƒç´ å€¼ï¼Œä¾‹å¦‚127é™„è¿‘ï¼‰åˆ™éå¸¸å°‘ã€‚</p>
<h2 id="å¯»æ‰¾ç›´æ–¹å›¾"><a href="#å¯»æ‰¾ç›´æ–¹å›¾" class="headerlink" title="å¯»æ‰¾ç›´æ–¹å›¾"></a>å¯»æ‰¾ç›´æ–¹å›¾</h2><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå…³äºç›´æ–¹å›¾çš„æƒ³æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç ”ç©¶å¦‚ä½•æ‰¾åˆ°å®ƒã€‚OpenCVå’ŒNumpyéƒ½ä¸ºæ­¤å†…ç½®äº†åŠŸèƒ½ã€‚</p>
<p>åœ¨ä½¿ç”¨è¿™äº›åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›ä¸ç›´æ–¹å›¾æœ‰å…³çš„æœ¯è¯­ã€‚</p>
<p>BINSï¼šä¸Šé¢çš„ç›´æ–¹å›¾æ˜¾ç¤ºæ¯ä¸ªåƒç´ å€¼çš„åƒç´ æ•°ï¼Œå³ä»0åˆ°255ã€‚å³ï¼Œæ‚¨éœ€è¦256ä¸ªå€¼æ¥æ˜¾ç¤ºä¸Šé¢çš„ç›´æ–¹å›¾ã€‚ä½†æ˜¯è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœæ‚¨ä¸éœ€è¦åˆ†åˆ«æ‰¾åˆ°æ‰€æœ‰åƒç´ å€¼çš„åƒç´ æ•°ï¼Œè€Œæ˜¯æ‰¾åˆ°åƒç´ å€¼é—´éš”ä¸­çš„åƒç´ æ•°æ€ä¹ˆåŠï¼Ÿ ä¾‹å¦‚ï¼Œæ‚¨éœ€è¦æ‰¾åˆ°ä»‹äº0åˆ°15ä¹‹é—´çš„åƒç´ æ•°ï¼Œç„¶åæ‰¾åˆ°16åˆ°31ä¹‹é—´ï¼Œâ€¦ï¼Œ240åˆ°255ä¹‹é—´çš„åƒç´ æ•°ã€‚åªéœ€è¦16ä¸ªå€¼å³å¯è¡¨ç¤ºç›´æ–¹å›¾ã€‚è¿™å°±æ˜¯åœ¨OpenCVæ•™ç¨‹ä¸­æœ‰å…³ç›´æ–¹å›¾çš„ç¤ºä¾‹ä¸­æ˜¾ç¤ºçš„å†…å®¹ã€‚</p>
<p>å› æ­¤ï¼Œæ‚¨è¦åšçš„å°±æ˜¯å°†æ•´ä¸ªç›´æ–¹å›¾åˆ†æˆ16ä¸ªå­éƒ¨åˆ†ï¼Œæ¯ä¸ªå­éƒ¨åˆ†çš„å€¼å°±æ˜¯å…¶ä¸­æ‰€æœ‰åƒç´ æ•°çš„æ€»å’Œã€‚ æ¯ä¸ªå­éƒ¨åˆ†éƒ½ç§°ä¸ºâ€œ BINâ€ã€‚åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œbinçš„æ•°é‡ä¸º256ä¸ªï¼ˆæ¯ä¸ªåƒç´ ä¸€ä¸ªï¼‰ï¼Œè€Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œbinçš„æ•°é‡ä»…ä¸º16ä¸ªã€‚BINSç”±OpenCVæ–‡æ¡£ä¸­çš„<strong>histSize</strong>æœ¯è¯­è¡¨ç¤ºã€‚</p>
<p>DIMSï¼šè¿™æ˜¯æˆ‘ä»¬ä¸ºå…¶æ”¶é›†æ•°æ®çš„å‚æ•°çš„æ•°é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»…æ”¶é›†å…³äºå¼ºåº¦å€¼çš„ä¸€ä»¶äº‹çš„æ•°æ®ã€‚æ‰€ä»¥è¿™é‡Œæ˜¯1ã€‚</p>
<p>RANGEï¼šè¿™æ˜¯æ‚¨è¦æµ‹é‡çš„å¼ºåº¦å€¼çš„èŒƒå›´ã€‚é€šå¸¸ï¼Œå®ƒæ˜¯[0,256]ï¼Œå³æ‰€æœ‰å¼ºåº¦å€¼ã€‚</p>
<h2 id="1-OpenCVä¸­çš„ç›´æ–¹å›¾è®¡ç®—"><a href="#1-OpenCVä¸­çš„ç›´æ–¹å›¾è®¡ç®—" class="headerlink" title="1. OpenCVä¸­çš„ç›´æ–¹å›¾è®¡ç®—"></a>1. OpenCVä¸­çš„ç›´æ–¹å›¾è®¡ç®—</h2><p>å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨<strong>cv.calcHist</strong>()å‡½æ•°æŸ¥æ‰¾ç›´æ–¹å›¾ã€‚è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹è¯¥å‡½æ•°åŠå…¶å‚æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cv.calcHistï¼ˆimagesï¼Œchannelsï¼Œmaskï¼ŒhistSizeï¼Œranges [ï¼Œhist [ï¼Œaccumulate]]ï¼‰</span><br><span class="line">imagesï¼šå®ƒæ˜¯uint8æˆ–float32ç±»å‹çš„æºå›¾åƒã€‚å®ƒåº”è¯¥æ”¾åœ¨æ–¹æ‹¬å·ä¸­ï¼Œå³â€œ [img]â€ã€‚</span><br><span class="line">channelsï¼šä¹Ÿä»¥æ–¹æ‹¬å·ç»™å‡ºã€‚å®ƒæ˜¯æˆ‘ä»¬è®¡ç®—ç›´æ–¹å›¾çš„é€šé“çš„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥ä¸ºç°åº¦å›¾åƒï¼Œåˆ™å…¶å€¼ä¸º[0]ã€‚å¯¹äºå½©è‰²å›¾åƒï¼Œæ‚¨å¯ä»¥ä¼ é€’[0]ï¼Œ[1]æˆ–[2]åˆ†åˆ«è®¡ç®—è“è‰²ï¼Œç»¿è‰²æˆ–çº¢è‰²é€šé“çš„ç›´æ–¹å›¾ã€‚</span><br><span class="line">maskï¼šå›¾åƒæ©ç ã€‚ä¸ºäº†æ‰¾åˆ°å®Œæ•´å›¾åƒçš„ç›´æ–¹å›¾ï¼Œå°†å…¶æŒ‡å®šä¸ºâ€œæ— â€ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦æŸ¥æ‰¾å›¾åƒç‰¹å®šåŒºåŸŸçš„ç›´æ–¹å›¾ï¼Œåˆ™å¿…é¡»ä¸ºæ­¤åˆ›å»ºä¸€ä¸ªæ©ç å›¾åƒå¹¶å°†å…¶ä½œä¸ºæ©ç ã€‚ï¼ˆæˆ‘å°†åœ¨åé¢æ˜¾ç¤ºä¸€ä¸ªç¤ºä¾‹ã€‚ï¼‰</span><br><span class="line">histSizeï¼šè¿™è¡¨ç¤ºæˆ‘ä»¬çš„BINè®¡æ•°ã€‚éœ€è¦æ”¾åœ¨æ–¹æ‹¬å·ä¸­ã€‚å¯¹äºå…¨å°ºå¯¸ï¼Œæˆ‘ä»¬é€šè¿‡[256]ã€‚</span><br><span class="line">rangesï¼šè¿™æ˜¯æˆ‘ä»¬çš„RANGEã€‚é€šå¸¸ä¸º[0,256]ã€‚</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œè®©æˆ‘ä»¬ä»ç¤ºä¾‹å›¾åƒå¼€å§‹ã€‚åªéœ€ä»¥ç°åº¦æ¨¡å¼åŠ è½½å›¾åƒå¹¶æ‰¾åˆ°å…¶å®Œæ•´ç›´æ–¹å›¾å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;,0)</span><br><span class="line">hist &#x3D; cv.calcHist([img],[0],None,[256],[0,256])</span><br></pre></td></tr></table></figure>
<p>histæ˜¯256x1çš„æ•°ç»„ï¼Œæ¯ä¸ªå€¼å¯¹åº”äºè¯¥å›¾åƒä¸­å…·æœ‰ç›¸åº”åƒç´ å€¼çš„åƒç´ æ•°ã€‚</p>
<h2 id="2-numpyçš„ç›´æ–¹å›¾è®¡ç®—"><a href="#2-numpyçš„ç›´æ–¹å›¾è®¡ç®—" class="headerlink" title="2. numpyçš„ç›´æ–¹å›¾è®¡ç®—"></a>2. numpyçš„ç›´æ–¹å›¾è®¡ç®—</h2><p>Numpyè¿˜ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªå‡½æ•°<strong>np.histogram</strong>()ã€‚å› æ­¤ï¼Œé™¤äº†<strong>calcHist</strong>()å‡½æ•°å¤–ï¼Œæ‚¨å¯ä»¥å°è¯•ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hist,bins &#x3D; np.histogram(img.ravel(),256,[0,256])</span><br></pre></td></tr></table></figure>
<p>histä¸æˆ‘ä»¬ä¹‹å‰è®¡ç®—çš„ç›¸åŒã€‚ä½†æ˜¯binå°†å…·æœ‰257ä¸ªå…ƒç´ ï¼Œå› ä¸ºNumpyè®¡ç®—å‡ºbinçš„èŒƒå›´ä¸º0-0.99ã€1-1.99ã€2-2.99ç­‰ã€‚å› æ­¤æœ€ç»ˆèŒƒå›´ä¸º255-255.99ã€‚ä¸ºäº†è¡¨ç¤ºè¿™ä¸€ç‚¹ï¼Œä»–ä»¬è¿˜åœ¨æœ€åæ·»åŠ äº†256ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦256ã€‚æœ€å¤š255å°±è¶³å¤Ÿäº†ã€‚</p>
<p>å¦å¤– Numpyè¿˜æœ‰å¦ä¸€ä¸ªå‡½æ•°<strong>np.bincount</strong>()ï¼Œå®ƒæ¯”np.histogram()å¿«10å€å·¦å³ã€‚å› æ­¤ï¼Œå¯¹äºä¸€ç»´ç›´æ–¹å›¾ï¼Œæ‚¨å¯ä»¥æ›´å¥½åœ°å°è¯•ä¸€ä¸‹ã€‚ä¸è¦å¿˜è®°åœ¨np.bincountä¸­è®¾ç½®minlength = 256ã€‚ä¾‹å¦‚ï¼Œhist = np.bincount(img.ravel()ï¼Œminlength = 256)<br>æ³¨æ„ OpenCVå‡½æ•°æ¯”np.histogram()å¿«å¤§çº¦40å€ã€‚å› æ­¤ï¼Œå°½å¯èƒ½ä½¿ç”¨OpenCVå‡½æ•°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬åº”è¯¥ç»˜åˆ¶ç›´æ–¹å›¾ï¼Œä½†æ˜¯æ€ä¹ˆç»˜åˆ¶ï¼Ÿ</p>
<h2 id="ç»˜åˆ¶ç›´æ–¹å›¾"><a href="#ç»˜åˆ¶ç›´æ–¹å›¾" class="headerlink" title="ç»˜åˆ¶ç›´æ–¹å›¾"></a>ç»˜åˆ¶ç›´æ–¹å›¾</h2><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ 1. ç®€çŸ­çš„æ–¹æ³•ï¼šä½¿ç”¨Matplotlibç»˜å›¾åŠŸèƒ½ 2. ç¨é•¿çš„æ–¹æ³•ï¼šä½¿ç”¨OpenCVç»˜å›¾åŠŸèƒ½</p>
<h2 id="1-ä½¿ç”¨Matplotlib"><a href="#1-ä½¿ç”¨Matplotlib" class="headerlink" title="1. ä½¿ç”¨Matplotlib"></a>1. ä½¿ç”¨Matplotlib</h2><p>Matplotlibå¸¦æœ‰ç›´æ–¹å›¾ç»˜å›¾åŠŸèƒ½ï¼šmatplotlib.pyplot.hist() å®ƒç›´æ¥æ‰¾åˆ°ç›´æ–¹å›¾å¹¶å°†å…¶ç»˜åˆ¶ã€‚</p>
<p>æ‚¨æ— éœ€ä½¿ç”¨<strong>calcHist</strong>()æˆ–np.histogram()å‡½æ•°æ¥æŸ¥æ‰¾ç›´æ–¹å›¾ã€‚è¯·å‚è§ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;,0)</span><br><span class="line">plt.hist(img.ravel(),256,[0,256]); plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="http://qiniu.aihubs.net/histogram_matplotlib.jpg" alt></p>
<p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨matplotlibçš„æ³•çº¿å›¾ï¼Œè¿™å¯¹äºBGRå›¾æ˜¯å¾ˆå¥½çš„ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›´æ–¹å›¾æ•°æ®ã€‚è¯•è¯•ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;)</span><br><span class="line">color &#x3D; (&#39;b&#39;,&#39;g&#39;,&#39;r&#39;)</span><br><span class="line">for i,col in enumerate(color):</span><br><span class="line">    histr &#x3D; cv.calcHist([img],[i],None,[256],[0,256])</span><br><span class="line">    plt.plot(histr,color &#x3D; col)</span><br><span class="line">    plt.xlim([0,256])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="http://qiniu.aihubs.net/histogram_rgb_plot.jpg" alt><br>æ‚¨å¯ä»¥ä»ä¸Šå›¾ä¸­å¾—å‡ºï¼Œè“è‰²åœ¨å›¾åƒä¸­å…·æœ‰ä¸€äº›é«˜å€¼åŸŸï¼ˆæ˜¾ç„¶è¿™åº”è¯¥æ˜¯ç”±äºå¤©ç©ºï¼‰</p>
<h2 id="2-ä½¿ç”¨-OpenCV"><a href="#2-ä½¿ç”¨-OpenCV" class="headerlink" title="2. ä½¿ç”¨ OpenCV"></a>2. ä½¿ç”¨ OpenCV</h2><p>å¥½å§ï¼Œåœ¨è¿™é‡Œæ‚¨å¯ä»¥è°ƒæ•´ç›´æ–¹å›¾çš„å€¼åŠå…¶binå€¼ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒxï¼Œyåæ ‡ï¼Œ</p>
<p>ä»¥ä¾¿æ‚¨å¯ä»¥ä½¿ç”¨<strong>cv.line</strong>()æˆ–cv.polyline()å‡½æ•°ç»˜åˆ¶å®ƒä»¥ç”Ÿæˆä¸ä¸Šè¿°ç›¸åŒçš„å›¾åƒã€‚</p>
<p>OpenCV-Python2å®˜æ–¹ç¤ºä¾‹å·²ç»æä¾›äº†æ­¤åŠŸèƒ½ã€‚æ£€æŸ¥ç¤ºä¾‹/python/hist.pyä¸­çš„ä»£ç ã€‚</p>
<p>æ©ç çš„åº”ç”¨<br>æˆ‘ä»¬ä½¿ç”¨äº†cv.calcHist()æ¥æŸ¥æ‰¾æ•´ä¸ªå›¾åƒçš„ç›´æ–¹å›¾ã€‚å¦‚æœä½ æƒ³æ‰¾åˆ°å›¾åƒæŸäº›åŒºåŸŸçš„ç›´æ–¹å›¾å‘¢?åªéœ€åˆ›å»ºä¸€ä¸ªæ©ç å›¾åƒï¼Œåœ¨ä½ è¦æ‰¾åˆ°ç›´æ–¹å›¾ä¸ºç™½è‰²ï¼Œå¦åˆ™é»‘è‰²ã€‚ç„¶åæŠŠè¿™ä¸ªä½œä¸ºæ©ç ä¼ é€’ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;,0)</span><br><span class="line"># create a mask</span><br><span class="line">mask &#x3D; np.zeros(img.shape[:2], np.uint8)</span><br><span class="line">mask[100:300, 100:400] &#x3D; 255</span><br><span class="line">masked_img &#x3D; cv.bitwise_and(img,img,mask &#x3D; mask)</span><br><span class="line"># è®¡ç®—æ©ç åŒºåŸŸå’Œéæ©ç åŒºåŸŸçš„ç›´æ–¹å›¾</span><br><span class="line"># æ£€æŸ¥ä½œä¸ºæ©ç çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span><br><span class="line">hist_full &#x3D; cv.calcHist([img],[0],None,[256],[0,256])</span><br><span class="line">hist_mask &#x3D; cv.calcHist([img],[0],mask,[256],[0,256])</span><br><span class="line">plt.subplot(221), plt.imshow(img, &#39;gray&#39;)</span><br><span class="line">plt.subplot(222), plt.imshow(mask,&#39;gray&#39;)</span><br><span class="line">plt.subplot(223), plt.imshow(masked_img, &#39;gray&#39;)</span><br><span class="line">plt.subplot(224), plt.plot(hist_full), plt.plot(hist_mask)</span><br><span class="line">plt.xlim([0,256])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç»“æœã€‚åœ¨ç›´æ–¹å›¾ä¸­ï¼Œè“çº¿è¡¨ç¤ºå®Œæ•´å›¾åƒçš„ç›´æ–¹å›¾ï¼Œç»¿çº¿è¡¨ç¤ºæ©ç åŒºåŸŸçš„ç›´æ–¹å›¾ã€‚<br><img src="http://qiniu.aihubs.net/histogram_masking.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ç›´æ–¹å›¾-2ï¼šç›´æ–¹å›¾å‡è¡¡"><a href="#ç›´æ–¹å›¾-2ï¼šç›´æ–¹å›¾å‡è¡¡" class="headerlink" title="ç›´æ–¹å›¾-2ï¼šç›´æ–¹å›¾å‡è¡¡"></a><span id="header2">ç›´æ–¹å›¾-2ï¼šç›´æ–¹å›¾å‡è¡¡</span></h1><h2 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬èŠ‚ä¸­, - æˆ‘ä»¬å°†å­¦ä¹ ç›´æ–¹å›¾å‡è¡¡åŒ–çš„æ¦‚å¿µ,å¹¶åˆ©ç”¨å®ƒæ¥æé«˜å›¾åƒçš„å¯¹æ¯”åº¦ã€‚</p>
<h2 id="ç†è®º-1"><a href="#ç†è®º-1" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªå›¾åƒï¼Œå®ƒçš„åƒç´ å€¼ä»…å±€é™äºæŸä¸ªç‰¹å®šçš„å€¼èŒƒå›´ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¾ƒäº®çš„å›¾åƒå°†æŠŠæ‰€æœ‰åƒç´ é™åˆ¶åœ¨é«˜å€¼ä¸Šã€‚ä½†æ˜¯ä¸€å¹…å¥½çš„å›¾åƒä¼šæœ‰æ¥è‡ªå›¾åƒæ‰€æœ‰åŒºåŸŸçš„åƒç´ ã€‚</p>
<p>å› æ­¤ï¼Œæ‚¨éœ€è¦å°†è¿™ä¸ªç›´æ–¹å›¾æ‹‰ä¼¸åˆ°ä¸¤ç«¯(å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¥è‡ªwikipedia)ï¼Œè¿™å°±æ˜¯ç›´æ–¹å›¾å‡è¡¡åŒ–çš„ä½œç”¨(ç®€å•æ¥è¯´)ã€‚è¿™é€šå¸¸ä¼šæé«˜å›¾åƒçš„å¯¹æ¯”åº¦ã€‚<br><img src="http://qiniu.aihubs.net/histogram_equalization.png" alt></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">img &#x3D; cv.imread(&#39;wiki.jpg&#39;,0)</span><br><span class="line">hist,bins &#x3D; np.histogram(img.flatten(),256,[0,256])</span><br><span class="line">cdf &#x3D; hist.cumsum()</span><br><span class="line">cdf_normalized &#x3D; cdf * float(hist.max()) &#x2F; cdf.max()</span><br><span class="line">plt.plot(cdf_normalized, color &#x3D; &#39;b&#39;)</span><br><span class="line">plt.hist(img.flatten(),256,[0,256], color &#x3D; &#39;r&#39;)</span><br><span class="line">plt.xlim([0,256])</span><br><span class="line">plt.legend((&#39;cdf&#39;,&#39;histogram&#39;), loc &#x3D; &#39;upper left&#39;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="http://qiniu.aihubs.net/histeq_numpy1.jpg" alt></p>
<p>ä½ å¯ä»¥çœ‹åˆ°ç›´æ–¹å›¾ä½äºè¾ƒäº®çš„åŒºåŸŸã€‚æˆ‘ä»¬éœ€è¦å…¨é¢‘è°±ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè½¬æ¢å‡½æ•°ï¼Œå°†äº®åŒºåŸŸçš„è¾“å…¥åƒç´ æ˜ å°„åˆ°æ•´ä¸ªåŒºåŸŸçš„è¾“å‡ºåƒç´ ã€‚è¿™å°±æ˜¯ç›´æ–¹å›¾å‡è¡¡åŒ–çš„ä½œç”¨ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ‰¾åˆ°æœ€å°çš„ç›´æ–¹å›¾å€¼(ä¸åŒ…æ‹¬0)ï¼Œå¹¶åº”ç”¨wikié¡µé¢ä¸­ç»™å‡ºçš„ç›´æ–¹å›¾å‡è¡¡åŒ–æ–¹ç¨‹ã€‚</p>
<p>ä½†æˆ‘åœ¨è¿™é‡Œç”¨è¿‡ï¼Œæ¥è‡ªNumpyçš„æ©ç æ•°ç»„æ¦‚å¿µæ•°ç»„ã€‚å¯¹äºæ©ç æ•°ç»„ï¼Œæ‰€æœ‰æ“ä½œéƒ½åœ¨éæ©ç å…ƒç´ ä¸Šæ‰§è¡Œã€‚æ‚¨å¯ä»¥ä»Numpyæ–‡æ¡£ä¸­äº†è§£æ›´å¤šå…³äºæ©ç æ•°ç»„çš„ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cdf_m &#x3D; np.ma.masked_equal(cdf,0)</span><br><span class="line">cdf_m &#x3D; (cdf_m - cdf_m.min())*255&#x2F;(cdf_m.max()-cdf_m.min())</span><br><span class="line">cdf &#x3D; np.ma.filled(cdf_m,0).astype(&#39;uint8&#39;)</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æŸ¥æ‰¾è¡¨ï¼Œè¯¥è¡¨ä¸ºæˆ‘ä»¬æä¾›äº†æœ‰å…³æ¯ä¸ªè¾“å…¥åƒç´ å€¼çš„è¾“å‡ºåƒç´ å€¼æ˜¯ä»€ä¹ˆçš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»…åº”ç”¨å˜æ¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">img2 &#x3D; cdf[img]</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬åƒä»¥å‰ä¸€æ ·è®¡ç®—å…¶ç›´æ–¹å›¾å’Œcdfï¼ˆæ‚¨è¿™æ ·åšï¼‰ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="http://qiniu.aihubs.net/histeq_numpy2.jpg" alt><br>å¦ä¸€ä¸ªé‡è¦çš„ç‰¹å¾æ˜¯ï¼Œå³ä½¿å›¾åƒæ˜¯ä¸€ä¸ªè¾ƒæš—çš„å›¾åƒ(è€Œä¸æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ä¸€ä¸ªè¾ƒäº®çš„å›¾åƒ)ï¼Œç»è¿‡å‡è¡¡åï¼Œæˆ‘ä»¬å°†å¾—åˆ°å‡ ä¹ç›¸åŒçš„å›¾åƒã€‚å› æ­¤ï¼Œè¿™æ˜¯ä½œä¸ºä¸€ä¸ªâ€œå‚è€ƒå·¥å…·â€ï¼Œä½¿æ‰€æœ‰çš„å›¾åƒå…·æœ‰ç›¸åŒçš„ç…§æ˜æ¡ä»¶ã€‚è¿™åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨äººè„¸è¯†åˆ«ä¸­ï¼Œåœ¨å¯¹äººè„¸æ•°æ®è¿›è¡Œè®­ç»ƒä¹‹å‰ï¼Œå¯¹äººè„¸å›¾åƒè¿›è¡Œç›´æ–¹å›¾å‡è¡¡åŒ–å¤„ç†ï¼Œä½¿å…¶å…·æœ‰ç›¸åŒçš„å…‰ç…§æ¡ä»¶ã€‚</p>
<h2 id="OpenCVä¸­çš„ç›´æ–¹å›¾å‡è¡¡"><a href="#OpenCVä¸­çš„ç›´æ–¹å›¾å‡è¡¡" class="headerlink" title="OpenCVä¸­çš„ç›´æ–¹å›¾å‡è¡¡"></a>OpenCVä¸­çš„ç›´æ–¹å›¾å‡è¡¡</h2><p>OpenCVå…·æœ‰æ‰§è¡Œæ­¤æ“ä½œçš„åŠŸèƒ½cv.equalizeHistï¼ˆï¼‰ã€‚</p>
<p>å®ƒçš„è¾“å…¥åªæ˜¯ç°åº¦å›¾åƒï¼Œè¾“å‡ºæ˜¯æˆ‘ä»¬çš„ç›´æ–¹å›¾å‡è¡¡å›¾åƒã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç‰‡æ®µï¼Œæ˜¾ç¤ºäº†å®ƒä¸æˆ‘ä»¬ä½¿ç”¨çš„åŒä¸€å›¾åƒçš„ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">img &#x3D; cv.imread(&#39;wiki.jpg&#39;,0)</span><br><span class="line">equ &#x3D; cv.equalizeHist(img)</span><br><span class="line">res &#x3D; np.hstack((img,equ)) #stacking images side-by-side</span><br><span class="line">cv.imwrite(&#39;res.png&#39;,res)</span><br></pre></td></tr></table></figure>
<p><img src="http://qiniu.aihubs.net/equalization_opencv.jpg" alt><br>å› æ­¤ï¼Œç°åœ¨æ‚¨å¯ä»¥åœ¨ä¸åŒçš„å…‰ç…§æ¡ä»¶ä¸‹æ‹æ‘„ä¸åŒçš„å›¾åƒï¼Œå¯¹å…¶è¿›è¡Œå‡è¡¡å¹¶æ£€æŸ¥ç»“æœã€‚</p>
<p>å½“å›¾åƒçš„ç›´æ–¹å›¾é™åˆ¶åœ¨ç‰¹å®šåŒºåŸŸæ—¶ï¼Œç›´æ–¹å›¾å‡è¡¡åŒ–æ•ˆæœå¾ˆå¥½ã€‚åœ¨ç›´æ–¹å›¾è¦†ç›–è¾ƒå¤§åŒºåŸŸï¼ˆå³åŒæ—¶å­˜åœ¨äº®åƒç´ å’Œæš—åƒç´ ï¼‰çš„å¼ºåº¦å˜åŒ–è¾ƒå¤§çš„åœ°æ–¹ï¼Œæ•ˆæœä¸å¥½ã€‚è¯·æ£€æŸ¥å…¶ä»–èµ„æºä¸­çš„SOFé“¾æ¥ã€‚</p>
<h2 id="CLAHEï¼ˆå¯¹æ¯”åº¦å—é™çš„è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡ï¼‰"><a href="#CLAHEï¼ˆå¯¹æ¯”åº¦å—é™çš„è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡ï¼‰" class="headerlink" title="CLAHEï¼ˆå¯¹æ¯”åº¦å—é™çš„è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡ï¼‰"></a>CLAHEï¼ˆå¯¹æ¯”åº¦å—é™çš„è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡ï¼‰</h2><p>æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªç›´æ–¹å›¾å‡è¡¡åŒ–è€ƒè™‘äº†å›¾åƒçš„æ•´ä½“å¯¹æ¯”åº¦ã€‚</p>
<p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾æ˜¾ç¤ºäº†è¾“å…¥å›¾åƒåŠå…¶åœ¨å…¨å±€ç›´æ–¹å›¾å‡è¡¡åçš„ç»“æœã€‚<br><img src="http://qiniu.aihubs.net/clahe_1.jpg" alt></p>
<p>ç›´æ–¹å›¾å‡è¡¡åï¼ŒèƒŒæ™¯å¯¹æ¯”åº¦ç¡®å®å¾—åˆ°äº†æ”¹å–„ã€‚ä½†æ˜¯åœ¨ä¸¤ä¸ªå›¾åƒä¸­æ¯”è¾ƒé›•åƒçš„è„¸ã€‚</p>
<p>ç”±äºäº®åº¦è¿‡é«˜ï¼Œæˆ‘ä»¬åœ¨é‚£é‡Œä¸¢å¤±äº†å¤§å¤šæ•°ä¿¡æ¯ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºå®ƒçš„ç›´æ–¹å›¾ä¸åƒæˆ‘ä»¬åœ¨å‰é¢çš„æ¡ˆä¾‹ä¸­æ‰€çœ‹åˆ°çš„é‚£æ ·å±€é™äºç‰¹å®šåŒºåŸŸï¼ˆå°è¯•ç»˜åˆ¶è¾“å…¥å›¾åƒçš„ç›´æ–¹å›¾ï¼Œæ‚¨å°†è·å¾—æ›´å¤šçš„ç›´è§‰ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨äº†<strong>è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡</strong>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå›¾åƒè¢«åˆ†æˆç§°ä¸ºâ€œtilesâ€çš„å°å—ï¼ˆåœ¨OpenCVä¸­ï¼ŒtileSizeé»˜è®¤ä¸º8x8ï¼‰ã€‚</p>
<p>ç„¶åï¼Œåƒå¾€å¸¸ä¸€æ ·å¯¹è¿™äº›å—ä¸­çš„æ¯ä¸€ä¸ªè¿›è¡Œç›´æ–¹å›¾å‡è¡¡ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨è¾ƒå°çš„åŒºåŸŸä¸­ï¼Œç›´æ–¹å›¾å°†é™åˆ¶åœ¨ä¸€ä¸ªè¾ƒå°çš„åŒºåŸŸä¸­ï¼ˆé™¤éå­˜åœ¨å™ªå£°ï¼‰ã€‚</p>
<p>å¦‚æœæœ‰å™ªéŸ³ï¼Œå®ƒå°†è¢«æ”¾å¤§ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåº”ç”¨äº†å¯¹æ¯”åº¦é™åˆ¶ã€‚</p>
<p>å¦‚æœä»»ä½•ç›´æ–¹å›¾binè¶…å‡ºæŒ‡å®šçš„å¯¹æ¯”åº¦é™åˆ¶ï¼ˆåœ¨OpenCVä¸­é»˜è®¤ä¸º40ï¼‰ï¼Œåˆ™åœ¨åº”ç”¨ç›´æ–¹å›¾å‡è¡¡ä¹‹å‰ï¼Œå°†è¿™äº›åƒç´ è£å‰ªå¹¶å‡åŒ€åœ°åˆ†å¸ƒåˆ°å…¶ä»–binã€‚</p>
<p>å‡è¡¡åï¼Œè¦æ¶ˆé™¤å›¾å—è¾¹ç•Œä¸­çš„ä¼ªå½±ï¼Œè¯·åº”ç”¨åŒçº¿æ€§æ’å€¼ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†å¦‚ä½•åœ¨OpenCVä¸­åº”ç”¨CLAHEï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">img &#x3D; cv.imread(&#39;tsukuba_l.png&#39;,0)</span><br><span class="line"># create a CLAHE object (Arguments are optional).</span><br><span class="line">clahe &#x3D; cv.createCLAHE(clipLimit&#x3D;2.0, tileGridSize&#x3D;(8,8))</span><br><span class="line">cl1 &#x3D; clahe.apply(img)</span><br><span class="line">cv.imwrite(&#39;clahe_2.jpg&#39;,cl1)</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ä¸‹é¢çš„ç»“æœï¼Œå¹¶å°†å…¶ä¸ä¸Šé¢çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå°¤å…¶æ˜¯é›•åƒåŒºåŸŸï¼š<br><img src="http://qiniu.aihubs.net/clahe_2.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="ç›´æ–¹å›¾-3ï¼šäºŒç»´ç›´æ–¹å›¾"><a href="#ç›´æ–¹å›¾-3ï¼šäºŒç»´ç›´æ–¹å›¾" class="headerlink" title="ç›´æ–¹å›¾-3ï¼šäºŒç»´ç›´æ–¹å›¾"></a><span id="header3">ç›´æ–¹å›¾-3ï¼šäºŒç»´ç›´æ–¹å›¾</span></h1><h2 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ æŸ¥æ‰¾å’Œç»˜åˆ¶2Dç›´æ–¹å›¾ã€‚è¿™å°†åœ¨ä»¥åçš„ç« èŠ‚ä¸­æœ‰æ‰€å¸®åŠ©ã€‚</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—å¹¶ç»˜åˆ¶äº†ä¸€ç»´ç›´æ–¹å›¾ã€‚ ä¹‹æ‰€ä»¥ç§°ä¸ºä¸€ç»´ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä»…è€ƒè™‘ä¸€ä¸ªç‰¹å¾ï¼Œå³åƒç´ çš„ç°åº¦å¼ºåº¦å€¼ã€‚ </p>
<p>ä½†æ˜¯åœ¨äºŒç»´ç›´æ–¹å›¾ä¸­ï¼Œæ‚¨è¦è€ƒè™‘ä¸¤ä¸ªç‰¹å¾ã€‚ é€šå¸¸ï¼Œå®ƒç”¨äºæŸ¥æ‰¾é¢œè‰²ç›´æ–¹å›¾ï¼Œå…¶ä¸­ä¸¤ä¸ªç‰¹å¾æ˜¯æ¯ä¸ªåƒç´ çš„è‰²ç›¸å’Œé¥±å’Œåº¦å€¼ã€‚</p>
<p>æˆ‘ä»¬å°†å°è¯•äº†è§£å¦‚ä½•åˆ›å»ºè¿™ç§é¢œè‰²ç›´æ–¹å›¾ï¼Œè¿™å¯¹äºç†è§£è¯¸å¦‚ç›´æ–¹å›¾åå‘æŠ•å½±ä¹‹ç±»çš„æ›´å¤šä¸»é¢˜å°†å¾ˆæœ‰ç”¨ã€‚</p>
<h2 id="OpenCVä¸­çš„äºŒç»´ç›´æ–¹å›¾"><a href="#OpenCVä¸­çš„äºŒç»´ç›´æ–¹å›¾" class="headerlink" title="OpenCVä¸­çš„äºŒç»´ç›´æ–¹å›¾"></a>OpenCVä¸­çš„äºŒç»´ç›´æ–¹å›¾</h2><p>å®ƒéå¸¸ç®€å•ï¼Œå¹¶ä¸”ä½¿ç”¨ç›¸åŒçš„å‡½æ•°<strong>cv.calcHist</strong>()è¿›è¡Œè®¡ç®—ã€‚ </p>
<p>å¯¹äºé¢œè‰²ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬éœ€è¦å°†å›¾åƒä»BGRè½¬æ¢ä¸ºHSVã€‚ï¼ˆè¯·è®°ä½ï¼Œå¯¹äºä¸€ç»´ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬ä»BGRè½¬æ¢ä¸ºç°åº¦ï¼‰ã€‚å¯¹äºäºŒç»´ç›´æ–¹å›¾ï¼Œå…¶å‚æ•°å°†è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">channel &#x3D; [0,1]ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åŒæ—¶å¤„ç†Hå’ŒSå¹³é¢ã€‚</span><br><span class="line">bins &#x3D; [180,256] å¯¹äºHå¹³é¢ä¸º180ï¼Œå¯¹äºSå¹³é¢ä¸º256ã€‚</span><br><span class="line">range &#x3D; [0,180,0,256] è‰²ç›¸å€¼ä»‹äº0å’Œ180ä¹‹é—´ï¼Œé¥±å’Œåº¦ä»‹äº0å’Œ256ä¹‹é—´ã€‚</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ£€æŸ¥ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;)</span><br><span class="line">hsv &#x3D; cv.cvtColor(img,cv.COLOR_BGR2HSV)</span><br><span class="line">hist &#x3D; cv.calcHist([hsv], [0, 1], None, [180, 256], [0, 180, 0, 256])</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯è¿™æ ·ã€‚</p>
<h2 id="Numpyä¸­çš„äºŒç»´ç›´æ–¹å›¾"><a href="#Numpyä¸­çš„äºŒç»´ç›´æ–¹å›¾" class="headerlink" title="Numpyä¸­çš„äºŒç»´ç›´æ–¹å›¾"></a>Numpyä¸­çš„äºŒç»´ç›´æ–¹å›¾</h2><p>Numpyè¿˜ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªç‰¹å®šçš„å‡½æ•°:np.histogram2d()ã€‚(è®°ä½ï¼Œå¯¹äºä¸€ç»´ç›´æ–¹å›¾æˆ‘ä»¬ä½¿ç”¨äº†<strong>np.histogram</strong>())ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;)</span><br><span class="line">hsv &#x3D; cv.cvtColor(img,cv.COLOR_BGR2HSV)</span><br><span class="line">hist, xbins, ybins &#x3D; np.histogram2d(h.ravel(),s.ravel(),[180,256],[[0,180],[0,256]])</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Hå¹³é¢ï¼Œç¬¬äºŒä¸ªæ˜¯Så¹³é¢ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ¯ä¸ªç®±å­çš„æ•°é‡ï¼Œç¬¬å››ä¸ªæ˜¯å®ƒä»¬çš„èŒƒå›´ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ£€æŸ¥å¦‚ä½•ç»˜åˆ¶è¿™ä¸ªé¢œè‰²ç›´æ–¹å›¾ã€‚</p>
<h2 id="ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾"><a href="#ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾" class="headerlink" title="ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾"></a>ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾</h2><h2 id="æ–¹æ³•1ï¼šä½¿ç”¨-cv-imshow"><a href="#æ–¹æ³•1ï¼šä½¿ç”¨-cv-imshow" class="headerlink" title="æ–¹æ³•1ï¼šä½¿ç”¨ cv.imshow()"></a>æ–¹æ³•1ï¼šä½¿ç”¨ cv.imshow()</h2><p>æˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯å°ºå¯¸ä¸º80x256çš„äºŒç»´æ•°ç»„ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨<strong>cv.imshow</strong>()å‡½æ•°åƒå¹³å¸¸ä¸€æ ·æ˜¾ç¤ºå®ƒä»¬ã€‚</p>
<p>å®ƒå°†æ˜¯ä¸€å¹…ç°åº¦å›¾åƒï¼Œé™¤éæ‚¨çŸ¥é“ä¸åŒé¢œè‰²çš„è‰²ç›¸å€¼ï¼Œå¦åˆ™ä¸ä¼šå¯¹å…¶ä¸­çš„é¢œè‰²æœ‰å¤ªå¤šäº†è§£ã€‚</p>
<h2 id="æ–¹æ³•2ï¼šä½¿ç”¨Matplotlib"><a href="#æ–¹æ³•2ï¼šä½¿ç”¨Matplotlib" class="headerlink" title="æ–¹æ³•2ï¼šä½¿ç”¨Matplotlib"></a>æ–¹æ³•2ï¼šä½¿ç”¨Matplotlib</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨matplotlib.pyplot.imshow()å‡½æ•°ç»˜åˆ¶å…·æœ‰ä¸åŒé¢œè‰²å›¾çš„2Dç›´æ–¹å›¾ã€‚</p>
<p>å®ƒä½¿æˆ‘ä»¬å¯¹ä¸åŒçš„åƒç´ å¯†åº¦æœ‰äº†æ›´å¥½çš„äº†è§£ã€‚ä½†æ˜¯ï¼Œé™¤éæ‚¨çŸ¥é“ä¸åŒé¢œè‰²çš„è‰²ç›¸å€¼ï¼Œå¦åˆ™ä¹ä¸€çœ‹å¹¶ä¸èƒ½ä½¿æˆ‘ä»¬çŸ¥é“åˆ°åº•æ˜¯ä»€ä¹ˆé¢œè‰²ã€‚</p>
<p>æ³¨æ„ ä½¿ç”¨æ­¤åŠŸèƒ½æ—¶ï¼Œè¯·è®°ä½ï¼Œæ’å€¼æ³•åº”é‡‡ç”¨æœ€è¿‘é‚»ä»¥è·å¾—æ›´å¥½çš„ç»“æœã€‚</p>
<p>è€ƒè™‘ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">img &#x3D; cv.imread(&#39;home.jpg&#39;)</span><br><span class="line">hsv &#x3D; cv.cvtColor(img,cv.COLOR_BGR2HSV)</span><br><span class="line">hist &#x3D; cv.calcHist( [hsv], [0, 1], None, [180, 256], [0, 180, 0, 256] )</span><br><span class="line">plt.imshow(hist,interpolation &#x3D; &#39;nearest&#39;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯è¾“å…¥å›¾åƒåŠå…¶é¢œè‰²ç›´æ–¹å›¾ã€‚Xè½´æ˜¾ç¤ºSå€¼ï¼ŒYè½´æ˜¾ç¤ºè‰²ç›¸ã€‚<br><img src="http://qiniu.aihubs.net/2dhist_matplotlib.jpg" alt></p>
<p>åœ¨ç›´æ–¹å›¾ä¸­ï¼Œæ‚¨å¯ä»¥åœ¨H = 100å’ŒS = 200é™„è¿‘çœ‹åˆ°ä¸€äº›è¾ƒé«˜çš„å€¼ã€‚</p>
<p>å®ƒå¯¹åº”äºå¤©ç©ºçš„è“è‰²ã€‚åŒæ ·ï¼Œåœ¨H = 25å’ŒS = 100é™„è¿‘å¯ä»¥çœ‹åˆ°å¦ä¸€ä¸ªå³°å€¼ã€‚å®ƒå¯¹åº”äºå®«æ®¿çš„é»„è‰²ã€‚æ‚¨å¯ä»¥ä½¿ç”¨GIMPç­‰ä»»ä½•å›¾åƒç¼–è¾‘å·¥å…·è¿›è¡ŒéªŒè¯ã€‚</p>
<h2 id="æ–¹æ³•3ï¼šOpenCVç¤ºä¾‹æ ·å¼"><a href="#æ–¹æ³•3ï¼šOpenCVç¤ºä¾‹æ ·å¼" class="headerlink" title="æ–¹æ³•3ï¼šOpenCVç¤ºä¾‹æ ·å¼"></a>æ–¹æ³•3ï¼šOpenCVç¤ºä¾‹æ ·å¼</h2><p>OpenCV-Python2ç¤ºä¾‹ä¸­æœ‰ä¸€ä¸ªé¢œè‰²ç›´æ–¹å›¾çš„ç¤ºä¾‹ä»£ç (samples / python / color_histogram.py)ã€‚</p>
<p>å¦‚æœè¿è¡Œä»£ç ï¼Œåˆ™å¯ä»¥çœ‹åˆ°ç›´æ–¹å›¾ä¹Ÿæ˜¾ç¤ºäº†ç›¸åº”çš„é¢œè‰²ã€‚æˆ–è€…ç®€å•åœ°ï¼Œå®ƒè¾“å‡ºé¢œè‰²ç¼–ç çš„ç›´æ–¹å›¾ã€‚å…¶ç»“æœéå¸¸å¥½ï¼ˆå°½ç®¡æ‚¨éœ€è¦æ·»åŠ é¢å¤–çš„çº¿æŸï¼‰ã€‚</p>
<p>åœ¨è¯¥ä»£ç ä¸­ï¼Œä½œè€…åœ¨HSVä¸­åˆ›å»ºäº†ä¸€ä¸ªé¢œè‰²å›¾ã€‚ç„¶åå°†å…¶è½¬æ¢ä¸ºBGRã€‚å°†æ‰€å¾—çš„ç›´æ–¹å›¾å›¾åƒä¸æ­¤é¢œè‰²å›¾ç›¸ä¹˜ã€‚ä»–è¿˜ä½¿ç”¨ä¸€äº›é¢„å¤„ç†æ­¥éª¤æ¥åˆ é™¤å°çš„å­¤ç«‹åƒç´ ï¼Œä»è€Œè·å¾—è‰¯å¥½çš„ç›´æ–¹å›¾ã€‚</p>
<p>æˆ‘å°†å…¶ç•™ç»™è¯»è€…æ¥è¿è¡Œä»£ç ï¼Œå¯¹å…¶è¿›è¡Œåˆ†æå¹¶æ‹¥æœ‰è‡ªå·±çš„è§£å†³æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸ä¸Šé¢ç›¸åŒçš„å›¾åƒçš„ä»£ç è¾“å‡ºï¼š<br><img src="http://qiniu.aihubs.net/2dhist_opencv.jpg" alt></p>
<p>æ‚¨å¯ä»¥åœ¨ç›´æ–¹å›¾ä¸­æ¸…æ¥šåœ°çœ‹åˆ°å­˜åœ¨ä»€ä¹ˆé¢œè‰²ï¼Œé‚£é‡Œæ˜¯è“è‰²ï¼Œé‚£é‡Œæ˜¯é»„è‰²ï¼Œå¹¶ä¸”ç”±äºæ£‹ç›˜çš„å­˜åœ¨è€Œæœ‰äº›ç™½è‰²ã€‚å¾ˆå¥½ï¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="ç›´æ–¹å›¾4ï¼šç›´æ–¹å›¾åæŠ•å½±"><a href="#ç›´æ–¹å›¾4ï¼šç›´æ–¹å›¾åæŠ•å½±" class="headerlink" title="ç›´æ–¹å›¾4ï¼šç›´æ–¹å›¾åæŠ•å½±"></a><span id="header4">ç›´æ–¹å›¾4ï¼šç›´æ–¹å›¾åæŠ•å½±</span></h1><h2 id="ç›®æ ‡-3"><a href="#ç›®æ ‡-3" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ç›´æ–¹å›¾åæŠ•å½±ã€‚</p>
<h2 id="ç†è®º-2"><a href="#ç†è®º-2" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><p>è¿™æ˜¯ç”±<strong>Michael J. Swain</strong>å’Œ<strong>Dana H. Ballard</strong>åœ¨ä»–ä»¬çš„è®ºæ–‡ã€Šé€šè¿‡é¢œè‰²ç›´æ–¹å›¾ç´¢å¼•ã€‹ä¸­æå‡ºçš„ã€‚</p>
<p>ç”¨ç®€å•çš„è¯è¯´æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå®ƒç”¨äºå›¾åƒåˆ†å‰²æˆ–åœ¨å›¾åƒä¸­æŸ¥æ‰¾æ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œå®ƒåˆ›å»ºçš„å›¾åƒå¤§å°ä¸è¾“å…¥å›¾åƒç›¸åŒï¼ˆä½†åªæœ‰ä¸€ä¸ªé€šé“ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ å¯¹åº”äºè¯¥åƒç´ å±äºæˆ‘ä»¬ç‰©ä½“çš„æ¦‚ç‡ã€‚</p>
<p>ç”¨æ›´ç®€å•çš„è¯æ¥è¯´ï¼Œä¸å…¶ä½™éƒ¨åˆ†ç›¸æ¯”ï¼Œè¾“å‡ºå›¾åƒå°†åœ¨å¯èƒ½æœ‰å¯¹è±¡çš„åŒºåŸŸå…·æœ‰æ›´å¤šçš„ç™½è‰²å€¼ã€‚</p>
<p>å¥½å§ï¼Œè¿™æ˜¯ä¸€ä¸ªç›´è§‚çš„è§£é‡Šã€‚ï¼ˆæˆ‘æ— æ³•ä½¿å…¶æ›´ç®€å•ï¼‰ã€‚ç›´æ–¹å›¾åæŠ•å½±ä¸camshiftç®—æ³•ç­‰é…åˆä½¿ç”¨ã€‚</p>
<p>æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›¾åƒçš„ç›´æ–¹å›¾ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬æ„Ÿå…´è¶£çš„å¯¹è±¡ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­æ˜¯èƒŒæ™¯ï¼Œç¦»å¼€æ’­æ”¾å™¨ç­‰ï¼‰ã€‚</p>
<p>å¯¹è±¡åº”å°½å¯èƒ½å¡«å……å›¾åƒä»¥è·å¾—æ›´å¥½çš„æ•ˆæœã€‚è€Œä¸”é¢œè‰²ç›´æ–¹å›¾æ¯”ç°åº¦ç›´æ–¹å›¾æ›´å¯å–ï¼Œå› ä¸ºå¯¹è±¡çš„é¢œè‰²å¯¹æ¯”ç°åº¦å¼ºåº¦æ˜¯å®šä¹‰å¯¹è±¡çš„å¥½æ–¹æ³•ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†è¯¥ç›´æ–¹å›¾â€œåæŠ•å½±â€åˆ°éœ€è¦æ‰¾åˆ°å¯¹è±¡çš„æµ‹è¯•å›¾åƒä¸Šï¼Œ</p>
<p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºå±äºèƒŒæ™¯çš„æ¯ä¸ªåƒç´ çš„æ¦‚ç‡å¹¶å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚åœ¨é€‚å½“çš„é˜ˆå€¼ä¸‹äº§ç”Ÿçš„è¾“å‡ºä½¿æˆ‘ä»¬ä»…è·å¾—èƒŒæ™¯ã€‚</p>
<h2 id="Numpyä¸­çš„ç®—æ³•"><a href="#Numpyä¸­çš„ç®—æ³•" class="headerlink" title="Numpyä¸­çš„ç®—æ³•"></a>Numpyä¸­çš„ç®—æ³•</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æˆ‘ä»¬è¦æŸ¥æ‰¾çš„å¯¹è±¡ï¼ˆä½¿å…¶ä¸ºâ€œ Mâ€ï¼‰å’Œè¦æœç´¢çš„å›¾åƒï¼ˆä½¿å…¶ä¸ºâ€œ Iâ€ï¼‰çš„é¢œè‰²ç›´æ–¹å›¾ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cvfrom matplotlib import pyplot as plt</span><br><span class="line">#roiæ˜¯æˆ‘ä»¬éœ€è¦æ‰¾åˆ°çš„å¯¹è±¡æˆ–å¯¹è±¡åŒºåŸŸ</span><br><span class="line">roi &#x3D; cv.imread(&#39;rose_red.png&#39;)</span><br><span class="line">hsv &#x3D; cv.cvtColor(roi,cv.COLOR_BGR2HSV)</span><br><span class="line">#ç›®æ ‡æ˜¯æˆ‘ä»¬æœç´¢çš„å›¾åƒ</span><br><span class="line">target &#x3D; cv.imread(&#39;rose.png&#39;)</span><br><span class="line">hsvt &#x3D; cv.cvtColor(target,cv.COLOR_BGR2HSV)</span><br><span class="line"># ä½¿ç”¨calcHistæŸ¥æ‰¾ç›´æ–¹å›¾ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨np.histogram2då®Œæˆ</span><br><span class="line">M &#x3D; cv.calcHist([hsv],[0, 1], None, [180, 256], [0, 180, 0, 256] )</span><br><span class="line">I &#x3D; cv.calcHist([hsvt],[0, 1], None, [180, 256], [0, 180, 0, 256] )</span><br></pre></td></tr></table></figure>

<p>æ±‚å‡ºæ¯”å€¼R=$\frac{M}{I}$ã€‚ç„¶ååå‘æŠ•å½±Rï¼Œå³ä½¿ç”¨Rä½œä¸ºè°ƒè‰²æ¿ï¼Œå¹¶ä»¥æ¯ä¸ªåƒç´ ä½œä¸ºå…¶å¯¹åº”çš„ç›®æ ‡æ¦‚ç‡åˆ›å»ºä¸€ä¸ªæ–°å›¾åƒã€‚å³B(x,y) = R[h(x,y),s(x,y)] å…¶ä¸­hæ˜¯è‰²è°ƒï¼Œsæ˜¯åƒç´ åœ¨(xï¼Œy)çš„é¥±å’Œåº¦ã€‚ä¹‹åï¼Œåº”ç”¨æ¡ä»¶B(x,y)=min[B(x,y),1]ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">h,s,v &#x3D; cv.split(hsvt)</span><br><span class="line">B &#x3D; R[h.ravel(),s.ravel()]</span><br><span class="line">B &#x3D; np.minimum(B,1)</span><br><span class="line">B &#x3D; B.reshape(hsvt.shape[:2])</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯¹åœ†ç›˜åº”ç”¨å·ç§¯ï¼ŒB=Dâˆ—Bï¼Œå…¶ä¸­Dæ˜¯åœ†ç›˜å†…æ ¸ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">disc &#x3D; cv.getStructuringElement(cv.MORPH_ELLIPSE,(5,5))</span><br><span class="line">cv.filter2D(B,-1,disc,B)</span><br><span class="line">B &#x3D; np.uint8(B)</span><br><span class="line">cv.normalize(B,B,0,255,cv.NORM_MINMAX)</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æœ€å¤§å¼ºåº¦çš„ä½ç½®ç»™äº†æˆ‘ä»¬ç‰©ä½“çš„ä½ç½®ã€‚å¦‚æœæˆ‘ä»¬æœŸæœ›å›¾åƒä¸­æœ‰ä¸€ä¸ªåŒºåŸŸï¼Œåˆ™å¯¹åˆé€‚çš„å€¼è¿›è¡Œé˜ˆå€¼å¤„ç†å°†è·å¾—ä¸é”™çš„ç»“æœã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ret,thresh &#x3D; cv.threshold(B,50,255,0)</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯è¿™æ ·</p>
<h2 id="OpenCVçš„åæŠ•å½±"><a href="#OpenCVçš„åæŠ•å½±" class="headerlink" title="OpenCVçš„åæŠ•å½±"></a>OpenCVçš„åæŠ•å½±</h2><p>OpenCVæä¾›äº†ä¸€ä¸ªå†…å»ºçš„å‡½æ•°<strong>cv.calcBackProject</strong>()ã€‚</p>
<p>å®ƒçš„å‚æ•°å‡ ä¹ä¸<strong>cv.calchist</strong>()å‡½æ•°ç›¸åŒã€‚å®ƒçš„ä¸€ä¸ªå‚æ•°æ˜¯ç›´æ–¹å›¾ï¼Œä¹Ÿå°±æ˜¯ç‰©ä½“çš„ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°å®ƒã€‚</p>
<p>å¦å¤–ï¼Œåœ¨ä¼ é€’ç»™backprojectå‡½æ•°ä¹‹å‰ï¼Œåº”è¯¥å¯¹å¯¹è±¡ç›´æ–¹å›¾è¿›è¡Œå½’ä¸€åŒ–ã€‚å®ƒè¿”å›æ¦‚ç‡å›¾åƒã€‚</p>
<p>ç„¶åæˆ‘ä»¬ç”¨åœ†ç›˜å†…æ ¸å¯¹å›¾åƒè¿›è¡Œå·ç§¯å¹¶åº”ç”¨é˜ˆå€¼ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä»£ç å’Œç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2 as cv</span><br><span class="line">roi &#x3D; cv.imread(&#39;rose_red.png&#39;)</span><br><span class="line">hsv &#x3D; cv.cvtColor(roi,cv.COLOR_BGR2HSV)</span><br><span class="line">target &#x3D; cv.imread(&#39;rose.png&#39;)</span><br><span class="line">hsvt &#x3D; cv.cvtColor(target,cv.COLOR_BGR2HSV)</span><br><span class="line"># è®¡ç®—å¯¹è±¡çš„ç›´æ–¹å›¾</span><br><span class="line">roihist &#x3D; cv.calcHist([hsv],[0, 1], None, [180, 256], [0, 180, 0, 256] )</span><br><span class="line"># ç›´æ–¹å›¾å½’ä¸€åŒ–å¹¶åˆ©ç”¨åä¼ ç®—æ³•</span><br><span class="line">cv.normalize(roihist,roihist,0,255,cv.NORM_MINMAX)</span><br><span class="line">dst &#x3D; cv.calcBackProject([hsvt],[0,1],roihist,[0,180,0,256],1)</span><br><span class="line"># ç”¨åœ†ç›˜è¿›è¡Œå·ç§¯</span><br><span class="line">disc &#x3D; cv.getStructuringElement(cv.MORPH_ELLIPSE,(5,5))</span><br><span class="line">cv.filter2D(dst,-1,disc,dst)</span><br><span class="line"># åº”ç”¨é˜ˆå€¼ä½œä¸æ“ä½œ</span><br><span class="line">ret,thresh &#x3D; cv.threshold(dst,50,255,0)</span><br><span class="line">thresh &#x3D; cv.merge((thresh,thresh,thresh))</span><br><span class="line">res &#x3D; cv.bitwise_and(target,thresh)</span><br><span class="line">res &#x3D; np.vstack((target,thresh,res))</span><br><span class="line">cv.imwrite(&#39;res.jpg&#39;,res)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯æˆ‘å¤„ç†è¿‡çš„ä¸€ä¸ªç¤ºä¾‹ã€‚æˆ‘å°†è“è‰²çŸ©å½¢å†…çš„åŒºåŸŸç”¨ä½œç¤ºä¾‹å¯¹è±¡ï¼Œæˆ‘æƒ³æå–æ•´ä¸ªåœ°é¢ã€‚<br><img src="http://qiniu.aihubs.net/backproject_opencv.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>opencv</tag>
        <tag>å›¾åƒ</tag>
      </tags>
  </entry>
</search>
